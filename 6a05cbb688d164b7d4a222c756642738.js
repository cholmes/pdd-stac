require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var a=e[n]=new t.Module;r[n][0].call(a.exports,i,a,a.exports)}return e[n].exports}function o(){this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({28:[function(require,module,exports) {

},{}],42:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E={ASSUME_TOUCH:!1,DEFAULT_MAX_ZOOM:42,DEFAULT_MIN_ZOOM:0,DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD:.5,DEFAULT_TILE_SIZE:256,DEFAULT_WMS_VERSION:"1.3.0",ENABLE_CANVAS:!0,ENABLE_PROJ4JS:!0,ENABLE_RASTER_REPROJECTION:!0,ENABLE_WEBGL:!0,DEBUG_WEBGL:!0,INITIAL_ATLAS_SIZE:256,MAX_ATLAS_SIZE:-1,MOUSEWHEELZOOM_MAXDELTA:1,OVERVIEWMAP_MAX_RATIO:.75,OVERVIEWMAP_MIN_RATIO:.1,RASTER_REPROJECTION_MAX_SOURCE_TILES:100,RASTER_REPROJECTION_MAX_SUBDIVISION:10,RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH:.25,SIMPLIFY_TOLERANCE:.5,WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK:1024,VERSION:"v4.6.4"};E.WEBGL_MAX_TEXTURE_SIZE,E.WEBGL_EXTENSIONS,E.inherits=function(E,_){E.prototype=Object.create(_.prototype),E.prototype.constructor=E},E.nullFunction=function(){},E.getUid=function(_){return _.ol_uid||(_.ol_uid=++E.uidCounter_)},E.uidCounter_=0,exports.default=E;
},{}],141:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=r.default.VERSION?r.default.VERSION.split("-")[0]:"latest";this.message="Assertion failed. See https://openlayers.org/en/"+t+"/doc/errors/#"+e+" for details.",this.code=e,this.name="AssertionError"};r.default.inherits(s,Error),exports.default=s;
},{"./index.js":42}],125:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={ADD:"add",REMOVE:"remove"};exports.default=e;
},{}],132:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={PROPERTYCHANGE:"propertychange"};exports.default=e;
},{}],52:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={};r.assign="function"==typeof Object.assign?Object.assign:function(r,e){if(void 0===r||null===r)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(r),t=1,o=arguments.length;t<o;++t){var i=arguments[t];if(void 0!==i&&null!==i)for(var u in i)i.hasOwnProperty(u)&&(n[u]=i[u])}return n},r.clear=function(r){for(var e in r)delete r[e]},r.getValues=function(r){var e=[];for(var n in r)e.push(r[n]);return e},r.isEmpty=function(r){var e;for(e in r)return!1;return!e},exports.default=r;
},{}],135:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./obj.js"),n=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var r={bindListener_:function(e){var n=function(n){var t=e.listener,i=e.bindTo||e.target;return e.callOnce&&r.unlistenByKey(e),t.call(i,n)};return e.boundListener=n,n},findListener_:function(e,n,t,r){for(var i,l=0,s=e.length;l<s;++l)if((i=e[l]).listener===n&&i.bindTo===t)return r&&(i.deleteIndex=l),i},getListeners:function(e,n){var t=e.ol_lm;return t?t[n]:void 0},getListenerMap_:function(e){var n=e.ol_lm;return n||(n=e.ol_lm={}),n},removeListeners_:function(e,t){var i=r.getListeners(e,t);if(i){for(var l=0,s=i.length;l<s;++l)e.removeEventListener(t,i[l].boundListener),n.default.clear(i[l]);i.length=0;var a=e.ol_lm;a&&(delete a[t],0===Object.keys(a).length&&delete e.ol_lm)}},listen:function(e,n,t,i,l){var s=r.getListenerMap_(e),a=s[n];a||(a=s[n]=[]);var o=r.findListener_(a,t,i,!1);return o?l||(o.callOnce=!1):(o={bindTo:i,callOnce:!!l,listener:t,target:e,type:n},e.addEventListener(n,r.bindListener_(o)),a.push(o)),o},listenOnce:function(e,n,t,i){return r.listen(e,n,t,i,!0)},unlisten:function(e,n,t,i){var l=r.getListeners(e,n);if(l){var s=r.findListener_(l,t,i,!0);s&&r.unlistenByKey(s)}},unlistenByKey:function(e){if(e&&e.target){e.target.removeEventListener(e.type,e.boundListener);var t=r.getListeners(e.target,e.type);if(t){var i="deleteIndex"in e?e.deleteIndex:t.indexOf(e);-1!==i&&t.splice(i,1),0===t.length&&r.removeListeners_(e.target,e.type)}n.default.clear(e)}},unlistenAll:function(e){var n=r.getListenerMap_(e);for(var t in n)r.removeListeners_(e,t)}};exports.default=r;
},{"./obj.js":52}],225:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=s(e);function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){};o.prototype.disposed_=!1,o.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},o.prototype.disposeInternal=t.default.nullFunction,exports.default=o;
},{"./index.js":42}],152:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t){this.propagationStopped,this.type=t,this.target=null};t.prototype.preventDefault=t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.stopPropagation=function(t){t.stopPropagation()},t.preventDefault=function(t){t.preventDefault()},exports.default=t;
},{}],211:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=o(e),i=require("../disposable.js"),s=o(i),n=require("../events.js"),r=o(n),l=require("../events/event.js"),a=o(l);function o(e){return e&&e.__esModule?e:{default:e}}var h=function(){s.default.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}};t.default.inherits(h,s.default),h.prototype.addEventListener=function(e,t){var i=this.listeners_[e];i||(i=this.listeners_[e]=[]),-1===i.indexOf(t)&&i.push(t)},h.prototype.dispatchEvent=function(e){var i="string"==typeof e?new a.default(e):e,s=i.type;i.target=this;var n,r=this.listeners_[s];if(r){s in this.dispatching_||(this.dispatching_[s]=0,this.pendingRemovals_[s]=0),++this.dispatching_[s];for(var l=0,o=r.length;l<o;++l)if(!1===r[l].call(this,i)||i.propagationStopped){n=!1;break}if(--this.dispatching_[s],0===this.dispatching_[s]){var h=this.pendingRemovals_[s];for(delete this.pendingRemovals_[s];h--;)this.removeEventListener(s,t.default.nullFunction);delete this.dispatching_[s]}return n}},h.prototype.disposeInternal=function(){r.default.unlistenAll(this)},h.prototype.getListeners=function(e){return this.listeners_[e]},h.prototype.hasListener=function(e){return e?e in this.listeners_:Object.keys(this.listeners_).length>0},h.prototype.removeEventListener=function(e,i){var s=this.listeners_[e];if(s){var n=s.indexOf(i);e in this.pendingRemovals_?(s[n]=t.default.nullFunction,++this.pendingRemovals_[e]):(s.splice(n,1),0===s.length&&delete this.listeners_[e])}},exports.default=h;
},{"../index.js":42,"../disposable.js":225,"../events.js":135,"../events/event.js":152}],153:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CHANGE:"change",CLEAR:"clear",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};exports.default=e;
},{}],140:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=o(e),r=require("./events.js"),n=o(r),i=require("./events/eventtarget.js"),s=o(i),u=require("./events/eventtype.js"),a=o(u);function o(e){return e&&e.__esModule?e:{default:e}}var l=function(){s.default.call(this),this.revision_=0};t.default.inherits(l,s.default),l.unByKey=function(e){if(Array.isArray(e))for(var t=0,r=e.length;t<r;++t)n.default.unlistenByKey(e[t]);else n.default.unlistenByKey(e)},l.prototype.changed=function(){++this.revision_,this.dispatchEvent(a.default.CHANGE)},l.prototype.dispatchEvent,l.prototype.getRevision=function(){return this.revision_},l.prototype.on=function(e,t,r){if(Array.isArray(e)){for(var i=e.length,s=new Array(i),u=0;u<i;++u)s[u]=n.default.listen(this,e[u],t,r);return s}return n.default.listen(this,e,t,r)},l.prototype.once=function(e,t,r){if(Array.isArray(e)){for(var i=e.length,s=new Array(i),u=0;u<i;++u)s[u]=n.default.listenOnce(this,e[u],t,r);return s}return n.default.listenOnce(this,e,t,r)},l.prototype.un=function(e,t,r){if(Array.isArray(e))for(var i=0,s=e.length;i<s;++i)n.default.unlisten(this,e[i],t,r);else n.default.unlisten(this,e,t,r)},exports.default=l;
},{"./index.js":42,"./events.js":135,"./events/eventtarget.js":211,"./events/eventtype.js":153}],58:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=v(e),s=require("./objecteventtype.js"),n=v(s),i=require("./observable.js"),r=v(i),a=require("./events/event.js"),u=v(a),o=require("./obj.js"),h=v(o);function v(e){return e&&e.__esModule?e:{default:e}}var l=function(e){r.default.call(this),t.default.getUid(this),this.values_={},void 0!==e&&this.setProperties(e)};t.default.inherits(l,r.default),l.changeEventTypeCache_={},l.getChangeEventType=function(e){return l.changeEventTypeCache_.hasOwnProperty(e)?l.changeEventTypeCache_[e]:l.changeEventTypeCache_[e]="change:"+e},l.prototype.get=function(e){var t;return this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t},l.prototype.getKeys=function(){return Object.keys(this.values_)},l.prototype.getProperties=function(){return h.default.assign({},this.values_)},l.prototype.notify=function(e,t){var s;s=l.getChangeEventType(e),this.dispatchEvent(new l.Event(s,e,t)),s=n.default.PROPERTYCHANGE,this.dispatchEvent(new l.Event(s,e,t))},l.prototype.set=function(e,t,s){if(s)this.values_[e]=t;else{var n=this.values_[e];this.values_[e]=t,n!==t&&this.notify(e,n)}},l.prototype.setProperties=function(e,t){var s;for(s in e)this.set(s,e[s],t)},l.prototype.unset=function(e,t){if(e in this.values_){var s=this.values_[e];delete this.values_[e],t||this.notify(e,s)}},l.Event=function(e,t,s){u.default.call(this,e),this.key=t,this.oldValue=s},t.default.inherits(l.Event,u.default),exports.default=l;
},{"./index.js":42,"./objecteventtype.js":132,"./observable.js":140,"./events/event.js":152,"./obj.js":52}],123:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=p(t),r=require("./assertionerror.js"),i=p(r),n=require("./collectioneventtype.js"),s=p(n),a=require("./object.js"),h=p(a),o=require("./events/event.js"),u=p(o);function p(t){return t&&t.__esModule?t:{default:t}}var f=function(t,e){h.default.call(this);var r=e||{};if(this.unique_=!!r.unique,this.array_=t||[],this.unique_)for(var i=0,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()};e.default.inherits(f,h.default),f.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},f.prototype.extend=function(t){var e,r;for(e=0,r=t.length;e<r;++e)this.push(t[e]);return this},f.prototype.forEach=function(t,e){for(var r=e?t.bind(e):t,i=this.array_,n=0,s=i.length;n<s;++n)r(i[n],n,i)},f.prototype.getArray=function(){return this.array_},f.prototype.item=function(t){return this.array_[t]},f.prototype.getLength=function(){return this.get(f.Property_.LENGTH)},f.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new f.Event(s.default.ADD,e))},f.prototype.pop=function(){return this.removeAt(this.getLength()-1)},f.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},f.prototype.remove=function(t){var e,r,i=this.array_;for(e=0,r=i.length;e<r;++e)if(i[e]===t)return this.removeAt(e)},f.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new f.Event(s.default.REMOVE,e)),e},f.prototype.setAt=function(t,e){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new f.Event(s.default.REMOVE,i)),this.dispatchEvent(new f.Event(s.default.ADD,e))}else{var n;for(n=r;n<t;++n)this.insertAt(n,void 0);this.insertAt(t,e)}},f.prototype.updateLength_=function(){this.set(f.Property_.LENGTH,this.array_.length)},f.prototype.assertUnique_=function(t,e){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===t&&r!==e)throw new i.default(58)},f.Property_={LENGTH:"length"},f.Event=function(t,e){u.default.call(this,t),this.element=e},e.default.inherits(f.Event,u.default),exports.default=f;
},{"./index.js":42,"./assertionerror.js":141,"./collectioneventtype.js":125,"./object.js":58,"./events/event.js":152}],129:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=i(e),r=require("./events/event.js"),u=i(r);function i(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,r){u.default.call(this,e),this.map=t,this.frameState=void 0!==r?r:null};t.default.inherits(s,u.default),exports.default=s;
},{"./index.js":42,"./events/event.js":152}],126:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=r(t),i=require("./mapevent.js"),o=r(i);function r(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e,i,r,a){o.default.call(this,t,e,a),this.originalEvent=i,this.pixel=e.getEventPixel(i),this.coordinate=e.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r};e.default.inherits(a,o.default),a.prototype.preventDefault=function(){o.default.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},a.prototype.stopPropagation=function(){o.default.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},exports.default=a;
},{"./index.js":42,"./mapevent.js":129}],180:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E={ONE:1,SRC_ALPHA:770,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,TRIANGLES:4,TRIANGLE_STRIP:5,ONE_MINUS_SRC_ALPHA:771,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,CULL_FACE:2884,BLEND:3042,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126,RGBA:6408,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,LINK_STATUS:35714,LINEAR:9729,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE0:33984,CLAMP_TO_EDGE:33071,COMPILE_STATUS:35713,FRAMEBUFFER:36160,CONTEXT_IDS_:["experimental-webgl","webgl","webkit-3d","moz-webgl"],getContext:function(T,_){var R,A,S=E.CONTEXT_IDS_.length;for(A=0;A<S;++A)try{if(R=T.getContext(E.CONTEXT_IDS_[A],_))return R}catch(E){}return null}};exports.default=E;
},{}],137:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=r(e),n=require("./webgl.js"),i=r(n);function r(e){return e&&e.__esModule?e:{default:e}}var a={},o="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";a.FIREFOX=-1!==o.indexOf("firefox"),a.SAFARI=-1!==o.indexOf("safari")&&-1==o.indexOf("chrom"),a.WEBKIT=-1!==o.indexOf("webkit")&&-1==o.indexOf("edge"),a.MAC=-1!==o.indexOf("macintosh"),a.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,a.CANVAS_LINE_DASH=!1,a.CANVAS=t.default.ENABLE_CANVAS&&function(){if(!("HTMLCanvasElement"in window))return!1;try{var e=document.createElement("CANVAS").getContext("2d");return!!e&&(void 0!==e.setLineDash&&(a.CANVAS_LINE_DASH=!0),!0)}catch(e){return!1}}(),a.DEVICE_ORIENTATION="DeviceOrientationEvent"in window,a.GEOLOCATION="geolocation"in navigator,a.TOUCH=t.default.ASSUME_TOUCH||"ontouchstart"in window,a.POINTER="PointerEvent"in window,a.MSPOINTER=!!navigator.msPointerEnabled,a.WEBGL,function(){if(t.default.ENABLE_WEBGL){var e,n=!1,r=[];if("WebGLRenderingContext"in window)try{var o=document.createElement("CANVAS"),E=i.default.getContext(o,{failIfMajorPerformanceCaveat:!0});E&&(n=!0,e=E.getParameter(E.MAX_TEXTURE_SIZE),r=E.getSupportedExtensions())}catch(e){}a.WEBGL=n,t.default.WEBGL_EXTENSIONS=r,t.default.WEBGL_MAX_TEXTURE_SIZE=e}}(),exports.default=a;
},{"./index.js":42,"./webgl.js":180}],128:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./events/eventtype.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var n={SINGLECLICK:"singleclick",CLICK:t.default.CLICK,DBLCLICK:t.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};exports.default=n;
},{"./events/eventtype.js":153}],210:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=u(e),r=require("./mapbrowserevent.js"),i=u(r);function u(e){return e&&e.__esModule?e:{default:e}}var n=function(e,t,r,u,n){i.default.call(this,e,t,r.originalEvent,u,n),this.pointerEvent=r};t.default.inherits(n,i.default),exports.default=n;
},{"./index.js":42,"./mapbrowserevent.js":126}],212:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};exports.default=e;
},{}],276:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t,e){this.dispatcher=t,this.mapping_=e};t.prototype.getEvents=function(){return Object.keys(this.mapping_)},t.prototype.getHandlerForEvent=function(t){return this.mapping_[t]},exports.default=t;
},{}],251:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=r(t),i=require("../pointer/eventsource.js"),o=r(i);function r(t){return t&&t.__esModule?t:{default:t}}var s=function(t){var e={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};o.default.call(this,t,e),this.pointerMap=t.pointerMap,this.lastTouches=[]};e.default.inherits(s,o.default),s.POINTER_ID=1,s.POINTER_TYPE="mouse",s.DEDUP_DIST=25,s.prototype.isEventSimulatedFromTouch_=function(t){for(var e,i=this.lastTouches,o=t.clientX,r=t.clientY,n=0,u=i.length;n<u&&(e=i[n]);n++){var p=Math.abs(o-e[0]),a=Math.abs(r-e[1]);if(p<=s.DEDUP_DIST&&a<=s.DEDUP_DIST)return!0}return!1},s.prepareEvent=function(t,e){var i=e.cloneEvent(t,t),o=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),o()},i.pointerId=s.POINTER_ID,i.isPrimary=!0,i.pointerType=s.POINTER_TYPE,i},s.prototype.mousedown=function(t){if(!this.isEventSimulatedFromTouch_(t)){s.POINTER_ID.toString()in this.pointerMap&&this.cancel(t);var e=s.prepareEvent(t,this.dispatcher);this.pointerMap[s.POINTER_ID.toString()]=t,this.dispatcher.down(e,t)}},s.prototype.mousemove=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=s.prepareEvent(t,this.dispatcher);this.dispatcher.move(e,t)}},s.prototype.mouseup=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[s.POINTER_ID.toString()];if(e&&e.button===t.button){var i=s.prepareEvent(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}},s.prototype.mouseover=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=s.prepareEvent(t,this.dispatcher);this.dispatcher.enterOver(e,t)}},s.prototype.mouseout=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=s.prepareEvent(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}},s.prototype.cancel=function(t){var e=s.prepareEvent(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},s.prototype.cleanupMouse=function(){delete this.pointerMap[s.POINTER_ID.toString()]},exports.default=s;
},{"../index.js":42,"../pointer/eventsource.js":276}],252:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=n(t),r=require("../pointer/eventsource.js"),i=n(r);function n(t){return t&&t.__esModule?t:{default:t}}var o=function(t){var e={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};i.default.call(this,t,e),this.pointerMap=t.pointerMap,this.POINTER_TYPES=["","unavailable","touch","pen","mouse"]};e.default.inherits(o,i.default),o.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},o.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},o.prototype.msPointerDown=function(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)},o.prototype.msPointerMove=function(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)},o.prototype.msPointerUp=function(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)},o.prototype.msPointerOut=function(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)},o.prototype.msPointerOver=function(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)},o.prototype.msPointerCancel=function(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)},o.prototype.msLostPointerCapture=function(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)},o.prototype.msGotPointerCapture=function(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)},exports.default=o;
},{"../index.js":42,"../pointer/eventsource.js":276}],253:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=o(t),i=require("../pointer/eventsource.js"),r=o(i);function o(t){return t&&t.__esModule?t:{default:t}}var n=function(t){var e={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};r.default.call(this,t,e)};e.default.inherits(n,r.default),n.prototype.pointerDown=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.pointerMove=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.pointerUp=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.pointerOut=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.pointerOver=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.pointerCancel=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.lostPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},n.prototype.gotPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},exports.default=n;
},{"../index.js":42,"../pointer/eventsource.js":276}],254:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=s(t),i=require("../events/event.js"),n=s(i);function s(t){return t&&t.__esModule?t:{default:t}}var r=function(t,e,i){n.default.call(this,t),this.originalEvent=e;var s=i||{};this.buttons=this.getButtons_(s),this.pressure=this.getPressure_(s,this.buttons),this.bubbles="bubbles"in s&&s.bubbles,this.cancelable="cancelable"in s&&s.cancelable,this.view="view"in s?s.view:null,this.detail="detail"in s?s.detail:null,this.screenX="screenX"in s?s.screenX:0,this.screenY="screenY"in s?s.screenY:0,this.clientX="clientX"in s?s.clientX:0,this.clientY="clientY"in s?s.clientY:0,this.ctrlKey="ctrlKey"in s&&s.ctrlKey,this.altKey="altKey"in s&&s.altKey,this.shiftKey="shiftKey"in s&&s.shiftKey,this.metaKey="metaKey"in s&&s.metaKey,this.button="button"in s?s.button:0,this.relatedTarget="relatedTarget"in s?s.relatedTarget:null,this.pointerId="pointerId"in s?s.pointerId:0,this.width="width"in s?s.width:0,this.height="height"in s?s.height:0,this.tiltX="tiltX"in s?s.tiltX:0,this.tiltY="tiltY"in s?s.tiltY:0,this.pointerType="pointerType"in s?s.pointerType:"",this.hwTimestamp="hwTimestamp"in s?s.hwTimestamp:0,this.isPrimary="isPrimary"in s&&s.isPrimary,e.preventDefault&&(this.preventDefault=function(){e.preventDefault()})};e.default.inherits(r,n.default),r.prototype.getButtons_=function(t){var e;if(t.buttons||r.HAS_BUTTONS)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},r.prototype.getPressure_=function(t,e){return t.pressure?t.pressure:e?.5:0},r.HAS_BUTTONS=!1,function(){try{var t=new MouseEvent("click",{buttons:1});r.HAS_BUTTONS=1===t.buttons}catch(t){}}(),exports.default=r;
},{"../index.js":42,"../events/event.js":152}],68:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={binarySearch:function(e,n,t){for(var u,f,i=t||r.numberSafeCompareFunction,o=0,a=e.length,l=!1;o<a;)(f=+i(e[u=o+(a-o>>1)],n))<0?o=u+1:(a=u,l=!f);return l?o:~o},numberSafeCompareFunction:function(r,e){return r>e?1:r<e?-1:0},includes:function(r,e){return r.indexOf(e)>=0},linearFindNearest:function(r,e,n){var t,u=r.length;if(r[0]<=e)return 0;if(e<=r[u-1])return u-1;if(n>0){for(t=1;t<u;++t)if(r[t]<e)return t-1}else if(n<0){for(t=1;t<u;++t)if(r[t]<=e)return t}else for(t=1;t<u;++t){if(r[t]==e)return t;if(r[t]<e)return r[t-1]-e<e-r[t]?t-1:t}return u-1},reverseSubArray:function(r,e,n){for(;e<n;){var t=r[e];r[e]=r[n],r[n]=t,++e,--n}},extend:function(r,e){var n,t=Array.isArray(e)?e:[e],u=t.length;for(n=0;n<u;n++)r[r.length]=t[n]},remove:function(r,e){var n=r.indexOf(e),t=n>-1;return t&&r.splice(n,1),t},find:function(r,e){for(var n,t=r.length>>>0,u=0;u<t;u++)if(e(n=r[u],u,r))return n;return null},equals:function(r,e){var n=r.length;if(n!==e.length)return!1;for(var t=0;t<n;t++)if(r[t]!==e[t])return!1;return!0},stableSort:function(r,e){var n,t=r.length,u=Array(r.length);for(n=0;n<t;n++)u[n]={index:n,value:r[n]};for(u.sort(function(r,n){return e(r.value,n.value)||r.index-n.index}),n=0;n<r.length;n++)r[n]=u[n].value},findIndex:function(r,e){var n;return!r.every(function(t,u){return n=u,!e(t,u,r)})?n:-1},isSorted:function(e,n,t){var u=n||r.numberSafeCompareFunction;return e.every(function(r,n){if(0===n)return!0;var f=u(e[n-1],r);return!(f>0||t&&0===f)})}};exports.default=r;
},{}],255:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=u(t),i=require("../array.js"),o=u(i),r=require("../pointer/eventsource.js"),s=u(r),n=require("../pointer/mousesource.js"),c=u(n);function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t,e){var i={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};s.default.call(this,t,i),this.pointerMap=t.pointerMap,this.mouseSource=e,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0};e.default.inherits(h,s.default),h.DEDUP_TIMEOUT=2500,h.CLICK_COUNT_TIMEOUT=200,h.POINTER_TYPE="touch",h.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},h.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&c.default.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},h.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},h.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),h.CLICK_COUNT_TIMEOUT)},h.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},h.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},h.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.webkitRadiusX||e.radiusX||0,i.height=e.webkitRadiusY||e.radiusY||0,i.pressure=e.webkitForce||e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType=h.POINTER_TYPE,i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},h.prototype.processTouches_=function(t,e){var i,o,r=Array.prototype.slice.call(t.changedTouches),s=r.length;function n(){t.preventDefault()}for(i=0;i<s;++i)(o=this.touchToPointer_(t,r[i])).preventDefault=n,e.call(this,t,o)},h.prototype.findTouch_=function(t,e){for(var i=t.length,o=0;o<i;o++)if(t[o].identifier===e)return!0;return!1},h.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),o=i.length;if(o>=e.length){var r,s,n,u=[];for(r=0;r<o;++r)s=i[r],n=this.pointerMap[s],s==c.default.POINTER_ID||this.findTouch_(e,s-2)||u.push(n.out);for(r=0;r<u.length;++r)this.cancelOut_(t,u[r])}},h.prototype.touchstart=function(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)},h.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},h.prototype.touchmove=function(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)},h.prototype.moveOverOut_=function(t,e){var i=e,o=this.pointerMap[i.pointerId];if(o){var r=o.out,s=o.outTarget;this.dispatcher.move(i,t),r&&s!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=s,r.target=s,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=s,i.relatedTarget=null,this.cancelOut_(t,i))),o.out=i,o.outTarget=i.target}},h.prototype.touchend=function(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)},h.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},h.prototype.touchcancel=function(t){this.processTouches_(t,this.cancelOut_)},h.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},h.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},h.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var r=[i.clientX,i.clientY];e.push(r),setTimeout(function(){o.default.remove(e,r)},h.DEDUP_TIMEOUT)}},exports.default=h;
},{"../index.js":42,"../array.js":68,"../pointer/eventsource.js":276,"../pointer/mousesource.js":251}],213:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=O(e),r=require("../events.js"),n=O(r),i=require("../events/eventtarget.js"),o=O(i),s=require("../has.js"),u=O(s),a=require("../pointer/eventtype.js"),p=O(a),l=require("../pointer/mousesource.js"),h=O(l),f=require("../pointer/mssource.js"),c=O(f),v=require("../pointer/nativesource.js"),E=O(v),d=require("../pointer/pointerevent.js"),y=O(d),_=require("../pointer/touchsource.js"),g=O(_);function O(e){return e&&e.__esModule?e:{default:e}}var P=function(e){o.default.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()};t.default.inherits(P,o.default),P.prototype.registerSources=function(){if(u.default.POINTER)this.registerSource("native",new E.default(this));else if(u.default.MSPOINTER)this.registerSource("ms",new c.default(this));else{var e=new h.default(this);this.registerSource("mouse",e),u.default.TOUCH&&this.registerSource("touch",new g.default(this,e))}this.register_()},P.prototype.registerSource=function(e,t){var r=t,n=r.getEvents();n&&(n.forEach(function(e){var t=r.getHandlerForEvent(e);t&&(this.eventMap_[e]=t.bind(r))},this),this.eventSourceList_.push(r))},P.prototype.register_=function(){for(var e,t=this.eventSourceList_.length,r=0;r<t;r++)e=this.eventSourceList_[r],this.addEvents_(e.getEvents())},P.prototype.unregister_=function(){for(var e,t=this.eventSourceList_.length,r=0;r<t;r++)e=this.eventSourceList_[r],this.removeEvents_(e.getEvents())},P.prototype.eventHandler_=function(e){var t=e.type,r=this.eventMap_[t];r&&r(e)},P.prototype.addEvents_=function(e){e.forEach(function(e){n.default.listen(this.element_,e,this.eventHandler_,this)},this)},P.prototype.removeEvents_=function(e){e.forEach(function(e){n.default.unlisten(this.element_,e,this.eventHandler_,this)},this)},P.prototype.cloneEvent=function(e,t){for(var r,n={},i=0,o=P.CLONE_PROPS.length;i<o;i++)n[r=P.CLONE_PROPS[i][0]]=e[r]||t[r]||P.CLONE_PROPS[i][1];return n},P.prototype.down=function(e,t){this.fireEvent(p.default.POINTERDOWN,e,t)},P.prototype.move=function(e,t){this.fireEvent(p.default.POINTERMOVE,e,t)},P.prototype.up=function(e,t){this.fireEvent(p.default.POINTERUP,e,t)},P.prototype.enter=function(e,t){e.bubbles=!1,this.fireEvent(p.default.POINTERENTER,e,t)},P.prototype.leave=function(e,t){e.bubbles=!1,this.fireEvent(p.default.POINTERLEAVE,e,t)},P.prototype.over=function(e,t){e.bubbles=!0,this.fireEvent(p.default.POINTEROVER,e,t)},P.prototype.out=function(e,t){e.bubbles=!0,this.fireEvent(p.default.POINTEROUT,e,t)},P.prototype.cancel=function(e,t){this.fireEvent(p.default.POINTERCANCEL,e,t)},P.prototype.leaveOut=function(e,t){this.out(e,t),this.contains_(e.target,e.relatedTarget)||this.leave(e,t)},P.prototype.enterOver=function(e,t){this.over(e,t),this.contains_(e.target,e.relatedTarget)||this.enter(e,t)},P.prototype.contains_=function(e,t){return!(!e||!t)&&e.contains(t)},P.prototype.makeEvent=function(e,t,r){return new y.default(e,r,t)},P.prototype.fireEvent=function(e,t,r){var n=this.makeEvent(e,t,r);this.dispatchEvent(n)},P.prototype.fireNativeEvent=function(e){var t=this.makeEvent(e.type,e,e);this.dispatchEvent(t)},P.prototype.wrapMouseEvent=function(e,t){return this.makeEvent(e,h.default.prepareEvent(t,this),t)},P.prototype.disposeInternal=function(){this.unregister_(),o.default.prototype.disposeInternal.call(this)},P.CLONE_PROPS=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],exports.default=P;
},{"../index.js":42,"../events.js":135,"../events/eventtarget.js":211,"../has.js":137,"../pointer/eventtype.js":212,"../pointer/mousesource.js":251,"../pointer/mssource.js":252,"../pointer/nativesource.js":253,"../pointer/pointerevent.js":254,"../pointer/touchsource.js":255}],127:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=f(e),i=require("./has.js"),n=f(i),s=require("./mapbrowsereventtype.js"),r=f(s),a=require("./mapbrowserpointerevent.js"),o=f(a),d=require("./events.js"),l=f(d),h=require("./events/eventtarget.js"),u=f(h),_=require("./pointer/eventtype.js"),p=f(_),c=require("./pointer/pointereventhandler.js"),v=f(c);function f(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t){u.default.call(this),this.map_=e,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t?t*n.default.DEVICE_PIXEL_RATIO:n.default.DEVICE_PIXEL_RATIO,this.down_=null;var i=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new v.default(i),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=l.default.listen(this.pointerEventHandler_,p.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=l.default.listen(this.pointerEventHandler_,p.default.POINTERMOVE,this.relayEvent_,this)};t.default.inherits(E,u.default),E.prototype.emulateClick_=function(e){var t=new o.default(r.default.CLICK,this.map_,e);this.dispatchEvent(t),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,t=new o.default(r.default.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var t=new o.default(r.default.SINGLECLICK,this.map_,e);this.dispatchEvent(t)}.bind(this),250)},E.prototype.updateActivePointers_=function(e){var t=e;t.type==r.default.POINTERUP||t.type==r.default.POINTERCANCEL?delete this.trackedTouches_[t.pointerId]:t.type==r.default.POINTERDOWN&&(this.trackedTouches_[t.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},E.prototype.handlePointerUp_=function(e){this.updateActivePointers_(e);var t=new o.default(r.default.POINTERUP,this.map_,e);this.dispatchEvent(t),t.propagationStopped||this.dragging_||!this.isMouseActionButton_(e)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(l.default.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},E.prototype.isMouseActionButton_=function(e){return 0===e.button},E.prototype.handlePointerDown_=function(e){this.updateActivePointers_(e);var t=new o.default(r.default.POINTERDOWN,this.map_,e);this.dispatchEvent(t),this.down_=e,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new v.default(document),this.dragListenerKeys_.push(l.default.listen(this.documentPointerEventHandler_,r.default.POINTERMOVE,this.handlePointerMove_,this),l.default.listen(this.documentPointerEventHandler_,r.default.POINTERUP,this.handlePointerUp_,this),l.default.listen(this.pointerEventHandler_,r.default.POINTERCANCEL,this.handlePointerUp_,this)))},E.prototype.handlePointerMove_=function(e){if(this.isMoving_(e)){this.dragging_=!0;var t=new o.default(r.default.POINTERDRAG,this.map_,e,this.dragging_);this.dispatchEvent(t)}e.preventDefault()},E.prototype.relayEvent_=function(e){var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new o.default(e.type,this.map_,e,t))},E.prototype.isMoving_=function(e){return Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_},E.prototype.disposeInternal=function(){this.relayedListenerKey_&&(l.default.unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(l.default.unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(l.default.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),u.default.prototype.disposeInternal.call(this)},exports.default=E;
},{"./index.js":42,"./has.js":137,"./mapbrowsereventtype.js":128,"./mapbrowserpointerevent.js":210,"./events.js":135,"./events/eventtarget.js":211,"./pointer/eventtype.js":212,"./pointer/pointereventhandler.js":213}],130:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};exports.default=e;
},{}],131:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};exports.default=e;
},{}],179:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};exports.default=e;
},{}],70:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./assertionerror.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var s={assert:function(e,t){if(!e)throw new r.default(t)}};exports.default=s;
},{"./assertionerror.js":141}],156:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../asserts.js"),e=s(t),i=require("../obj.js"),n=s(i);function s(t){return t&&t.__esModule?t:{default:t}}var r=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};r.DROP=1/0,r.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,n.default.clear(this.queuedElements_)},r.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},r.prototype.enqueue=function(t){e.default.assert(!(this.keyFunction_(t)in this.queuedElements_),31);var i=this.priorityFunction_(t);return i!=r.DROP&&(this.elements_.push(t),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},r.prototype.getCount=function(){return this.elements_.length},r.prototype.getLeftChildIndex_=function(t){return 2*t+1},r.prototype.getRightChildIndex_=function(t){return 2*t+2},r.prototype.getParentIndex_=function(t){return t-1>>1},r.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},r.prototype.isEmpty=function(){return 0===this.elements_.length},r.prototype.isKeyQueued=function(t){return t in this.queuedElements_},r.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},r.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,s=e[t],r=i[t],o=t;t<n>>1;){var u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),p=h<n&&i[h]<i[u]?h:u;e[t]=e[p],i[t]=i[p],t=p}e[t]=s,i[t]=r,this.siftDown_(o,t)},r.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,s=i[e],r=n[e];e>t;){var o=this.getParentIndex_(e);if(!(n[o]>r))break;i[e]=i[o],n[e]=n[o],e=o}i[e]=s,n[e]=r},r.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,s=this.elements_,o=this.priorities_,u=0,h=s.length;for(e=0;e<h;++e)(i=n(t=s[e]))==r.DROP?delete this.queuedElements_[this.keyFunction_(t)]:(o[u]=i,s[u++]=t);s.length=u,o.length=u,this.heapify_()},exports.default=r;
},{"../asserts.js":70,"../obj.js":52}],133:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=d(e),i=require("./tilestate.js"),a=d(i),l=require("./events.js"),s=d(l),n=require("./events/eventtype.js"),u=d(n),r=require("./structs/priorityqueue.js"),o=d(r);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t){o.default.call(this,function(t){return e.apply(null,t)},function(e){return e[0].getKey()}),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}};t.default.inherits(h,o.default),h.prototype.enqueue=function(e){var t=o.default.prototype.enqueue.call(this,e);if(t){var i=e[0];s.default.listen(i,u.default.CHANGE,this.handleTileChange,this)}return t},h.prototype.getTilesLoading=function(){return this.tilesLoading_},h.prototype.handleTileChange=function(e){var t=e.target,i=t.getState();if(i===a.default.LOADED||i===a.default.ERROR||i===a.default.EMPTY||i===a.default.ABORT){s.default.unlisten(t,u.default.CHANGE,this.handleTileChange,this);var l=t.getKey();l in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[l],--this.tilesLoading_),this.tileChangeCallback_()}},h.prototype.loadMoreTiles=function(e,t){for(var i,l,s,n=0,u=!1;this.tilesLoading_<e&&n<t&&this.getCount()>0;)s=(l=this.dequeue()[0]).getKey(),(i=l.getState())===a.default.ABORT?u=!0:i!==a.default.IDLE||s in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++n,l.load());0===n&&u&&this.tileChangeCallback_()},exports.default=h;
},{"./index.js":42,"./tilestate.js":179,"./events.js":135,"./events/eventtype.js":153,"./structs/priorityqueue.js":156}],78:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./asserts.js"),t=e(r);function e(r){return r&&r.__esModule?r:{default:r}}var a={clamp:function(r,t,e){return Math.min(Math.max(r,t),e)}};a.cosh="cosh"in Math?Math.cosh:function(r){var t=Math.exp(r);return(t+1/t)/2},a.roundUpToPowerOfTwo=function(r){return t.default.assert(0<r,29),Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},a.squaredSegmentDistance=function(r,t,e,n,u,o){var s=u-e,f=o-n;if(0!==s||0!==f){var i=((r-e)*s+(t-n)*f)/(s*s+f*f);i>1?(e=u,n=o):i>0&&(e+=s*i,n+=f*i)}return a.squaredDistance(r,t,e,n)},a.squaredDistance=function(r,t,e,a){var n=e-r,u=a-t;return n*n+u*u},a.solveLinearSystem=function(r){for(var t=r.length,e=0;e<t;e++){for(var a=e,n=Math.abs(r[e][e]),u=e+1;u<t;u++){var o=Math.abs(r[u][e]);o>n&&(n=o,a=u)}if(0===n)return null;var s=r[a];r[a]=r[e],r[e]=s;for(var f=e+1;f<t;f++)for(var i=-r[f][e]/r[e][e],c=e;c<t+1;c++)e==c?r[f][c]=0:r[f][c]+=i*r[e][c]}for(var h=new Array(t),v=t-1;v>=0;v--){h[v]=r[v][t]/r[v][v];for(var l=v-1;l>=0;l--)r[l][t]-=r[l][v]*h[v]}return h},a.toDegrees=function(r){return 180*r/Math.PI},a.toRadians=function(r){return r*Math.PI/180},a.modulo=function(r,t){var e=r%t;return e*t<0?e+t:e},a.lerp=function(r,t,e){return r+e*(t-r)},exports.default=a;
},{"./asserts.js":70}],56:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./math.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var u={createExtent:function(e){return function(r){return r?[t.default.clamp(r[0],e[0],e[2]),t.default.clamp(r[1],e[1],e[3])]:void 0}},none:function(e){return e}};exports.default=u;
},{"./math.js":78}],60:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./array.js"),r=o(e),t=require("./math.js"),a=o(t);function o(e){return e&&e.__esModule?e:{default:e}}var n={createSnapToResolutions:function(e){return function(t,o,n){if(void 0!==t){var u=r.default.linearFindNearest(e,t,n);u=a.default.clamp(u+o,0,e.length-1);var i=Math.floor(u);if(u!=i&&i<e.length-1){var l=e[i]/e[i+1];return e[i]/Math.pow(l,u-i)}return e[i]}}},createSnapToPower:function(e,r,t){return function(a,o,n){if(void 0!==a){var u=-n/2+.5,i=Math.floor(Math.log(r/a)/Math.log(e)+u),l=Math.max(i+o,0);return void 0!==t&&(l=Math.min(l,t)),r/Math.pow(e,l)}}}};exports.default=n;
},{"./array.js":68,"./math.js":78}],62:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./math.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var n={disable:function(e,t){return void 0!==e?0:void 0},none:function(e,t){return void 0!==e?e+t:void 0},createSnapToN:function(e){var t=2*Math.PI/e;return function(e,r){return void 0!==e?e=Math.floor((e+r)/t+.5)*t:void 0}},createSnapToZero:function(e){var r=e||t.default.toRadians(5);return function(e,t){return void 0!==e?Math.abs(e+t)<=r?0:e+t:void 0}}};exports.default=n;
},{"./math.js":78}],64:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={ANIMATING:0,INTERACTING:1};exports.default=e;
},{}],66:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};exports.default=e;
},{}],142:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={padNumber:function(e,r,t){var n=void 0!==t?e.toFixed(t):""+e,a=n.indexOf(".");return(a=-1===a?n.length:a)>r?n:new Array(1+r-a).join("0")+n},compareVersions:function(e,r){for(var t=(""+e).split("."),n=(""+r).split("."),a=0;a<Math.max(t.length,n.length);a++){var i=parseInt(t[a]||"0",10),o=parseInt(n[a]||"0",10);if(i>o)return 1;if(o>i)return-1}return 0}};exports.default=e;
},{}],72:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./math.js"),e=u(t),r=require("./string.js"),n=u(r);function u(t){return t&&t.__esModule?t:{default:t}}var a={add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t},closestOnCircle:function(t,e){var r=e.getRadius(),n=e.getCenter(),u=n[0],a=n[1],o=t[0]-u,i=t[1]-a;0===o&&0===i&&(o=1);var s=Math.sqrt(o*o+i*i);return[u+r*o/s,a+r*i/s]},closestOnSegment:function(t,e){var r,n,u=t[0],a=t[1],o=e[0],i=e[1],s=o[0],c=o[1],f=i[0],d=i[1],l=f-s,g=d-c,M=0===l&&0===g?0:(l*(u-s)+g*(a-c))/(l*l+g*g||0);return M<=0?(r=s,n=c):M>=1?(r=f,n=d):(r=s+M*l,n=c+M*g),[r,n]},createStringXY:function(t){return function(e){return a.toStringXY(e,t)}},degreesToStringHDMS:function(t,r,u){var a=e.default.modulo(r+180,360)-180,o=Math.abs(3600*a),i=u||0,s=Math.pow(10,i),c=Math.floor(o/3600),f=Math.floor((o-3600*c)/60),d=o-3600*c-60*f;return(d=Math.ceil(d*s)/s)>=60&&(d=0,f+=1),f>=60&&(f=0,c+=1),c+"° "+n.default.padNumber(f,2)+"′ "+n.default.padNumber(d,2,i)+"″"+(0==a?"":" "+t.charAt(a<0?1:0))},format:function(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""},equals:function(t,e){for(var r=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r},rotate:function(t,e){var r=Math.cos(e),n=Math.sin(e),u=t[0]*r-t[1]*n,a=t[1]*r+t[0]*n;return t[0]=u,t[1]=a,t},scale:function(t,e){return t[0]*=e,t[1]*=e,t},sub:function(t,e){return t[0]-=e[0],t[1]-=e[1],t},squaredDistance:function(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n},distance:function(t,e){return Math.sqrt(a.squaredDistance(t,e))},squaredDistanceToSegment:function(t,e){return a.squaredDistance(t,a.closestOnSegment(t,e))},toStringHDMS:function(t,e){return t?a.degreesToStringHDMS("NS",t[1],e)+" "+a.degreesToStringHDMS("EW",t[0],e):""},toStringXY:function(t,e){return a.format(t,"{x}, {y}",e)}};exports.default=a;
},{"./math.js":78,"./string.js":142}],74:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n={easeIn:function(n){return Math.pow(n,3)},easeOut:function(e){return 1-n.easeIn(1-e)},inAndOut:function(n){return 3*n*n-2*n*n*n},linear:function(n){return n},upAndDown:function(e){return e<.5?n.inAndOut(2*e):1-n.inAndOut(2*(e-.5))}};exports.default=n;
},{}],160:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};exports.default=t;
},{}],161:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};exports.default=e;
},{}],76:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./asserts.js"),e=u(t),n=require("./extent/corner.js"),r=u(n),a=require("./extent/relationship.js"),o=u(a);function u(t){return t&&t.__esModule?t:{default:t}}var i={boundingExtent:function(t){for(var e=i.createEmpty(),n=0,r=t.length;n<r;++n)i.extendCoordinate(e,t[n]);return e},boundingExtentXYs_:function(t,e,n){var r=Math.min.apply(null,t),a=Math.min.apply(null,e),o=Math.max.apply(null,t),u=Math.max.apply(null,e);return i.createOrUpdate(r,a,o,u,n)},buffer:function(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]},clone:function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()},closestSquaredDistanceXY:function(t,e,n){var r,a;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(a=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*a},containsCoordinate:function(t,e){return i.containsXY(t,e[0],e[1])},containsExtent:function(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]},containsXY:function(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]},coordinateRelationship:function(t,e){var n=t[0],r=t[1],a=t[2],u=t[3],i=e[0],c=e[1],f=o.default.UNKNOWN;return i<n?f|=o.default.LEFT:i>a&&(f|=o.default.RIGHT),c<r?f|=o.default.BELOW:c>u&&(f|=o.default.ABOVE),f===o.default.UNKNOWN&&(f=o.default.INTERSECTING),f},createEmpty:function(){return[1/0,1/0,-1/0,-1/0]},createOrUpdate:function(t,e,n,r,a){return a?(a[0]=t,a[1]=e,a[2]=n,a[3]=r,a):[t,e,n,r]},createOrUpdateEmpty:function(t){return i.createOrUpdate(1/0,1/0,-1/0,-1/0,t)},createOrUpdateFromCoordinate:function(t,e){var n=t[0],r=t[1];return i.createOrUpdate(n,r,n,r,e)},createOrUpdateFromCoordinates:function(t,e){var n=i.createOrUpdateEmpty(e);return i.extendCoordinates(n,t)},createOrUpdateFromFlatCoordinates:function(t,e,n,r,a){var o=i.createOrUpdateEmpty(a);return i.extendFlatCoordinates(o,t,e,n,r)},createOrUpdateFromRings:function(t,e){var n=i.createOrUpdateEmpty(e);return i.extendRings(n,t)},equals:function(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]},extend:function(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t},extendCoordinate:function(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])},extendCoordinates:function(t,e){var n,r;for(n=0,r=e.length;n<r;++n)i.extendCoordinate(t,e[n]);return t},extendFlatCoordinates:function(t,e,n,r,a){for(;n<r;n+=a)i.extendXY(t,e[n],e[n+1]);return t},extendRings:function(t,e){var n,r;for(n=0,r=e.length;n<r;++n)i.extendCoordinates(t,e[n]);return t},extendXY:function(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)},forEachCorner:function(t,e,n){var r;return(r=e.call(n,i.getBottomLeft(t)))?r:(r=e.call(n,i.getBottomRight(t)))?r:(r=e.call(n,i.getTopRight(t)))?r:(r=e.call(n,i.getTopLeft(t)))||!1},getArea:function(t){var e=0;return i.isEmpty(t)||(e=i.getWidth(t)*i.getHeight(t)),e},getBottomLeft:function(t){return[t[0],t[1]]},getBottomRight:function(t){return[t[2],t[1]]},getCenter:function(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]},getCorner:function(t,n){var a;return n===r.default.BOTTOM_LEFT?a=i.getBottomLeft(t):n===r.default.BOTTOM_RIGHT?a=i.getBottomRight(t):n===r.default.TOP_LEFT?a=i.getTopLeft(t):n===r.default.TOP_RIGHT?a=i.getTopRight(t):e.default.assert(!1,13),a},getEnlargedArea:function(t,e){var n=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-n)*(Math.max(t[3],e[3])-r)},getForViewAndSize:function(t,e,n,r,a){var o=e*r[0]/2,u=e*r[1]/2,c=Math.cos(n),f=Math.sin(n),d=o*c,l=o*f,s=u*c,g=u*f,p=t[0],h=t[1],m=p-d+g,E=p-d-g,x=p+d-g,O=p+d+g,T=h-l-s,v=h-l+s,M=h+l+s,R=h+l-s;return i.createOrUpdate(Math.min(m,E,x,O),Math.min(T,v,M,R),Math.max(m,E,x,O),Math.max(T,v,M,R),a)},getHeight:function(t){return t[3]-t[1]},getIntersectionArea:function(t,e){var n=i.getIntersection(t,e);return i.getArea(n)},getIntersection:function(t,e,n){var r=n||i.createEmpty();return i.intersects(t,e)&&(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]),r},getMargin:function(t){return i.getWidth(t)+i.getHeight(t)},getSize:function(t){return[t[2]-t[0],t[3]-t[1]]},getTopLeft:function(t){return[t[0],t[3]]},getTopRight:function(t){return[t[2],t[3]]},getWidth:function(t){return t[2]-t[0]},intersects:function(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]},isEmpty:function(t){return t[2]<t[0]||t[3]<t[1]},returnOrUpdate:function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t},scaleFromCenter:function(t,e){var n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r},intersectsSegment:function(t,e,n){var r=!1,a=i.coordinateRelationship(t,e),u=i.coordinateRelationship(t,n);if(a===o.default.INTERSECTING||u===o.default.INTERSECTING)r=!0;else{var c,f,d=t[0],l=t[1],s=t[2],g=t[3],p=e[0],h=e[1],m=n[0],E=n[1],x=(E-h)/(m-p);u&o.default.ABOVE&&!(a&o.default.ABOVE)&&(r=(c=m-(E-g)/x)>=d&&c<=s),r||!(u&o.default.RIGHT)||a&o.default.RIGHT||(r=(f=E-(m-s)*x)>=l&&f<=g),r||!(u&o.default.BELOW)||a&o.default.BELOW||(r=(c=m-(E-l)/x)>=d&&c<=s),r||!(u&o.default.LEFT)||a&o.default.LEFT||(r=(f=E-(m-d)*x)>=l&&f<=g)}return r},applyTransform:function(t,e,n){var r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];e(r,r,2);var a=[r[0],r[2],r[4],r[6]],o=[r[1],r[3],r[5],r[7]];return i.boundingExtentXYs_(a,o,n)}};exports.default=i;
},{"./asserts.js":70,"./extent/corner.js":160,"./extent/relationship.js":161}],82:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};exports.default=e;
},{}],162:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};exports.default=e;
},{}],136:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={TRUE:function(){return!0},FALSE:function(){return!1}};exports.default=e;
},{}],175:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={transform2D:function(r,t,e,n,a,o){var f,l=o||[],u=0;for(f=t;f<e;f+=n){var v=r[f],h=r[f+1];l[u++]=a[0]*v+a[2]*h+a[4],l[u++]=a[1]*v+a[3]*h+a[5]}return o&&l.length!=u&&(l.length=u),l},rotate:function(r,t,e,n,a,o,f){for(var l=f||[],u=Math.cos(a),v=Math.sin(a),h=o[0],s=o[1],c=0,g=t;g<e;g+=n){var i=r[g]-h,d=r[g+1]-s;l[c++]=h+i*u-d*v,l[c++]=s+i*v+d*u;for(var p=g+2;p<g+n;++p)l[c++]=r[p]}return f&&l.length!=c&&(l.length=c),l},scale:function(r,t,e,n,a,o,f,l){for(var u=l||[],v=f[0],h=f[1],s=0,c=t;c<e;c+=n){var g=r[c]-v,i=r[c+1]-h;u[s++]=v+a*g,u[s++]=h+o*i;for(var d=c+2;d<c+n;++d)u[s++]=r[d]}return l&&u.length!=s&&(u.length=s),u},translate:function(r,t,e,n,a,o,f){var l,u,v=f||[],h=0;for(l=t;l<e;l+=n)for(v[h++]=r[l]+a,v[h++]=r[l+1]+o,u=l+2;u<l+n;++u)v[h++]=r[u];return f&&v.length!=h&&(v.length=h),v}};exports.default=r;
},{}],80:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./math.js"),t=s(e),a=require("./geom/geometrytype.js"),r=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var n=function(e){this.radius=e};n.prototype.geodesicArea=function(e){return n.getArea_(e,this.radius)},n.prototype.haversineDistance=function(e,t){return n.getDistance_(e,t,this.radius)},n.prototype.offset=function(e,a,r){var s=t.default.toRadians(e[1]),n=t.default.toRadians(e[0]),o=a/this.radius,u=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(r)),i=n+Math.atan2(Math.sin(r)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(u));return[t.default.toDegrees(i),t.default.toDegrees(u)]},n.DEFAULT_RADIUS=6371008.8,n.getLength=function(e,t){var a,s,o,u,i,d,f=t||{},h=f.radius||n.DEFAULT_RADIUS,g=f.projection||"EPSG:3857",c=(e=e.clone().transform(g,"EPSG:4326")).getType(),l=0;switch(c){case r.default.POINT:case r.default.MULTI_POINT:break;case r.default.LINE_STRING:case r.default.LINEAR_RING:a=e.getCoordinates(),l=n.getLength_(a,h);break;case r.default.MULTI_LINE_STRING:case r.default.POLYGON:for(o=0,u=(a=e.getCoordinates()).length;o<u;++o)l+=n.getLength_(a[o],h);break;case r.default.MULTI_POLYGON:for(o=0,u=(a=e.getCoordinates()).length;o<u;++o)for(i=0,d=(s=a[o]).length;i<d;++i)l+=n.getLength_(s[i],h);break;case r.default.GEOMETRY_COLLECTION:var M=e.getGeometries();for(o=0,u=M.length;o<u;++o)l+=n.getLength(M[o],t);break;default:throw new Error("Unsupported geometry type: "+c)}return l},n.getLength_=function(e,t){for(var a=0,r=0,s=e.length;r<s-1;++r)a+=n.getDistance_(e[r],e[r+1],t);return a},n.getDistance_=function(e,a,r){var s=t.default.toRadians(e[1]),n=t.default.toRadians(a[1]),o=(n-s)/2,u=t.default.toRadians(a[0]-e[0])/2,i=Math.sin(o)*Math.sin(o)+Math.sin(u)*Math.sin(u)*Math.cos(s)*Math.cos(n);return 2*r*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))},n.getArea=function(e,t){var a,s,o,u,i,d,f=t||{},h=f.radius||n.DEFAULT_RADIUS,g=f.projection||"EPSG:3857",c=(e=e.clone().transform(g,"EPSG:4326")).getType(),l=0;switch(c){case r.default.POINT:case r.default.MULTI_POINT:case r.default.LINE_STRING:case r.default.MULTI_LINE_STRING:case r.default.LINEAR_RING:break;case r.default.POLYGON:for(a=e.getCoordinates(),l=Math.abs(n.getArea_(a[0],h)),o=1,u=a.length;o<u;++o)l-=Math.abs(n.getArea_(a[o],h));break;case r.default.MULTI_POLYGON:for(o=0,u=(a=e.getCoordinates()).length;o<u;++o)for(s=a[o],l+=Math.abs(n.getArea_(s[0],h)),i=1,d=s.length;i<d;++i)l-=Math.abs(n.getArea_(s[i],h));break;case r.default.GEOMETRY_COLLECTION:var M=e.getGeometries();for(o=0,u=M.length;o<u;++o)l+=n.getArea(M[o],t);break;default:throw new Error("Unsupported geometry type: "+c)}return l},n.getArea_=function(e,a){for(var r=0,s=e.length,n=e[s-1][0],o=e[s-1][1],u=0;u<s;u++){var i=e[u][0],d=e[u][1];r+=t.default.toRadians(i-n)*(2+Math.sin(t.default.toRadians(o))+Math.sin(t.default.toRadians(d))),n=i,o=d}return r*a*a/2},exports.default=n;
},{"./math.js":78,"./geom/geometrytype.js":82}],88:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft",METERS_PER_UNIT:{}};E.METERS_PER_UNIT[E.DEGREES]=2*Math.PI*6370997/360,E.METERS_PER_UNIT[E.FEET]=.3048,E.METERS_PER_UNIT[E.METERS]=1,E.METERS_PER_UNIT[E.USFEET]=1200/3937,exports.default=E;
},{}],96:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={cache_:null,set:function(t){e.cache_=t},get:function(){return e.cache_||window.proj4}};exports.default=e;
},{}],94:[function(require,module,exports) {
var global = (1,eval)("this");
var t=(0,eval)("this");Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),i=u(e),n=require("../proj/units.js"),o=u(n),r=require("../proj/proj4.js"),s=u(r);function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit;var e=t.code;if(i.default.ENABLE_PROJ4JS){var n=s.default.get();if("function"==typeof n){var o=n.defs(e);void 0!==o&&(void 0!==o.axis&&void 0===t.axisOrientation&&(this.axisOrientation_=o.axis),void 0===t.metersPerUnit&&(this.metersPerUnit_=o.to_meter),void 0===t.units&&(this.units_=o.units))}}};l.prototype.canWrapX=function(){return this.canWrapX_},l.prototype.getCode=function(){return this.code_},l.prototype.getExtent=function(){return this.extent_},l.prototype.getUnits=function(){return this.units_},l.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||o.default.METERS_PER_UNIT[this.units_]},l.prototype.getWorldExtent=function(){return this.worldExtent_},l.prototype.getAxisOrientation=function(){return this.axisOrientation_},l.prototype.isGlobal=function(){return this.global_},l.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},l.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},l.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},l.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},l.prototype.setWorldExtent=function(t){this.worldExtent_=t},l.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},l.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},exports.default=l;
},{"../index.js":42,"../proj/units.js":88,"../proj/proj4.js":96}],90:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=E(e),r=require("../math.js"),n=E(r),o=require("../proj/projection.js"),i=E(o),a=require("../proj/units.js"),u=E(a);function E(e){return e&&e.__esModule?e:{default:e}}var c={Projection_:function(e){i.default.call(this,{code:e,units:u.default.METERS,extent:c.EXTENT,global:!0,worldExtent:c.WORLD_EXTENT,getPointResolution:function(e,t){return e/n.default.cosh(t[1]/c.RADIUS)}})}};t.default.inherits(c.Projection_,i.default),c.RADIUS=6378137,c.HALF_SIZE=Math.PI*c.RADIUS,c.EXTENT=[-c.HALF_SIZE,-c.HALF_SIZE,c.HALF_SIZE,c.HALF_SIZE],c.WORLD_EXTENT=[-180,-85,180,85],c.PROJECTIONS=[new c.Projection_("EPSG:3857"),new c.Projection_("EPSG:102100"),new c.Projection_("EPSG:102113"),new c.Projection_("EPSG:900913"),new c.Projection_("urn:ogc:def:crs:EPSG:6.18:3:3857"),new c.Projection_("urn:ogc:def:crs:EPSG::3857"),new c.Projection_("http://www.opengis.net/gml/srs/epsg.xml#3857")],c.fromEPSG4326=function(e,t,r){var n=e.length,o=r>1?r:2,i=t;void 0===i&&(i=o>2?e.slice():new Array(n));for(var a=c.HALF_SIZE,u=0;u<n;u+=o){i[u]=a*e[u]/180;var E=c.RADIUS*Math.log(Math.tan(Math.PI*(e[u+1]+90)/360));E>a?E=a:E<-a&&(E=-a),i[u+1]=E}return i},c.toEPSG4326=function(e,t,r){var n=e.length,o=r>1?r:2,i=t;void 0===i&&(i=o>2?e.slice():new Array(n));for(var a=0;a<n;a+=o)i[a]=180*e[a]/c.HALF_SIZE,i[a+1]=360*Math.atan(Math.exp(e[a+1]/c.RADIUS))/Math.PI-90;return i},exports.default=c;
},{"../index.js":42,"../math.js":78,"../proj/projection.js":94,"../proj/units.js":88}],92:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),n=u(e),r=require("../proj/projection.js"),t=u(r),o=require("../proj/units.js"),i=u(o);function u(e){return e&&e.__esModule?e:{default:e}}var c={Projection_:function(e,n){t.default.call(this,{code:e,units:i.default.DEGREES,extent:c.EXTENT,axisOrientation:n,global:!0,metersPerUnit:c.METERS_PER_UNIT,worldExtent:c.EXTENT})}};n.default.inherits(c.Projection_,t.default),c.RADIUS=6378137,c.EXTENT=[-180,-90,180,90],c.METERS_PER_UNIT=Math.PI*c.RADIUS/180,c.PROJECTIONS=[new c.Projection_("CRS:84"),new c.Projection_("EPSG:4326","neu"),new c.Projection_("urn:ogc:def:crs:EPSG::4326","neu"),new c.Projection_("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new c.Projection_("urn:ogc:def:crs:OGC:1.3:CRS84"),new c.Projection_("urn:ogc:def:crs:OGC:2:84"),new c.Projection_("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c.Projection_("urn:x-ogc:def:crs:EPSG:4326","neu")],exports.default=c;
},{"../index.js":42,"../proj/projection.js":94,"../proj/units.js":88}],98:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={cache_:{},clear:function(){e.cache_={}},get:function(c){return e.cache_[c]||null},add:function(c,t){e.cache_[c]=t}};exports.default=e;
},{}],100:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../obj.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var c={cache_:{},clear:function(){c.cache_={}},add:function(e,t,r){var n=e.getCode(),a=t.getCode(),o=c.cache_;n in o||(o[n]={}),o[n][a]=r},remove:function(e,r){var n=e.getCode(),a=r.getCode(),o=c.cache_,u=o[n][a];return delete o[n][a],t.default.isEmpty(o[n])&&delete o[n],u},get:function(e,t){var r,n=c.cache_;return e in n&&t in n[e]&&(r=n[e][t]),r}};exports.default=c;
},{"../obj.js":52}],34:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),r=R(e),t=require("./sphere.js"),o=R(t),n=require("./extent.js"),a=R(n),f=require("./math.js"),i=R(f),d=require("./proj/epsg3857.js"),u=R(d),s=require("./proj/epsg4326.js"),c=R(s),l=require("./proj/projection.js"),E=R(l),m=require("./proj/units.js"),v=R(m),P=require("./proj/proj4.js"),g=R(P),j=require("./proj/projections.js"),T=R(j),S=require("./proj/transforms.js"),p=R(S);function R(e){return e&&e.__esModule?e:{default:e}}var q={};q.METERS_PER_UNIT=v.default.METERS_PER_UNIT,q.SPHERE_=new o.default(o.default.DEFAULT_RADIUS),r.default.ENABLE_PROJ4JS&&(q.setProj4=function(e){g.default.set(e)}),q.getPointResolution=function(e,r,t,o){var n,a=(e=q.get(e)).getPointResolutionFunc();if(a)n=a(r,t);else if(e.getUnits()==v.default.DEGREES&&!o||o==v.default.DEGREES)n=r;else{var f=q.getTransformFromProjections(e,q.get("EPSG:4326")),i=[t[0]-r/2,t[1],t[0]+r/2,t[1],t[0],t[1]-r/2,t[0],t[1]+r/2];i=f(i,i,2),n=(q.SPHERE_.haversineDistance(i.slice(0,2),i.slice(2,4))+q.SPHERE_.haversineDistance(i.slice(4,6),i.slice(6,8)))/2;var d=o?v.default.METERS_PER_UNIT[o]:e.getMetersPerUnit();void 0!==d&&(n/=d)}return n},q.addEquivalentProjections=function(e){q.addProjections(e),e.forEach(function(r){e.forEach(function(e){r!==e&&p.default.add(r,e,q.cloneTransform)})})},q.addEquivalentTransforms=function(e,r,t,o){e.forEach(function(e){r.forEach(function(r){p.default.add(e,r,t),p.default.add(r,e,o)})})},q.addProjection=function(e){T.default.add(e.getCode(),e),p.default.add(e,e,q.cloneTransform)},q.addProjections=function(e){e.forEach(q.addProjection)},q.clearAllProjections=function(){T.default.clear(),p.default.clear()},q.createProjection=function(e,r){return e?"string"==typeof e?q.get(e):e:q.get(r)},q.addCoordinateTransforms=function(e,r,t,o){var n=q.get(e),a=q.get(r);p.default.add(n,a,q.createTransformFromCoordinateTransform(t)),p.default.add(a,n,q.createTransformFromCoordinateTransform(o))},q.createTransformFromCoordinateTransform=function(e){return function(r,t,o){var n,a,f,i=r.length,d=void 0!==o?o:2,u=void 0!==t?t:new Array(i);for(a=0;a<i;a+=d)for(n=e([r[a],r[a+1]]),u[a]=n[0],u[a+1]=n[1],f=d-1;f>=2;--f)u[a+f]=r[a+f];return u}},q.fromLonLat=function(e,r){return q.transform(e,"EPSG:4326",void 0!==r?r:"EPSG:3857")},q.toLonLat=function(e,r){var t=q.transform(e,void 0!==r?r:"EPSG:3857","EPSG:4326"),o=t[0];return(o<-180||o>180)&&(t[0]=i.default.modulo(o+180,360)-180),t},q.get=function(e){var t=null;if(e instanceof E.default)t=e;else if("string"==typeof e){var o=e;if(t=T.default.get(o),r.default.ENABLE_PROJ4JS&&!t){var n=g.default.get();"function"==typeof n&&void 0!==n.defs(o)&&(t=new E.default({code:o}),q.addProjection(t))}}return t},q.equivalent=function(e,r){if(e===r)return!0;var t=e.getUnits()===r.getUnits();return e.getCode()===r.getCode()?t:q.getTransformFromProjections(e,r)===q.cloneTransform&&t},q.getTransform=function(e,r){var t=q.get(e),o=q.get(r);return q.getTransformFromProjections(t,o)},q.getTransformFromProjections=function(e,t){var o=e.getCode(),n=t.getCode(),a=p.default.get(o,n);if(r.default.ENABLE_PROJ4JS&&!a){var f=g.default.get();if("function"==typeof f){var i=f.defs(o),d=f.defs(n);if(void 0!==i&&void 0!==d){if(i===d)q.addEquivalentProjections([t,e]);else{var u=f(n,o);q.addCoordinateTransforms(t,e,u.forward,u.inverse)}a=p.default.get(o,n)}}}return a||(a=q.identityTransform),a},q.identityTransform=function(e,r,t){if(void 0!==r&&e!==r){for(var o=0,n=e.length;o<n;++o)r[o]=e[o];e=r}return e},q.cloneTransform=function(e,r,t){var o;if(void 0!==r){for(var n=0,a=e.length;n<a;++n)r[n]=e[n];o=r}else o=e.slice();return o},q.transform=function(e,r,t){return q.getTransform(r,t)(e,void 0,e.length)},q.transformExtent=function(e,r,t){var o=q.getTransform(r,t);return a.default.applyTransform(e,o)},q.transformWithProjections=function(e,r,t){return q.getTransformFromProjections(r,t)(e)},q.addCommon=function(){q.addEquivalentProjections(u.default.PROJECTIONS),q.addEquivalentProjections(c.default.PROJECTIONS),q.addEquivalentTransforms(c.default.PROJECTIONS,u.default.PROJECTIONS,u.default.fromEPSG4326,u.default.toEPSG4326)},q.addCommon(),exports.default=q;
},{"./index.js":42,"./sphere.js":80,"./extent.js":76,"./math.js":78,"./proj/epsg3857.js":90,"./proj/epsg4326.js":92,"./proj/projection.js":94,"./proj/units.js":88,"./proj/proj4.js":96,"./proj/projections.js":98,"./proj/transforms.js":100}],139:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./asserts.js"),r=e(t);function e(t){return t&&t.__esModule?t:{default:t}}var n={};n.tmp_=new Array(6),n.create=function(){return[1,0,0,1,0,0]},n.reset=function(t){return n.set(t,1,0,0,1,0,0)},n.multiply=function(t,r){var e=t[0],n=t[1],u=t[2],a=t[3],s=t[4],i=t[5],o=r[0],c=r[1],f=r[2],l=r[3],p=r[4],m=r[5];return t[0]=e*o+u*c,t[1]=n*o+a*c,t[2]=e*f+u*l,t[3]=n*f+a*l,t[4]=e*p+u*m+s,t[5]=n*p+a*m+i,t},n.set=function(t,r,e,n,u,a,s){return t[0]=r,t[1]=e,t[2]=n,t[3]=u,t[4]=a,t[5]=s,t},n.setFromArray=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},n.apply=function(t,r){var e=r[0],n=r[1];return r[0]=t[0]*e+t[2]*n+t[4],r[1]=t[1]*e+t[3]*n+t[5],r},n.rotate=function(t,r){var e=Math.cos(r),u=Math.sin(r);return n.multiply(t,n.set(n.tmp_,e,u,-u,e,0,0))},n.scale=function(t,r,e){return n.multiply(t,n.set(n.tmp_,r,0,0,e,0,0))},n.translate=function(t,r,e){return n.multiply(t,n.set(n.tmp_,1,0,0,1,r,e))},n.compose=function(t,r,e,n,u,a,s,i){var o=Math.sin(a),c=Math.cos(a);return t[0]=n*c,t[1]=u*o,t[2]=-n*o,t[3]=u*c,t[4]=s*n*c-i*n*o+r,t[5]=s*u*o+i*u*c+e,t},n.invert=function(t){var e=n.determinant(t);r.default.assert(0!==e,32);var u=t[0],a=t[1],s=t[2],i=t[3],o=t[4],c=t[5];return t[0]=i/e,t[1]=-a/e,t[2]=-s/e,t[3]=u/e,t[4]=(s*c-i*o)/e,t[5]=-(u*c-a*o)/e,t},n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},exports.default=n;
},{"./asserts.js":70}],165:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=h(t),o=require("../object.js"),r=h(o),n=require("../extent.js"),i=h(n),s=require("../functions.js"),u=h(s),p=require("../geom/flat/transform.js"),f=h(p),a=require("../proj.js"),l=h(a),c=require("../proj/units.js"),d=h(c),m=require("../transform.js"),y=h(m);function h(t){return t&&t.__esModule?t:{default:t}}var g=function(){r.default.call(this),this.extent_=i.default.createEmpty(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.tmpTransform_=y.default.create()};e.default.inherits(g,r.default),g.prototype.clone=function(){},g.prototype.closestPointXY=function(t,e,o,r){},g.prototype.getClosestPoint=function(t,e){var o=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],o,1/0),o},g.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},g.prototype.computeExtent=function(t){},g.prototype.containsXY=u.default.FALSE,g.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),i.default.returnOrUpdate(this.extent_,t)},g.prototype.rotate=function(t,e){},g.prototype.scale=function(t,e,o){},g.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},g.prototype.getSimplifiedGeometry=function(t){},g.prototype.getType=function(){},g.prototype.applyTransform=function(t){},g.prototype.intersectsExtent=function(t){},g.prototype.translate=function(t,e){},g.prototype.transform=function(t,e){var o=this.tmpTransform_,r=(t=l.default.get(t)).getUnits()==d.default.TILE_PIXELS?function(r,n,s){var u=t.getExtent(),p=t.getWorldExtent(),a=i.default.getHeight(p)/i.default.getHeight(u);return y.default.compose(o,p[0],p[3],a,-a,0,0,0),f.default.transform2D(r,0,r.length,s,o,n),l.default.getTransform(t,e)(r,n,s)}:l.default.getTransform(t,e);return this.applyTransform(r),this},exports.default=g;
},{"../index.js":42,"../object.js":58,"../extent.js":76,"../functions.js":136,"../geom/flat/transform.js":175,"../proj.js":34,"../proj/units.js":88,"../transform.js":139}],86:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=y(t),i=require("../functions.js"),r=y(i),o=require("../extent.js"),a=y(o),n=require("../geom/geometry.js"),s=y(n),l=require("../geom/geometrylayout.js"),d=y(l),u=require("../geom/flat/transform.js"),f=y(u),h=require("../obj.js"),p=y(h);function y(t){return t&&t.__esModule?t:{default:t}}var g=function(){s.default.call(this),this.layout=d.default.XY,this.stride=2,this.flatCoordinates=null};e.default.inherits(g,s.default),g.getLayoutForStride_=function(t){var e;return 2==t?e=d.default.XY:3==t?e=d.default.XYZ:4==t&&(e=d.default.XYZM),e},g.getStrideForLayout=function(t){var e;return t==d.default.XY?e=2:t==d.default.XYZ||t==d.default.XYM?e=3:t==d.default.XYZM&&(e=4),e},g.prototype.containsXY=r.default.FALSE,g.prototype.computeExtent=function(t){return a.default.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},g.prototype.getCoordinates=function(){},g.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},g.prototype.getFlatCoordinates=function(){return this.flatCoordinates},g.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},g.prototype.getLayout=function(){return this.layout},g.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(p.default.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},g.prototype.getSimplifiedGeometryInternal=function(t){return this},g.prototype.getStride=function(){return this.stride},g.prototype.setFlatCoordinatesInternal=function(t,e){this.stride=g.getStrideForLayout(t),this.layout=t,this.flatCoordinates=e},g.prototype.setCoordinates=function(t,e){},g.prototype.setLayout=function(t,e,i){var r;if(t)r=g.getStrideForLayout(t);else{var o;for(o=0;o<i;++o){if(0===e.length)return this.layout=d.default.XY,void(this.stride=2);e=e[0]}r=e.length,t=g.getLayoutForStride_(r)}this.layout=t,this.stride=r},g.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},g.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var r=this.getStride();f.default.rotate(i,0,i.length,r,t,e,i),this.changed()}},g.prototype.scale=function(t,e,i){var r=e;void 0===r&&(r=t);var o=i;o||(o=a.default.getCenter(this.getExtent()));var n=this.getFlatCoordinates();if(n){var s=this.getStride();f.default.scale(n,0,n.length,s,t,r,o,n),this.changed()}},g.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var r=this.getStride();f.default.translate(i,0,i.length,r,t,e,i),this.changed()}},g.transform2D=function(t,e,i){var r=t.getFlatCoordinates();if(r){var o=t.getStride();return f.default.transform2D(r,0,r.length,o,e,i)}return null},exports.default=g;
},{"../index.js":42,"../functions.js":136,"../extent.js":76,"../geom/geometry.js":165,"../geom/geometrylayout.js":162,"../geom/flat/transform.js":175,"../obj.js":52}],166:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={linearRing:function(r,n,e,t){for(var i=0,a=r[e-t],l=r[e-t+1];n<e;n+=t){var o=r[n],u=r[n+1];i+=l*o-a*u,a=o,l=u}return i/2},linearRings:function(n,e,t,i){var a,l,o=0;for(a=0,l=t.length;a<l;++a){var u=t[a];o+=r.linearRing(n,e,u,i),e=u}return o},linearRingss:function(n,e,t,i){var a,l,o=0;for(a=0,l=t.length;a<l;++a){var u=t[a];o+=r.linearRings(n,e,u,i),e=u[u.length-1]}return o}};exports.default=r;
},{}],167:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../math.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var a={point:function(e,r,a,n,u,o,s){var f,l,i=e[r],g=e[r+1],d=e[a]-i,v=e[a+1]-g;if(0===d&&0===v)l=r;else{var h=((u-i)*d+(o-g)*v)/(d*d+v*v);if(h>1)l=a;else{if(h>0){for(f=0;f<n;++f)s[f]=t.default.lerp(e[r+f],e[a+f],h);return void(s.length=n)}l=r}}for(f=0;f<n;++f)s[f]=e[l+f];s.length=n},getMaxSquaredDelta:function(e,r,a,n,u){var o=e[r],s=e[r+1];for(r+=n;r<a;r+=n){var f=e[r],l=e[r+1],i=t.default.squaredDistance(o,s,f,l);i>u&&(u=i),o=f,s=l}return u},getsMaxSquaredDelta:function(e,t,r,n,u){var o,s;for(o=0,s=r.length;o<s;++o){var f=r[o];u=a.getMaxSquaredDelta(e,t,f,n,u),t=f}return u},getssMaxSquaredDelta:function(e,t,r,n,u){var o,s;for(o=0,s=r.length;o<s;++o){var f=r[o];u=a.getsMaxSquaredDelta(e,t,f,n,u),t=f[f.length-1]}return u},getClosestPoint:function(e,r,n,u,o,s,f,l,i,g,d){if(r==n)return g;var v,h;if(0===o){if((h=t.default.squaredDistance(f,l,e[r],e[r+1]))<g){for(v=0;v<u;++v)i[v]=e[r+v];return i.length=u,h}return g}for(var c=d||[NaN,NaN],q=r+u;q<n;)if(a.point(e,q-u,q,u,f,l,c),(h=t.default.squaredDistance(f,l,c[0],c[1]))<g){for(g=h,v=0;v<u;++v)i[v]=c[v];i.length=u,q+=u}else q+=u*Math.max((Math.sqrt(h)-Math.sqrt(g))/o|0,1);if(s&&(a.point(e,n-u,r,u,f,l,c),(h=t.default.squaredDistance(f,l,c[0],c[1]))<g)){for(g=h,v=0;v<u;++v)i[v]=c[v];i.length=u}return g},getsClosestPoint:function(e,t,r,n,u,o,s,f,l,i,g){var d,v,h=g||[NaN,NaN];for(d=0,v=r.length;d<v;++d){var c=r[d];i=a.getClosestPoint(e,t,c,n,u,o,s,f,l,i,h),t=c}return i},getssClosestPoint:function(e,t,r,n,u,o,s,f,l,i,g){var d,v,h=g||[NaN,NaN];for(d=0,v=r.length;d<v;++d){var c=r[d];i=a.getsClosestPoint(e,t,c,n,u,o,s,f,l,i,h),t=c[c.length-1]}return i}};exports.default=a;
},{"../../math.js":78}],169:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={coordinate:function(r,e,t,n){var o,a;for(o=0,a=t.length;o<a;++o)r[e++]=t[o];return e},coordinates:function(r,e,t,n){var o,a;for(o=0,a=t.length;o<a;++o){var s,c=t[o];for(s=0;s<n;++s)r[e++]=c[s]}return e},coordinatess:function(e,t,n,o,a){var s,c,i=a||[],u=0;for(s=0,c=n.length;s<c;++s){var f=r.coordinates(e,t,n[s],o);i[u++]=f,t=f}return i.length=u,i},coordinatesss:function(e,t,n,o,a){var s,c,i=a||[],u=0;for(s=0,c=n.length;s<c;++s){var f=r.coordinatess(e,t,n[s],o,i[u]);i[u++]=f,t=f[f.length-1]}return i.length=u,i}};exports.default=r;
},{}],170:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={coordinates:function(e,r,t,o,n){var s,i=void 0!==n?n:[],a=0;for(s=r;s<t;s+=o)i[a++]=e.slice(s,s+o);return i.length=a,i},coordinatess:function(r,t,o,n,s){var i,a,c=void 0!==s?s:[],d=0;for(i=0,a=o.length;i<a;++i){var l=o[i];c[d++]=e.coordinates(r,t,l,n,c[d]),t=l}return c.length=d,c},coordinatesss:function(r,t,o,n,s){var i,a,c=void 0!==s?s:[],d=0;for(i=0,a=o.length;i<a;++i){var l=o[i];c[d++]=e.coordinatess(r,t,l,n,c[d]),t=l[l.length-1]}return c.length=d,c}};exports.default=e;
},{}],174:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../math.js"),e=n(r);function n(r){return r&&r.__esModule?r:{default:r}}var u={lineString:function(r,e,n,a,t,s,o){var i=void 0!==o?o:[];return s||(n=u.radialDistance(r,e,n,a,t,i,0),r=i,e=0,a=2),i.length=u.douglasPeucker(r,e,n,a,t,i,0),i},douglasPeucker:function(r,n,u,a,t,s,o){var i=(u-n)/a;if(i<3){for(;n<u;n+=a)s[o++]=r[n],s[o++]=r[n+1];return o}var f=new Array(i);f[0]=1,f[i-1]=1;for(var l,v=[n,u-a],c=0;v.length>0;){var d=v.pop(),p=v.pop(),h=0,g=r[p],q=r[p+1],P=r[d],k=r[d+1];for(l=p+a;l<d;l+=a){var z=r[l],D=r[l+1],_=e.default.squaredSegmentDistance(z,D,g,q,P,k);_>h&&(c=l,h=_)}h>t&&(f[(c-n)/a]=1,p+a<c&&v.push(p,c),c+a<d&&v.push(c,d))}for(l=0;l<i;++l)f[l]&&(s[o++]=r[n+l*a],s[o++]=r[n+l*a+1]);return o},douglasPeuckers:function(r,e,n,a,t,s,o,i){var f,l;for(f=0,l=n.length;f<l;++f){var v=n[f];o=u.douglasPeucker(r,e,v,a,t,s,o),i.push(o),e=v}return o},douglasPeuckerss:function(r,e,n,a,t,s,o,i){var f,l;for(f=0,l=n.length;f<l;++f){var v=n[f],c=[];o=u.douglasPeuckers(r,e,v,a,t,s,o,c),i.push(c),e=v[v.length-1]}return o},radialDistance:function(r,n,u,a,t,s,o){if(u<=n+a){for(;n<u;n+=a)s[o++]=r[n],s[o++]=r[n+1];return o}var i=r[n],f=r[n+1];s[o++]=i,s[o++]=f;var l=i,v=f;for(n+=a;n<u;n+=a)l=r[n],v=r[n+1],e.default.squaredDistance(i,f,l,v)>t&&(s[o++]=l,s[o++]=v,i=l,f=v);return l==i&&v==f||(s[o++]=l,s[o++]=v),o},snap:function(r,e){return e*Math.round(r/e)},quantize:function(r,e,n,a,t,s,o){if(e==n)return o;var i,f,l=u.snap(r[e],t),v=u.snap(r[e+1],t);e+=a,s[o++]=l,s[o++]=v;do{if(i=u.snap(r[e],t),f=u.snap(r[e+1],t),(e+=a)==n)return s[o++]=i,s[o++]=f,o}while(i==l&&f==v);for(;e<n;){var c,d;if(c=u.snap(r[e],t),d=u.snap(r[e+1],t),e+=a,c!=i||d!=f){var p=i-l,h=f-v,g=c-l,q=d-v;p*q==h*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(h<0&&q<h||h==q||h>0&&q>h)?(i=c,f=d):(s[o++]=i,s[o++]=f,l=i,v=f,i=c,f=d)}}return s[o++]=i,s[o++]=f,o},quantizes:function(r,e,n,a,t,s,o,i){var f,l;for(f=0,l=n.length;f<l;++f){var v=n[f];o=u.quantize(r,e,v,a,t,s,o),i.push(o),e=v}return o},quantizess:function(r,e,n,a,t,s,o,i){var f,l;for(f=0,l=n.length;f<l;++f){var v=n[f],c=[];o=u.quantizes(r,e,v,a,t,s,o,c),i.push(c),e=v[v.length-1]}return o}};exports.default=u;
},{"../../math.js":78}],163:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=x(t),i=require("../extent.js"),s=x(i),o=require("../geom/geometrylayout.js"),a=x(o),r=require("../geom/geometrytype.js"),n=x(r),l=require("../geom/simplegeometry.js"),d=x(l),u=require("../geom/flat/area.js"),f=x(u),h=require("../geom/flat/closest.js"),g=x(h),c=require("../geom/flat/deflate.js"),p=x(c),C=require("../geom/flat/inflate.js"),m=x(C),y=require("../geom/flat/simplify.js"),q=x(y);function x(t){return t&&t.__esModule?t:{default:t}}var j=function(t,e){d.default.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};e.default.inherits(j,d.default),j.prototype.clone=function(){var t=new j(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},j.prototype.closestPointXY=function(t,e,i,o){return o<s.default.closestSquaredDistanceXY(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(g.default.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),g.default.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,o))},j.prototype.getArea=function(){return f.default.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},j.prototype.getCoordinates=function(){return m.default.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},j.prototype.getSimplifiedGeometryInternal=function(t){var e=[];e.length=q.default.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);var i=new j(null);return i.setFlatCoordinates(a.default.XY,e),i},j.prototype.getType=function(){return n.default.LINEAR_RING},j.prototype.intersectsExtent=function(t){},j.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=p.default.coordinates(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(a.default.XY,null)},j.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=j;
},{"../index.js":42,"../extent.js":76,"../geom/geometrylayout.js":162,"../geom/geometrytype.js":82,"../geom/simplegeometry.js":86,"../geom/flat/area.js":166,"../geom/flat/closest.js":167,"../geom/flat/deflate.js":169,"../geom/flat/inflate.js":170,"../geom/flat/simplify.js":174}],164:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=p(t),o=require("../extent.js"),r=p(o),i=require("../geom/geometrylayout.js"),s=p(i),n=require("../geom/geometrytype.js"),a=p(n),l=require("../geom/simplegeometry.js"),u=p(l),d=require("../geom/flat/deflate.js"),f=p(d),h=require("../math.js"),c=p(h);function p(t){return t&&t.__esModule?t:{default:t}}var C=function(t,e){u.default.call(this),this.setCoordinates(t,e)};e.default.inherits(C,u.default),C.prototype.clone=function(){var t=new C(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},C.prototype.closestPointXY=function(t,e,o,r){var i=this.flatCoordinates,s=c.default.squaredDistance(t,e,i[0],i[1]);if(s<r){var n,a=this.stride;for(n=0;n<a;++n)o[n]=i[n];return o.length=a,s}return r},C.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},C.prototype.computeExtent=function(t){return r.default.createOrUpdateFromCoordinate(this.flatCoordinates,t)},C.prototype.getType=function(){return a.default.POINT},C.prototype.intersectsExtent=function(t){return r.default.containsXY(t,this.flatCoordinates[0],this.flatCoordinates[1])},C.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=f.default.coordinate(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},C.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=C;
},{"../index.js":42,"../extent.js":76,"../geom/geometrylayout.js":162,"../geom/geometrytype.js":82,"../geom/simplegeometry.js":86,"../geom/flat/deflate.js":169,"../math.js":78}],168:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../../extent.js"),r=e(n);function e(n){return n&&n.__esModule?n:{default:n}}var t={linearRingContainsExtent:function(n,e,i,a,u){return!r.default.forEachCorner(u,function(r){return!t.linearRingContainsXY(n,e,i,a,r[0],r[1])})},linearRingContainsXY:function(n,r,e,t,i,a){for(var u=0,o=n[e-t],f=n[e-t+1];r<e;r+=t){var l=n[r],s=n[r+1];f<=a?s>a&&(l-o)*(a-f)-(i-o)*(s-f)>0&&u++:s<=a&&(l-o)*(a-f)-(i-o)*(s-f)<0&&u--,o=l,f=s}return 0!==u},linearRingsContainsXY:function(n,r,e,i,a,u){if(0===e.length)return!1;if(!t.linearRingContainsXY(n,r,e[0],i,a,u))return!1;var o,f;for(o=1,f=e.length;o<f;++o)if(t.linearRingContainsXY(n,e[o-1],e[o],i,a,u))return!1;return!0},linearRingssContainsXY:function(n,r,e,i,a,u){if(0===e.length)return!1;var o,f;for(o=0,f=e.length;o<f;++o){var l=e[o];if(t.linearRingsContainsXY(n,r,l,i,a,u))return!0;r=l[l.length-1]}return!1}};exports.default=t;
},{"../../extent.js":76}],171:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../array.js"),e=t(r),n=require("../flat/contains.js"),a=t(n);function t(r){return r&&r.__esModule?r:{default:r}}var s={linearRings:function(r,n,t,s,u,i,o){for(var l,f,v,g,c,d,h,p=u[i+1],N=[],R=0,_=t.length;R<_;++R){var b=t[R];for(g=r[b-s],d=r[b-s+1],l=n;l<b;l+=s)c=r[l],h=r[l+1],(p<=d&&h<=p||d<=p&&p<=h)&&(v=(p-d)/(h-d)*(c-g)+g,N.push(v)),g=c,d=h}var j=NaN,M=-1/0;for(N.sort(e.default.numberSafeCompareFunction),g=N[0],l=1,f=N.length;l<f;++l){c=N[l];var m=Math.abs(c-g);m>M&&(v=(g+c)/2,a.default.linearRingsContainsXY(r,n,t,s,v,p)&&(j=v,M=m)),g=c}return isNaN(j)&&(j=u[i]),o?(o.push(j,p,M),o):[j,p,M]},linearRingss:function(r,e,n,a,t){var u,i,o=[];for(u=0,i=n.length;u<i;++u){var l=n[u];o=s.linearRings(r,e,l,a,t,2*u,o),e=l[l.length-1]}return o}};exports.default=s;
},{"../../array.js":68,"../flat/contains.js":168}],224:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={forEach:function(e,r,t,o,u,a){for(var f,c=[e[r],e[r+1]],l=[];r+o<t;r+=o){if(l[0]=e[r+o],l[1]=e[r+o+1],f=u.call(a,c,l))return f;c[0]=l[0],c[1]=l[1]}return!1}};exports.default=e;
},{}],172:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../../extent.js"),e=u(n),t=require("../flat/contains.js"),r=u(t),i=require("../flat/segments.js"),a=u(i);function u(n){return n&&n.__esModule?n:{default:n}}var l={lineString:function(n,t,r,i,u){var l=e.default.extendFlatCoordinates(e.default.createEmpty(),n,t,r,i);return!!e.default.intersects(u,l)&&(!!e.default.containsExtent(u,l)||(l[0]>=u[0]&&l[2]<=u[2]||(l[1]>=u[1]&&l[3]<=u[3]||a.default.forEach(n,t,r,i,function(n,t){return e.default.intersectsSegment(u,n,t)}))))},lineStrings:function(n,e,t,r,i){var a,u;for(a=0,u=t.length;a<u;++a){if(l.lineString(n,e,t[a],r,i))return!0;e=t[a]}return!1},linearRing:function(n,e,t,i,a){return!!l.lineString(n,e,t,i,a)||(!!r.default.linearRingContainsXY(n,e,t,i,a[0],a[1])||(!!r.default.linearRingContainsXY(n,e,t,i,a[0],a[3])||(!!r.default.linearRingContainsXY(n,e,t,i,a[2],a[1])||!!r.default.linearRingContainsXY(n,e,t,i,a[2],a[3]))))},linearRings:function(n,e,t,i,a){if(!l.linearRing(n,e,t[0],i,a))return!1;if(1===t.length)return!0;var u,f;for(u=1,f=t.length;u<f;++u)if(r.default.linearRingContainsExtent(n,t[u-1],t[u],i,a))return!1;return!0},linearRingss:function(n,e,t,r,i){var a,u;for(a=0,u=t.length;a<u;++a){var f=t[a];if(l.linearRings(n,e,f,r,i))return!0;e=f[f.length-1]}return!1}};exports.default=l;
},{"../../extent.js":76,"../flat/contains.js":168,"../flat/segments.js":224}],223:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={coordinates:function(e,r,o,t){for(;r<o-t;){var a;for(a=0;a<t;++a){var s=e[r+a];e[r+a]=e[o-t+a],e[o-t+a]=s}r+=t,o-=t}}};exports.default=e;
},{}],173:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../flat/reverse.js"),e=n(r);function n(r){return r&&r.__esModule?r:{default:r}}var i={linearRingIsClockwise:function(r,e,n,i){for(var t=0,o=r[n-i],a=r[n-i+1];e<n;e+=i){var s=r[e],u=r[e+1];t+=(s-o)*(u+a),o=s,a=u}return t>0},linearRingsAreOriented:function(r,e,n,t,o){var a,s,u=void 0!==o&&o;for(a=0,s=n.length;a<s;++a){var l=n[a],f=i.linearRingIsClockwise(r,e,l,t);if(0===a){if(u&&f||!u&&!f)return!1}else if(u&&!f||!u&&f)return!1;e=l}return!0},linearRingssAreOriented:function(r,e,n,t,o){var a,s;for(a=0,s=n.length;a<s;++a)if(!i.linearRingsAreOriented(r,e,n[a],t,o))return!1;return!0},orientLinearRings:function(r,n,t,o,a){var s,u,l=void 0!==a&&a;for(s=0,u=t.length;s<u;++s){var f=t[s],v=i.linearRingIsClockwise(r,n,f,o);(0===s?l&&v||!l&&!v:l&&!v||!l&&v)&&e.default.coordinates(r,n,f,o),n=f}return n},orientLinearRingss:function(r,e,n,t,o){var a,s;for(a=0,s=n.length;a<s;++a)e=i.orientLinearRings(r,e,n[a],t,o);return e}};exports.default=i;
},{"../flat/reverse.js":223}],84:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=S(t),i=require("../array.js"),n=S(i),s=require("../extent.js"),r=S(s),o=require("../geom/geometrylayout.js"),a=S(o),l=require("../geom/geometrytype.js"),d=S(l),u=require("../geom/linearring.js"),h=S(u),f=require("../geom/point.js"),g=S(f),c=require("../geom/simplegeometry.js"),p=S(c),C=require("../geom/flat/area.js"),_=S(C),v=require("../geom/flat/closest.js"),y=S(v),m=require("../geom/flat/contains.js"),R=S(m),F=require("../geom/flat/deflate.js"),q=S(F),j=require("../geom/flat/inflate.js"),x=S(j),P=require("../geom/flat/interiorpoint.js"),I=S(P),L=require("../geom/flat/intersectsextent.js"),M=S(L),O=require("../geom/flat/orient.js"),Y=S(O),w=require("../geom/flat/simplify.js"),X=S(w),D=require("../math.js"),E=S(D);function S(t){return t&&t.__esModule?t:{default:t}}var A=function(t,e){p.default.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};e.default.inherits(A,p.default),A.prototype.appendLinearRing=function(t){this.flatCoordinates?n.default.extend(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},A.prototype.clone=function(){var t=new A(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},A.prototype.closestPointXY=function(t,e,i,n){return n<r.default.closestSquaredDistanceXY(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(y.default.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),y.default.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},A.prototype.containsXY=function(t,e){return R.default.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},A.prototype.getArea=function(){return _.default.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},A.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Y.default.orientLinearRings(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,x.default.coordinatess(e,0,this.ends_,this.stride)},A.prototype.getEnds=function(){return this.ends_},A.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=r.default.getCenter(this.getExtent());this.flatInteriorPoint_=I.default.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},A.prototype.getInteriorPoint=function(){return new g.default(this.getFlatInteriorPoint(),a.default.XYM)},A.prototype.getLinearRingCount=function(){return this.ends_.length},A.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t)return null;var e=new h.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},A.prototype.getLinearRings=function(){var t,e,i=this.layout,n=this.flatCoordinates,s=this.ends_,r=[],o=0;for(t=0,e=s.length;t<e;++t){var a=s[t],l=new h.default(null);l.setFlatCoordinates(i,n.slice(o,a)),r.push(l),o=a}return r},A.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Y.default.linearRingsAreOriented(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Y.default.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},A.prototype.getSimplifiedGeometryInternal=function(t){var e=[],i=[];e.length=X.default.quantizes(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i);var n=new A(null);return n.setFlatCoordinates(a.default.XY,e,i),n},A.prototype.getType=function(){return d.default.POLYGON},A.prototype.intersectsExtent=function(t){return M.default.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},A.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=q.default.coordinatess(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}else this.setFlatCoordinates(a.default.XY,null,this.ends_)},A.prototype.setFlatCoordinates=function(t,e,i){this.setFlatCoordinatesInternal(t,e),this.ends_=i,this.changed()},A.circular=function(t,e,i,s){var r,o=s||32,l=[];for(r=0;r<o;++r)n.default.extend(l,t.offset(e,i,2*Math.PI*r/o));l.push(l[0],l[1]);var d=new A(null);return d.setFlatCoordinates(a.default.XY,l,[l.length]),d},A.fromExtent=function(t){var e=t[0],i=t[1],n=t[2],s=t[3],r=[e,i,e,s,n,s,n,i,e,i],o=new A(null);return o.setFlatCoordinates(a.default.XY,r,[r.length]),o},A.fromCircle=function(t,e,i){for(var n=e||32,s=t.getStride(),r=t.getLayout(),o=new A(null,r),a=s*(n+1),l=new Array(a),d=0;d<a;d++)l[d]=0;var u=[l.length];return o.setFlatCoordinates(r,l,u),A.makeRegular(o,t.getCenter(),t.getRadius(),i),o},A.makeRegular=function(t,e,i,n){for(var s,r,o=t.getFlatCoordinates(),a=t.getLayout(),l=t.getStride(),d=t.getEnds(),u=o.length/l-1,h=n||0,f=0;f<=u;++f)r=f*l,s=h+2*E.default.modulo(f,u)*Math.PI/u,o[r]=e[0]+i*Math.cos(s),o[r+1]=e[1]+i*Math.sin(s);t.setFlatCoordinates(a,o,d)},exports.default=A;
},{"../index.js":42,"../array.js":68,"../extent.js":76,"../geom/geometrylayout.js":162,"../geom/geometrytype.js":82,"../geom/linearring.js":163,"../geom/point.js":164,"../geom/simplegeometry.js":86,"../geom/flat/area.js":166,"../geom/flat/closest.js":167,"../geom/flat/contains.js":168,"../geom/flat/deflate.js":169,"../geom/flat/inflate.js":170,"../geom/flat/interiorpoint.js":171,"../geom/flat/intersectsextent.js":172,"../geom/flat/orient.js":173,"../geom/flat/simplify.js":174,"../math.js":78}],32:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),o=P(t),e=require("./centerconstraint.js"),i=P(e),n=require("./object.js"),r=P(n),s=require("./resolutionconstraint.js"),a=P(s),u=require("./rotationconstraint.js"),l=P(u),h=require("./viewhint.js"),c=P(h),d=require("./viewproperty.js"),p=P(d),m=require("./array.js"),f=P(m),g=require("./asserts.js"),R=P(g),_=require("./coordinate.js"),v=P(_),y=require("./easing.js"),M=P(y),C=require("./extent.js"),A=P(C),E=require("./geom/geometrytype.js"),x=P(E),T=require("./geom/polygon.js"),N=P(T),I=require("./geom/simplegeometry.js"),Z=P(I),O=require("./math.js"),j=P(O),F=require("./obj.js"),S=P(F),q=require("./proj.js"),w=P(q),z=require("./proj/units.js"),b=P(z);function P(t){return t&&t.__esModule?t:{default:t}}var U=function(t){r.default.call(this);var o=S.default.assign({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=w.default.createProjection(o.projection,"EPSG:3857"),this.applyOptions_(o)};o.default.inherits(U,r.default),U.prototype.applyOptions_=function(t){var o={};o[p.default.CENTER]=void 0!==t.center?t.center:null;var e=U.createResolutionConstraint_(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var i=U.createCenterConstraint_(t),n=e.constraint,r=U.createRotationConstraint_(t);this.constraints_={center:i,resolution:n,rotation:r},void 0!==t.resolution?o[p.default.RESOLUTION]=t.resolution:void 0!==t.zoom&&(o[p.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(o[p.default.RESOLUTION]=j.default.clamp(Number(this.getResolution()||o[p.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),o[p.default.ROTATION]=void 0!==t.rotation?t.rotation:0,this.setProperties(o),this.options_=t},U.prototype.getUpdatedOptions_=function(t){var o=S.default.assign({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenter(),o.rotation=this.getRotation(),S.default.assign({},o,t)},U.prototype.animate=function(t){var o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){var i=arguments[e-1];return i.center&&this.setCenter(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(o&&o(!0))}for(var n=Date.now(),r=this.getCenter().slice(),s=this.getResolution(),a=this.getRotation(),u=[],l=0;l<e;++l){var h=arguments[l],d={start:n,complete:!1,anchor:h.anchor,duration:void 0!==h.duration?h.duration:1e3,easing:h.easing||M.default.inAndOut};if(h.center&&(d.sourceCenter=r,d.targetCenter=h.center,r=d.targetCenter),void 0!==h.zoom?(d.sourceResolution=s,d.targetResolution=this.constrainResolution(this.maxResolution_,h.zoom-this.minZoom_,0),s=d.targetResolution):h.resolution&&(d.sourceResolution=s,d.targetResolution=h.resolution,s=d.targetResolution),void 0!==h.rotation){d.sourceRotation=a;var p=j.default.modulo(h.rotation-a+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=a+p,a=d.targetRotation}d.callback=o,U.isNoopAnimation(d)?d.complete=!0:n+=d.duration,u.push(d)}this.animations_.push(u),this.setHint(c.default.ANIMATING,1),this.updateAnimations_()},U.prototype.getAnimating=function(){return this.hints_[c.default.ANIMATING]>0},U.prototype.getInteracting=function(){return this.hints_[c.default.INTERACTING]>0},U.prototype.cancelAnimations=function(){this.setHint(c.default.ANIMATING,-this.hints_[c.default.ANIMATING]);for(var t=0,o=this.animations_.length;t<o;++t){var e=this.animations_[t];e[0].callback&&e[0].callback(!1)}this.animations_.length=0},U.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),o=!1,e=this.animations_.length-1;e>=0;--e){for(var i=this.animations_[e],n=!0,r=0,s=i.length;r<s;++r){var a=i[r];if(!a.complete){var u=t-a.start,l=a.duration>0?u/a.duration:1;l>=1?(a.complete=!0,l=1):n=!1;var h=a.easing(l);if(a.sourceCenter){var d=a.sourceCenter[0],m=a.sourceCenter[1],f=d+h*(a.targetCenter[0]-d),g=m+h*(a.targetCenter[1]-m);this.set(p.default.CENTER,[f,g])}if(a.sourceResolution&&a.targetResolution){var R=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(p.default.CENTER,this.calculateCenterZoom(R,a.anchor)),this.set(p.default.RESOLUTION,R)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var _=1===h?j.default.modulo(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(p.default.CENTER,this.calculateCenterRotate(_,a.anchor)),this.set(p.default.ROTATION,_)}if(o=!0,!a.complete)break}}if(n){this.animations_[e]=null,this.setHint(c.default.ANIMATING,-1);var v=i[0].callback;v&&v(!0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},U.prototype.calculateCenterRotate=function(t,o){var e,i=this.getCenter();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],v.default.rotate(e,t-this.getRotation()),v.default.add(e,o)),e},U.prototype.calculateCenterZoom=function(t,o){var e,i=this.getCenter(),n=this.getResolution();void 0!==i&&void 0!==n&&(e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]);return e},U.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+o.default.getUid(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},U.prototype.constrainCenter=function(t){return this.constraints_.center(t)},U.prototype.constrainResolution=function(t,o,e){var i=o||0,n=e||0;return this.constraints_.resolution(t,i,n)},U.prototype.constrainRotation=function(t,o){var e=o||0;return this.constraints_.rotation(t,e)},U.prototype.getCenter=function(){return this.get(p.default.CENTER)},U.prototype.getConstraints=function(){return this.constraints_},U.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},U.prototype.calculateExtent=function(t){var o=t||this.getSizeFromViewport_(),e=this.getCenter();R.default.assert(e,1);var i=this.getResolution();R.default.assert(void 0!==i,2);var n=this.getRotation();return R.default.assert(void 0!==n,3),A.default.getForViewAndSize(e,i,n,o)},U.prototype.getMaxResolution=function(){return this.maxResolution_},U.prototype.getMinResolution=function(){return this.minResolution_},U.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},U.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},U.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},U.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},U.prototype.getProjection=function(){return this.projection_},U.prototype.getResolution=function(){return this.get(p.default.RESOLUTION)},U.prototype.getResolutions=function(){return this.resolutions_},U.prototype.getResolutionForExtent=function(t,o){var e=o||this.getSizeFromViewport_(),i=A.default.getWidth(t)/e[0],n=A.default.getHeight(t)/e[1];return Math.max(i,n)},U.prototype.getResolutionForValueFunction=function(t){var o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},U.prototype.getRotation=function(){return this.get(p.default.ROTATION)},U.prototype.getValueForResolutionFunction=function(t){var o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return Math.log(e/t)/Math.log(o)/n}},U.prototype.getState=function(){var t=this.getCenter(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},U.prototype.getZoom=function(){var t,o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},U.prototype.getZoomForResolution=function(t){var o,e,i=this.minZoom_||0;if(this.resolutions_){var n=f.default.linearFindNearest(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},U.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},U.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),t instanceof Z.default?t.getType()===x.default.CIRCLE?(t=t.getExtent(),(i=N.default.fromExtent(t)).rotate(this.getRotation(),A.default.getCenter(t))):i=t:(R.default.assert(Array.isArray(t),24),R.default.assert(!A.default.isEmpty(t),25),i=N.default.fromExtent(t));var s,a=void 0!==n.padding?n.padding:[0,0,0,0],u=void 0===n.constrainResolution||n.constrainResolution,l=void 0!==n.nearest&&n.nearest;s=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var h=i.getFlatCoordinates(),c=this.getRotation(),d=Math.cos(-c),p=Math.sin(-c),m=1/0,f=1/0,g=-1/0,_=-1/0,v=i.getStride(),y=0,M=h.length;y<M;y+=v){var C=h[y]*d-h[y+1]*p,E=h[y]*p+h[y+1]*d;m=Math.min(m,C),f=Math.min(f,E),g=Math.max(g,C),_=Math.max(_,E)}var T=this.getResolutionForExtent([m,f,g,_],[r[0]-a[1]-a[3],r[1]-a[0]-a[2]]);if(T=isNaN(T)?s:Math.max(T,s),u){var I=this.constrainResolution(T,0,0);!l&&I<T&&(I=this.constrainResolution(I,-1,0)),T=I}p=-p;var O=(m+g)/2,j=(f+_)/2,F=[(O+=(a[1]-a[3])/2*T)*d-(j+=(a[0]-a[2])/2*T)*p,j*d+O*p],S=n.callback?n.callback:o.default.nullFunction;void 0!==n.duration?this.animate({resolution:T,center:F,duration:n.duration,easing:n.easing},S):(this.setResolution(T),this.setCenter(F),setTimeout(S.bind(void 0,!0),0))},U.prototype.centerOn=function(t,o,e){var i=this.getRotation(),n=Math.cos(-i),r=Math.sin(-i),s=t[0]*n-t[1]*r,a=t[1]*n+t[0]*r,u=this.getResolution(),l=(s+=(o[0]/2-e[0])*u)*n-(a+=(e[1]-o[1]/2)*u)*(r=-r),h=a*n+s*r;this.setCenter([l,h])},U.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},U.prototype.rotate=function(t,o){if(void 0!==o){var e=this.calculateCenterRotate(t,o);this.setCenter(e)}this.setRotation(t)},U.prototype.setCenter=function(t){this.set(p.default.CENTER,t),this.getAnimating()&&this.cancelAnimations()},U.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},U.prototype.setResolution=function(t){this.set(p.default.RESOLUTION,t),this.getAnimating()&&this.cancelAnimations()},U.prototype.setRotation=function(t){this.set(p.default.ROTATION,t),this.getAnimating()&&this.cancelAnimations()},U.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},U.createCenterConstraint_=function(t){return void 0!==t.extent?i.default.createExtent(t.extent):i.default.none},U.createResolutionConstraint_=function(t){var e,i,n,r=void 0!==t.minZoom?t.minZoom:o.default.DEFAULT_MIN_ZOOM,s=void 0!==t.maxZoom?t.maxZoom:28,u=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var l=t.resolutions;i=l[r],n=void 0!==l[s]?l[s]:l[l.length-1],e=a.default.createSnapToResolutions(l)}else{var h=w.default.createProjection(t.projection,"EPSG:3857"),c=h.getExtent(),d=(c?Math.max(A.default.getWidth(c),A.default.getHeight(c)):360*w.default.METERS_PER_UNIT[b.default.DEGREES]/h.getMetersPerUnit())/o.default.DEFAULT_TILE_SIZE/Math.pow(2,o.default.DEFAULT_MIN_ZOOM),p=d/Math.pow(2,28-o.default.DEFAULT_MIN_ZOOM);void 0!==(i=t.maxResolution)?r=0:i=d/Math.pow(u,r),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(u,s):d/Math.pow(u,s):p),s=r+Math.floor(Math.log(i/n)/Math.log(u)),n=i/Math.pow(u,s-r),e=a.default.createSnapToPower(u,i,s-r)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:r,zoomFactor:u}},U.createRotationConstraint_=function(t){if(void 0===t.enableRotation||t.enableRotation){var o=t.constrainRotation;return void 0===o||!0===o?l.default.createSnapToZero():!1===o?l.default.none:"number"==typeof o?l.default.createSnapToN(o):l.default.none}return l.default.disable},U.isNoopAnimation=function(t){return!(t.sourceCenter&&t.targetCenter&&!v.default.equals(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)},exports.default=U;
},{"./index.js":42,"./centerconstraint.js":56,"./object.js":58,"./resolutionconstraint.js":60,"./rotationconstraint.js":62,"./viewhint.js":64,"./viewproperty.js":66,"./array.js":68,"./asserts.js":70,"./coordinate.js":72,"./easing.js":74,"./extent.js":76,"./geom/geometrytype.js":82,"./geom/polygon.js":84,"./geom/simplegeometry.js":86,"./math.js":78,"./obj.js":52,"./proj.js":34,"./proj/units.js":88}],134:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={createCanvasContext2D:function(e,t){var r=document.createElement("CANVAS");return e&&(r.width=e),t&&(r.height=t),r.getContext("2d")},outerWidth:function(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)},outerHeight:function(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)},replaceNode:function(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)},removeNode:function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},removeChildren:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)}};exports.default=e;
},{}],228:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};exports.default=e;
},{}],220:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=p(t),i=require("../object.js"),o=p(i),s=require("../layer/property.js"),n=p(s),u=require("../math.js"),r=p(u),a=require("../obj.js"),l=p(a);function p(t){return t&&t.__esModule?t:{default:t}}var f=function(t){o.default.call(this);var e=l.default.assign({},t);e[n.default.OPACITY]=void 0!==t.opacity?t.opacity:1,e[n.default.VISIBLE]=void 0===t.visible||t.visible,e[n.default.Z_INDEX]=void 0!==t.zIndex?t.zIndex:0,e[n.default.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[n.default.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(e),this.state_={layer:this,managed:!0},this.type};e.default.inherits(f,o.default),f.prototype.getType=function(){return this.type},f.prototype.getLayerState=function(){return this.state_.opacity=r.default.clamp(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},f.prototype.getLayersArray=function(t){},f.prototype.getLayerStatesArray=function(t){},f.prototype.getExtent=function(){return this.get(n.default.EXTENT)},f.prototype.getMaxResolution=function(){return this.get(n.default.MAX_RESOLUTION)},f.prototype.getMinResolution=function(){return this.get(n.default.MIN_RESOLUTION)},f.prototype.getOpacity=function(){return this.get(n.default.OPACITY)},f.prototype.getSourceState=function(){},f.prototype.getVisible=function(){return this.get(n.default.VISIBLE)},f.prototype.getZIndex=function(){return this.get(n.default.Z_INDEX)},f.prototype.setExtent=function(t){this.set(n.default.EXTENT,t)},f.prototype.setMaxResolution=function(t){this.set(n.default.MAX_RESOLUTION,t)},f.prototype.setMinResolution=function(t){this.set(n.default.MIN_RESOLUTION,t)},f.prototype.setOpacity=function(t){this.set(n.default.OPACITY,t)},f.prototype.setVisible=function(t){this.set(n.default.VISIBLE,t)},f.prototype.setZIndex=function(t){this.set(n.default.Z_INDEX,t)},exports.default=f;
},{"../index.js":42,"../object.js":58,"../layer/property.js":228,"../math.js":78,"../obj.js":52}],194:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};exports.default=e;
},{}],154:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=x(e),s=require("../collection.js"),r=x(s),a=require("../collectioneventtype.js"),i=x(a),n=require("../object.js"),l=x(n),o=require("../objecteventtype.js"),u=x(o),h=require("../asserts.js"),y=x(h),d=require("../events.js"),f=x(d),c=require("../events/eventtype.js"),g=x(c),p=require("../extent.js"),_=x(p),L=require("../layer/base.js"),v=x(L),A=require("../obj.js"),E=x(A),R=require("../source/state.js"),j=x(R);function x(e){return e&&e.__esModule?e:{default:e}}var K=function(e){var t=e||{},s=E.default.assign({},t);delete s.layers;var a=t.layers;v.default.call(this,s),this.layersListenerKeys_=[],this.listenerKeys_={},f.default.listen(this,l.default.getChangeEventType(K.Property_.LAYERS),this.handleLayersChanged_,this),a?Array.isArray(a)?a=new r.default(a.slice(),{unique:!0}):(y.default.assert(a instanceof r.default,43),a=a):a=new r.default(void 0,{unique:!0}),this.setLayers(a)};t.default.inherits(K,v.default),K.prototype.handleLayerChange_=function(){this.changed()},K.prototype.handleLayersChanged_=function(e){this.layersListenerKeys_.forEach(f.default.unlistenByKey),this.layersListenerKeys_.length=0;var s=this.getLayers();for(var r in this.layersListenerKeys_.push(f.default.listen(s,i.default.ADD,this.handleLayersAdd_,this),f.default.listen(s,i.default.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[r].forEach(f.default.unlistenByKey);E.default.clear(this.listenerKeys_);var a,n,l,o=s.getArray();for(a=0,n=o.length;a<n;a++)l=o[a],this.listenerKeys_[t.default.getUid(l).toString()]=[f.default.listen(l,u.default.PROPERTYCHANGE,this.handleLayerChange_,this),f.default.listen(l,g.default.CHANGE,this.handleLayerChange_,this)];this.changed()},K.prototype.handleLayersAdd_=function(e){var s=e.element,r=t.default.getUid(s).toString();this.listenerKeys_[r]=[f.default.listen(s,u.default.PROPERTYCHANGE,this.handleLayerChange_,this),f.default.listen(s,g.default.CHANGE,this.handleLayerChange_,this)],this.changed()},K.prototype.handleLayersRemove_=function(e){var s=e.element,r=t.default.getUid(s).toString();this.listenerKeys_[r].forEach(f.default.unlistenByKey),delete this.listenerKeys_[r],this.changed()},K.prototype.getLayers=function(){return this.get(K.Property_.LAYERS)},K.prototype.setLayers=function(e){this.set(K.Property_.LAYERS,e)},K.prototype.getLayersArray=function(e){var t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},K.prototype.getLayerStatesArray=function(e){var t=void 0!==e?e:[],s=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});var r,a,i,n=this.getLayerState();for(r=s,a=t.length;r<a;r++)(i=t[r]).opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==i.extent?i.extent=_.default.getIntersection(i.extent,n.extent):i.extent=n.extent);return t},K.prototype.getSourceState=function(){return j.default.READY},K.Property_={LAYERS:"layers"},exports.default=K;
},{"../index.js":42,"../collection.js":123,"../collectioneventtype.js":125,"../object.js":58,"../objecteventtype.js":132,"../asserts.js":70,"../events.js":135,"../events/eventtype.js":153,"../extent.js":76,"../layer/base.js":220,"../obj.js":52,"../source/state.js":194}],46:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E={MAP_RENDERER:"MAP_RENDERER",LAYER_RENDERER:"LAYER_RENDERER"};exports.default=E;
},{}],54:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./plugintype.js"),r=n(e);function n(e){return e&&e.__esModule?e:{default:e}}var u={mapRendererPlugins_:[],getMapRendererPlugins:function(){return u.mapRendererPlugins_},layerRendererPlugins_:[],getLayerRendererPlugins:function(){return u.layerRendererPlugins_},register:function(e,n){switch(e){case r.default.MAP_RENDERER:u.mapRendererPlugins_.push(n);break;case r.default.LAYER_RENDERER:u.layerRendererPlugins_.push(n);break;default:throw new Error("Unsupported plugin type: "+e)}},registerMultiple:function(e,r){for(var n=0,t=r.length;n<t;++n)u.register(e,r[n])}};exports.default=u;
},{"./plugintype.js":46}],155:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CANVAS:"canvas",WEBGL:"webgl"};exports.default=e;
},{}],138:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={buffer:function(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]+2*e,t[1]=r[1]+2*e,t},hasArea:function(r){return r[0]>0&&r[1]>0},scale:function(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t},toSize:function(r,e){return Array.isArray(r)?r:(void 0===e?e=[r,r]:e[0]=e[1]=r,e)}};exports.default=r;
},{}],44:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=ne(e),i=require("./collection.js"),r=ne(i),n=require("./collectioneventtype.js"),a=ne(n),s=require("./mapbrowserevent.js"),o=ne(s),l=require("./mapbrowsereventhandler.js"),d=ne(l),h=require("./mapbrowsereventtype.js"),u=ne(h),f=require("./mapevent.js"),p=ne(f),y=require("./mapeventtype.js"),v=ne(y),c=require("./mapproperty.js"),g=ne(c),_=require("./object.js"),E=ne(_),m=require("./objecteventtype.js"),A=ne(m),T=require("./tilequeue.js"),w=ne(T),R=require("./view.js"),I=ne(R),C=require("./viewhint.js"),S=ne(C),L=require("./asserts.js"),P=ne(L),F=require("./dom.js"),V=ne(F),b=require("./events.js"),x=ne(b),W=require("./events/event.js"),M=ne(W),j=require("./events/eventtype.js"),D=ne(j),O=require("./extent.js"),U=ne(O),k=require("./functions.js"),G=ne(k),H=require("./has.js"),K=ne(H),q=require("./layer/group.js"),N=ne(q),z=require("./obj.js"),B=ne(z),Y=require("./plugins.js"),X=ne(Y),Q=require("./renderer/type.js"),Z=ne(Q),J=require("./size.js"),$=ne(J),ee=require("./structs/priorityqueue.js"),te=ne(ee),ie=require("./transform.js"),re=ne(ie);function ne(e){return e&&e.__esModule?e:{default:e}}var ae=function(e){E.default.call(this);var t=ae.createOptionsInternal(e);this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:K.default.DEVICE_PIXEL_RATIO,this.logos_=t.logos,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=re.default.create(),this.pixelToCoordinateTransform_=re.default.create(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(K.default.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var i=[D.default.CLICK,D.default.DBLCLICK,D.default.MOUSEDOWN,D.default.TOUCHSTART,D.default.MSPOINTERDOWN,u.default.POINTERDOWN,D.default.MOUSEWHEEL,D.default.WHEEL],n=0,s=i.length;n<s;++n)x.default.listen(this.overlayContainerStopEvent_,i[n],M.default.stopPropagation);for(var o in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new d.default(this,e.moveTolerance),u.default)x.default.listen(this.mapBrowserEventHandler_,u.default[o],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=t.keyboardEventTarget,this.keyHandlerKeys_=null,x.default.listen(this.viewport_,D.default.WHEEL,this.handleBrowserEvent,this),x.default.listen(this.viewport_,D.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=t.controls||new r.default,this.interactions=t.interactions||new r.default,this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=t.mapRendererPlugin.create(this.viewport_,this),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new w.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},x.default.listen(this,E.default.getChangeEventType(g.default.LAYERGROUP),this.handleLayerGroupChanged_,this),x.default.listen(this,E.default.getChangeEventType(g.default.VIEW),this.handleViewChanged_,this),x.default.listen(this,E.default.getChangeEventType(g.default.SIZE),this.handleSizeChanged_,this),x.default.listen(this,E.default.getChangeEventType(g.default.TARGET),this.handleTargetChanged_,this),this.setProperties(t.values),this.controls.forEach(function(e){e.setMap(this)},this),x.default.listen(this.controls,a.default.ADD,function(e){e.element.setMap(this)},this),x.default.listen(this.controls,a.default.REMOVE,function(e){e.element.setMap(null)},this),this.interactions.forEach(function(e){e.setMap(this)},this),x.default.listen(this.interactions,a.default.ADD,function(e){e.element.setMap(this)},this),x.default.listen(this.interactions,a.default.REMOVE,function(e){e.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_,this),x.default.listen(this.overlays_,a.default.ADD,function(e){this.addOverlayInternal_(e.element)},this),x.default.listen(this.overlays_,a.default.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)},this)};t.default.inherits(ae,E.default),ae.prototype.addControl=function(e){this.getControls().push(e)},ae.prototype.addInteraction=function(e){this.getInteractions().push(e)},ae.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},ae.prototype.addOverlay=function(e){this.getOverlays().push(e)},ae.prototype.addOverlayInternal_=function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},ae.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),x.default.unlisten(this.viewport_,D.default.WHEEL,this.handleBrowserEvent,this),x.default.unlisten(this.viewport_,D.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(window.removeEventListener(D.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),E.default.prototype.disposeInternal.call(this)},ae.prototype.forEachFeatureAtPixel=function(e,t,i){if(this.frameState_){var r=this.getCoordinateFromPixel(e),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,a=void 0!==i.layerFilter?i.layerFilter:G.default.TRUE;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,n,t,null,a,null)}},ae.prototype.getFeaturesAtPixel=function(e,t){var i=null;return this.forEachFeatureAtPixel(e,function(e){i||(i=[]),i.push(e)},t),i},ae.prototype.forEachLayerAtPixel=function(e,t,i,r,n){if(this.frameState_){var a=void 0!==i?i:null,s=void 0!==r?r:G.default.TRUE,o=void 0!==n?n:null;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,t,a,s,o)}},ae.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(e),r=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:G.default.TRUE,n=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,n,r,null)},ae.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},ae.prototype.getEventPixel=function(e){var t=this.viewport_.getBoundingClientRect(),i=e.changedTouches?e.changedTouches[0]:e;return[i.clientX-t.left,i.clientY-t.top]},ae.prototype.getTarget=function(){return this.get(g.default.TARGET)},ae.prototype.getTargetElement=function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},ae.prototype.getCoordinateFromPixel=function(e){var t=this.frameState_;return t?re.default.apply(t.pixelToCoordinateTransform,e.slice()):null},ae.prototype.getControls=function(){return this.controls},ae.prototype.getOverlays=function(){return this.overlays_},ae.prototype.getOverlayById=function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},ae.prototype.getInteractions=function(){return this.interactions},ae.prototype.getLayerGroup=function(){return this.get(g.default.LAYERGROUP)},ae.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},ae.prototype.getPixelFromCoordinate=function(e){var t=this.frameState_;return t?re.default.apply(t.coordinateToPixelTransform,e.slice(0,2)):null},ae.prototype.getRenderer=function(){return this.renderer_},ae.prototype.getSize=function(){return this.get(g.default.SIZE)},ae.prototype.getView=function(){return this.get(g.default.VIEW)},ae.prototype.getViewport=function(){return this.viewport_},ae.prototype.getOverlayContainer=function(){return this.overlayContainer_},ae.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},ae.prototype.getTilePriority=function(e,t,i,r){var n=this.frameState_;if(!(n&&t in n.wantedTiles))return te.default.DROP;if(!n.wantedTiles[t][e.getKey()])return te.default.DROP;var a=i[0]-n.focus[0],s=i[1]-n.focus[1];return 65536*Math.log(r)+Math.sqrt(a*a+s*s)/r},ae.prototype.handleBrowserEvent=function(e,t){var i=t||e.type,r=new o.default(i,this,e);this.handleMapBrowserEvent(r)},ae.prototype.handleMapBrowserEvent=function(e){if(this.frameState_){this.focus_=e.coordinate,e.frameState=this.frameState_;var t,i=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(t=i.length-1;t>=0;t--){var r=i[t];if(r.getActive())if(!r.handleEvent(e))break}}},ae.prototype.handlePostRender=function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var i=16,r=i;if(e){var n=e.viewHints;n[S.default.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,r=2),n[S.default.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,r=2)}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,r))}var a,s,o=this.postRenderFunctions_;for(a=0,s=o.length;a<s;++a)o[a](this,e);o.length=0},ae.prototype.handleSizeChanged_=function(){this.render()},ae.prototype.handleTargetChanged_=function(){var e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(var t=0,i=this.keyHandlerKeys_.length;t<i;++t)x.default.unlistenByKey(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_);var r=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[x.default.listen(r,D.default.KEYDOWN,this.handleBrowserEvent,this),x.default.listen(r,D.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(D.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),V.default.removeNode(this.viewport_),void 0!==this.handleResize_&&(window.removeEventListener(D.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},ae.prototype.handleTileChange_=function(){this.render()},ae.prototype.handleViewPropertyChanged_=function(){this.render()},ae.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(x.default.unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(x.default.unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.viewport_.setAttribute("data-view",t.default.getUid(e)),this.viewPropertyListenerKey_=x.default.listen(e,A.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=x.default.listen(e,D.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},ae.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(x.default.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[x.default.listen(e,A.default.PROPERTYCHANGE,this.render,this),x.default.listen(e,D.default.CHANGE,this.render,this)]),this.render()},ae.prototype.isRendered=function(){return!!this.frameState_},ae.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},ae.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},ae.prototype.removeControl=function(e){return this.getControls().remove(e)},ae.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},ae.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},ae.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},ae.prototype.renderFrame_=function(e){var i,r,n,a=this.getSize(),s=this.getView(),o=U.default.createEmpty(),l=this.frameState_,d=null;if(void 0!==a&&$.default.hasArea(a)&&s&&s.isDef()){var h=s.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=this.getLayerGroup().getLayerStatesArray(),f={};for(i=0,r=u.length;i<r;++i)f[t.default.getUid(u[i].layer)]=u[i];var y=(n=s.getState()).center,c=n.resolution/this.pixelRatio_;y[0]=Math.round(y[0]/c)*c,y[1]=Math.round(y[1]/c)*c,d={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:o,focus:this.focus_?this.focus_:y,index:this.frameIndex_++,layerStates:f,layerStatesArray:u,logos:B.default.assign({},this.logos_),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:a,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:n,viewHints:h,wantedTiles:{}}}if(d&&(d.extent=U.default.getForViewAndSize(n.center,n.resolution,n.rotation,d.size,o)),this.frameState_=d,this.renderer_.renderFrame(d),d){if(d.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,d.postRenderFunctions),l)(!this.previousExtent_||!U.default.isEmpty(this.previousExtent_)&&!U.default.equals(d.extent,this.previousExtent_))&&(this.dispatchEvent(new p.default(v.default.MOVESTART,this,l)),this.previousExtent_=U.default.createOrUpdateEmpty(this.previousExtent_));this.previousExtent_&&!d.viewHints[S.default.ANIMATING]&&!d.viewHints[S.default.INTERACTING]&&!U.default.equals(d.extent,this.previousExtent_)&&(this.dispatchEvent(new p.default(v.default.MOVEEND,this,d)),U.default.clone(d.extent,this.previousExtent_))}this.dispatchEvent(new p.default(v.default.POSTRENDER,this,d)),setTimeout(this.handlePostRender.bind(this),0)},ae.prototype.setLayerGroup=function(e){this.set(g.default.LAYERGROUP,e)},ae.prototype.setSize=function(e){this.set(g.default.SIZE,e)},ae.prototype.setTarget=function(e){this.set(g.default.TARGET,e)},ae.prototype.setView=function(e){this.set(g.default.VIEW,e)},ae.prototype.skipFeature=function(e){var i=t.default.getUid(e).toString();this.skippedFeatureUids_[i]=!0,this.render()},ae.prototype.updateSize=function(){var e=this.getTargetElement();if(e){var t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)},ae.prototype.unskipFeature=function(e){var i=t.default.getUid(e).toString();delete this.skippedFeatureUids_[i],this.render()},ae.DEFAULT_RENDERER_TYPES=[Z.default.CANVAS,Z.default.WEBGL],ae.LOGO_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC",ae.createOptionsInternal=function(e){var i=null;void 0!==e.keyboardEventTarget&&(i="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var n={},a={};if(void 0===e.logo||"boolean"==typeof e.logo&&e.logo)a[ae.LOGO_URL]="https://openlayers.org/";else{var s=e.logo;"string"==typeof s?a[s]="":s instanceof HTMLElement?a[t.default.getUid(s).toString()]=s:s&&(P.default.assert("string"==typeof s.href,44),P.default.assert("string"==typeof s.src,45),a[s.src]=s.href)}var o,l,d=e.layers instanceof N.default?e.layers:new N.default({layers:e.layers});n[g.default.LAYERGROUP]=d,n[g.default.TARGET]=e.target,n[g.default.VIEW]=void 0!==e.view?e.view:new I.default,void 0!==e.renderer?(Array.isArray(e.renderer)?o=e.renderer:"string"==typeof e.renderer?o=[e.renderer]:P.default.assert(!1,46),o.indexOf("dom")>=0&&(o=o.concat(ae.DEFAULT_RENDERER_TYPES))):o=ae.DEFAULT_RENDERER_TYPES;var h,u,f,p=X.default.getMapRendererPlugins();e:for(var y=0,v=o.length;y<v;++y)for(var c=o[y],_=0,E=p.length;_<E;++_){var m=p[_];if(m.handles(c)){l=m;break e}}if(!l)throw new Error("Unable to create a map renderer for types: "+o.join(", "));return void 0!==e.controls&&(Array.isArray(e.controls)?h=new r.default(e.controls.slice()):(P.default.assert(e.controls instanceof r.default,47),h=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?u=new r.default(e.interactions.slice()):(P.default.assert(e.interactions instanceof r.default,48),u=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?f=new r.default(e.overlays.slice()):(P.default.assert(e.overlays instanceof r.default,49),f=e.overlays):f=new r.default,{controls:h,interactions:u,keyboardEventTarget:i,logos:a,overlays:f,mapRendererPlugin:l,values:n}},exports.default=ae;
},{"./index.js":42,"./collection.js":123,"./collectioneventtype.js":125,"./mapbrowserevent.js":126,"./mapbrowsereventhandler.js":127,"./mapbrowsereventtype.js":128,"./mapevent.js":129,"./mapeventtype.js":130,"./mapproperty.js":131,"./object.js":58,"./objecteventtype.js":132,"./tilequeue.js":133,"./view.js":32,"./viewhint.js":64,"./asserts.js":70,"./dom.js":134,"./events.js":135,"./events/event.js":152,"./events/eventtype.js":153,"./extent.js":76,"./functions.js":136,"./has.js":137,"./layer/group.js":154,"./obj.js":52,"./plugins.js":54,"./renderer/type.js":155,"./size.js":138,"./structs/priorityqueue.js":156,"./transform.js":139}],219:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=d(e),n=require("../mapeventtype.js"),r=d(n),s=require("../object.js"),i=d(s),l=require("../dom.js"),a=d(l),u=require("../events.js"),o=d(u);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e){i.default.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:t.default.nullFunction,e.target&&this.setTarget(e.target)};t.default.inherits(h,i.default),h.prototype.disposeInternal=function(){a.default.removeNode(this.element),i.default.prototype.disposeInternal.call(this)},h.prototype.getMap=function(){return this.map_},h.prototype.setMap=function(e){this.map_&&a.default.removeNode(this.element);for(var n=0,s=this.listenerKeys.length;n<s;++n)o.default.unlistenByKey(this.listenerKeys[n]);(this.listenerKeys.length=0,this.map_=e,this.map_)&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==t.default.nullFunction&&this.listenerKeys.push(o.default.listen(e,r.default.POSTRENDER,this.render,this)),e.render())},h.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},exports.default=h;
},{"../index.js":42,"../mapeventtype.js":130,"../object.js":58,"../dom.js":134,"../events.js":135}],181:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CLASS_HIDDEN:"ol-hidden",CLASS_SELECTABLE:"ol-selectable",CLASS_UNSELECTABLE:"ol-unselectable",CLASS_UNSUPPORTED:"ol-unsupported",CLASS_CONTROL:"ol-control"};e.getFontFamilies=function(){var e,t={};return function(l){if(e||(e=document.createElement("div").style),!(l in t)){e.font=l;var n=e.fontFamily;if(e.font="",!n)return null;t[l]=n.split(/,\s?/)}return t[l]}}(),exports.default=e;
},{}],183:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};exports.default=e;
},{}],191:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../events.js"),t=_(e),r=require("../events/eventtype.js"),s=_(r),a=require("../index.js"),u=_(a),n=require("../object.js"),i=_(n),o=require("../layer/base.js"),l=_(o),h=require("../layer/property.js"),p=_(h),y=require("../obj.js"),d=_(y),c=require("../render/eventtype.js"),f=_(c),g=require("../source/state.js"),S=_(g);function _(e){return e&&e.__esModule?e:{default:e}}var m=function(e){var r=d.default.assign({},e);delete r.source,l.default.call(this,r),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),t.default.listen(this,i.default.getChangeEventType(p.default.SOURCE),this.handleSourcePropertyChange_,this);var s=e.source?e.source:null;this.setSource(s)};u.default.inherits(m,l.default),m.visibleAtResolution=function(e,t){return e.visible&&t>=e.minResolution&&t<e.maxResolution},m.prototype.getLayersArray=function(e){var t=e||[];return t.push(this),t},m.prototype.getLayerStatesArray=function(e){var t=e||[];return t.push(this.getLayerState()),t},m.prototype.getSource=function(){return this.get(p.default.SOURCE)||null},m.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():S.default.UNDEFINED},m.prototype.handleSourceChange_=function(){this.changed()},m.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(t.default.unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=t.default.listen(e,s.default.CHANGE,this.handleSourceChange_,this)),this.changed()},m.prototype.setMap=function(e){this.mapPrecomposeKey_&&(t.default.unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(t.default.unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=t.default.listen(e,f.default.PRECOMPOSE,function(e){var t=this.getLayerState();t.managed=!1,t.zIndex=1/0,e.frameState.layerStatesArray.push(t),e.frameState.layerStates[u.default.getUid(this)]=t},this),this.mapRenderKey_=t.default.listen(this,s.default.CHANGE,e.render,e),this.changed())},m.prototype.setSource=function(e){this.set(p.default.SOURCE,e)},exports.default=m;
},{"../events.js":135,"../events/eventtype.js":153,"../index.js":42,"../object.js":58,"../layer/base.js":220,"../layer/property.js":228,"../obj.js":52,"../render/eventtype.js":183,"../source/state.js":194}],157:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=m(e),l=require("../array.js"),i=m(l),s=require("../control/control.js"),o=m(s),a=require("../css.js"),n=m(a),r=require("../dom.js"),d=m(r),h=require("../events.js"),p=m(h),u=require("../events/eventtype.js"),c=m(u),_=require("../layer/layer.js"),b=m(_),f=require("../obj.js"),g=m(f);function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){var t=e||{};this.ulElement_=document.createElement("UL"),this.logoLi_=document.createElement("LI"),this.ulElement_.appendChild(this.logoLi_),this.logoLi_.style.display="none",this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);var l=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",s=void 0!==t.collapseLabel?t.collapseLabel:"»";"string"==typeof s?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s):this.collapseLabel_=s;var a=void 0!==t.label?t.label:"i";"string"==typeof a?(this.label_=document.createElement("span"),this.label_.textContent=a):this.label_=a;var r=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,d=document.createElement("button");d.setAttribute("type","button"),d.title=i,d.appendChild(r),p.default.listen(d,c.default.CLICK,this.handleClick_,this);var h=l+" "+n.default.CLASS_UNSELECTABLE+" "+n.default.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),u=document.createElement("div");u.className=h,u.appendChild(this.ulElement_),u.appendChild(d);var _=t.render?t.render:v.render;o.default.call(this,{element:u,render:_,target:t.target}),this.renderedAttributions_=[],this.renderedVisible_=!0,this.logoElements_={}};t.default.inherits(v,o.default),v.prototype.getSourceAttributions_=function(e){for(var t={},l=[],i=e.layerStatesArray,s=e.viewState.resolution,o=0,a=i.length;o<a;++o){var n=i[o];if(b.default.visibleAtResolution(n,s)){var r=n.layer.getSource();if(r){var d=r.getAttributions2();if(d){var h=d(e);if(h)if(Array.isArray(h))for(var p=0,u=h.length;p<u;++p)h[p]in t||(l.push(h[p]),t[h[p]]=!0);else h in t||(l.push(h),t[h]=!0)}}}}return l},v.render=function(e){this.updateElement_(e.frameState)},v.prototype.updateElement_=function(e){if(e){var t=this.getSourceAttributions_(e);if(!i.default.equals(t,this.renderedAttributions_)){for(;this.ulElement_.lastChild!==this.logoLi_;)this.ulElement_.removeChild(this.ulElement_.lastChild);for(var l=0,s=t.length;l<s;++l){var o=document.createElement("LI");o.innerHTML=t[l],this.ulElement_.appendChild(o)}0===t.length&&this.renderedAttributions_.length>0?this.element.classList.add("ol-logo-only"):0===this.renderedAttributions_.length&&t.length>0&&this.element.classList.remove("ol-logo-only");var a=t.length>0||!g.default.isEmpty(e.logos);this.renderedVisible_!=a&&(this.element.style.display=a?"":"none",this.renderedVisible_=a),this.renderedAttributions_=t,this.insertLogos_(e)}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},v.prototype.insertLogos_=function(e){var t,l,i,s,o=e.logos,a=this.logoElements_;for(t in a)t in o||(d.default.removeNode(a[t]),delete a[t]);for(s in o){var n=o[s];n instanceof HTMLElement&&(this.logoLi_.appendChild(n),a[s]=n),s in a||((l=new Image).src=s,""===n?i=l:((i=document.createElement("a")).href=n,i.appendChild(l)),this.logoLi_.appendChild(i),a[s]=i)}this.logoLi_.style.display=g.default.isEmpty(o)?"none":""},v.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},v.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?d.default.replaceNode(this.collapseLabel_,this.label_):d.default.replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},v.prototype.getCollapsible=function(){return this.collapsible_},v.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},v.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},v.prototype.getCollapsed=function(){return this.collapsed_},exports.default=v;
},{"../index.js":42,"../array.js":68,"../control/control.js":219,"../css.js":181,"../dom.js":134,"../events.js":135,"../events/eventtype.js":153,"../layer/layer.js":191,"../obj.js":52}],158:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events.js"),e=_(t),a=require("../events/eventtype.js"),s=_(a),i=require("../index.js"),r=_(i),l=require("../control/control.js"),o=_(l),n=require("../css.js"),d=_(n),u=require("../easing.js"),h=_(u);function _(t){return t&&t.__esModule?t:{default:t}}var c=function(t){var a=t||{},i=void 0!==a.className?a.className:"ol-rotate",r=void 0!==a.label?a.label:"⇧";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var l=a.tipLabel?a.tipLabel:"Reset rotation",n=document.createElement("button");n.className=i+"-reset",n.setAttribute("type","button"),n.title=l,n.appendChild(this.label_),e.default.listen(n,s.default.CLICK,c.prototype.handleClick_,this);var u=i+" "+d.default.CLASS_UNSELECTABLE+" "+d.default.CLASS_CONTROL,h=document.createElement("div");h.className=u,h.appendChild(n);var _=a.render?a.render:c.render;this.callResetNorth_=a.resetNorth?a.resetNorth:void 0,o.default.call(this,{element:h,render:_,target:a.target}),this.duration_=void 0!==a.duration?a.duration:250,this.autoHide_=void 0===a.autoHide||a.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(d.default.CLASS_HIDDEN)};r.default.inherits(c,o.default),c.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},c.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:h.default.easeOut}):t.setRotation(0))},c.render=function(t){var e=t.frameState;if(e){var a=e.viewState.rotation;if(a!=this.rotation_){var s="rotate("+a+"rad)";if(this.autoHide_){var i=this.element.classList.contains(d.default.CLASS_HIDDEN);i||0!==a?i&&0!==a&&this.element.classList.remove(d.default.CLASS_HIDDEN):this.element.classList.add(d.default.CLASS_HIDDEN)}this.label_.style.msTransform=s,this.label_.style.webkitTransform=s,this.label_.style.transform=s}this.rotation_=a}},exports.default=c;
},{"../events.js":135,"../events/eventtype.js":153,"../index.js":42,"../control/control.js":219,"../css.js":181,"../easing.js":74}],159:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=m(e),o=require("../events.js"),a=m(o),i=require("../events/eventtype.js"),n=m(i),l=require("../control/control.js"),u=m(l),r=require("../css.js"),d=m(r),s=require("../easing.js"),c=m(s);function m(e){return e&&e.__esModule?e:{default:e}}var p=function(e){var t=e||{},o=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,l=void 0!==t.zoomInLabel?t.zoomInLabel:"+",r=void 0!==t.zoomOutLabel?t.zoomOutLabel:"−",s=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",c=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",m=document.createElement("button");m.className=o+"-in",m.setAttribute("type","button"),m.title=s,m.appendChild("string"==typeof l?document.createTextNode(l):l),a.default.listen(m,n.default.CLICK,p.prototype.handleClick_.bind(this,i));var f=document.createElement("button");f.className=o+"-out",f.setAttribute("type","button"),f.title=c,f.appendChild("string"==typeof r?document.createTextNode(r):r),a.default.listen(f,n.default.CLICK,p.prototype.handleClick_.bind(this,-i));var v=o+" "+d.default.CLASS_UNSELECTABLE+" "+d.default.CLASS_CONTROL,b=document.createElement("div");b.className=v,b.appendChild(m),b.appendChild(f),u.default.call(this,{element:b,target:t.target}),this.duration_=void 0!==t.duration?t.duration:250};t.default.inherits(p,u.default),p.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},p.prototype.zoomByDelta_=function(e){var t=this.getMap().getView();if(t){var o=t.getResolution();if(o){var a=t.constrainResolution(o,e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,duration:this.duration_,easing:c.default.easeOut})):t.setResolution(a)}}},exports.default=p;
},{"../index.js":42,"../events.js":135,"../events/eventtype.js":153,"../control/control.js":219,"../css.js":181,"../easing.js":74}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./collection.js"),e=s(t),o=require("./control/attribution.js"),r=s(o),u=require("./control/rotate.js"),i=s(u),n=require("./control/zoom.js"),a=s(n);function s(t){return t&&t.__esModule?t:{default:t}}var l={defaults:function(t){var o=t||{},u=new e.default;return(void 0===o.zoom||o.zoom)&&u.push(new a.default(o.zoomOptions)),(void 0===o.rotate||o.rotate)&&u.push(new i.default(o.rotateOptions)),(void 0===o.attribution||o.attribution)&&u.push(new r.default(o.attributionOptions)),u}};exports.default=l;
},{"./collection.js":123,"./control/attribution.js":157,"./control/rotate.js":158,"./control/zoom.js":159}],124:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0};t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;for(var n=i-3;n>0&&this.points_[n+2]>t;)n-=3;var e=this.points_[i+2]-this.points_[n+2];if(e<1e3/60)return!1;var s=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/e,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},exports.default=t;
},{}],257:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={ACTIVE:"active"};exports.default=e;
},{}],214:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=c(t),n=require("../object.js"),o=c(n),i=require("../easing.js"),a=c(i),r=require("../interaction/property.js"),s=c(r),u=require("../math.js"),l=c(u);function c(t){return t&&t.__esModule?t:{default:t}}var f=function(t){o.default.call(this),this.map_=null,this.setActive(!0),this.handleEvent=t.handleEvent};e.default.inherits(f,o.default),f.prototype.getActive=function(){return this.get(s.default.ACTIVE)},f.prototype.getMap=function(){return this.map_},f.prototype.setActive=function(t){this.set(s.default.ACTIVE,t)},f.prototype.setMap=function(t){this.map_=t},f.pan=function(t,e,n){var o=t.getCenter();if(o){var i=t.constrainCenter([o[0]+e[0],o[1]+e[1]]);n?t.animate({duration:n,easing:a.default.linear,center:i}):t.setCenter(i)}},f.rotate=function(t,e,n,o){e=t.constrainRotation(e,0),f.rotateWithoutConstraints(t,e,n,o)},f.rotateWithoutConstraints=function(t,e,n,o){if(void 0!==e){var i=t.getRotation(),r=t.getCenter();void 0!==i&&r&&o>0?t.animate({rotation:e,anchor:n,duration:o,easing:a.default.easeOut}):t.rotate(e,n)}},f.zoom=function(t,e,n,o,i){e=t.constrainResolution(e,0,i),f.zoomWithoutConstraints(t,e,n,o)},f.zoomByDelta=function(t,e,n,o){var i=t.getResolution(),a=t.constrainResolution(i,e,0);if(void 0!==a){var r=t.getResolutions();a=l.default.clamp(a,t.getMinResolution()||r[r.length-1],t.getMaxResolution()||r[0])}if(n&&void 0!==a&&a!==i){var s=t.getCenter(),u=t.calculateCenterZoom(a,n);u=t.constrainCenter(u),n=[(a*s[0]-i*u[0])/(a-i),(a*s[1]-i*u[1])/(a-i)]}f.zoomWithoutConstraints(t,a,n,o)},f.zoomWithoutConstraints=function(t,e,n,o){if(e){var i=t.getResolution(),r=t.getCenter();if(void 0!==i&&r&&e!==i&&o)t.animate({resolution:e,anchor:n,duration:o,easing:a.default.easeOut});else{if(n){var s=t.calculateCenterZoom(e,n);t.setCenter(s)}t.setResolution(e)}}},exports.default=f;
},{"../index.js":42,"../object.js":58,"../easing.js":74,"../interaction/property.js":257,"../math.js":78}],143:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=d(e),a=require("../mapbrowsereventtype.js"),i=d(a),r=require("../interaction/interaction.js"),n=d(r);function d(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t=e||{};this.delta_=t.delta?t.delta:1,n.default.call(this,{handleEvent:u.handleEvent}),this.duration_=void 0!==t.duration?t.duration:250};t.default.inherits(u,n.default),u.handleEvent=function(e){var t=!1,a=e.originalEvent;if(e.type==i.default.DBLCLICK){var r=e.map,d=e.coordinate,u=a.shiftKey?-this.delta_:this.delta_,l=r.getView();n.default.zoomByDelta(l,u,d,this.duration_),e.preventDefault(),t=!0}return!t},exports.default=u;
},{"../index.js":42,"../mapbrowsereventtype.js":128,"../interaction/interaction.js":214}],215:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../mapbrowsereventtype.js"),t=l(e),r=require("../asserts.js"),n=l(r),i=require("../functions.js"),a=l(i),u=require("../has.js"),o=l(u);function l(e){return e&&e.__esModule?e:{default:e}}var y={altKeyOnly:function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},altShiftKeysOnly:function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey}};y.always=a.default.TRUE,y.click=function(e){return e.type==t.default.CLICK},y.mouseActionButton=function(e){var t=e.originalEvent;return 0==t.button&&!(o.default.WEBKIT&&o.default.MAC&&t.ctrlKey)},y.never=a.default.FALSE,y.pointerMove=function(e){return"pointermove"==e.type},y.singleClick=function(e){return e.type==t.default.SINGLECLICK},y.doubleClick=function(e){return e.type==t.default.DBLCLICK},y.noModifierKeys=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},y.platformModifierKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&(o.default.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},y.shiftKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},y.targetNotEditable=function(e){var t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},y.mouseOnly=function(e){return n.default.assert(e.pointerEvent,56),"mouse"==e.pointerEvent.pointerType},y.primaryAction=function(e){var t=e.pointerEvent;return t.isPrimary&&0===t.button},exports.default=y;
},{"../mapbrowsereventtype.js":128,"../asserts.js":70,"../functions.js":136,"../has.js":137}],216:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=v(e),n=require("../functions.js"),a=v(n),i=require("../mapbrowsereventtype.js"),r=v(i),l=require("../mapbrowserpointerevent.js"),d=v(l),o=require("../interaction/interaction.js"),h=v(o),s=require("../obj.js"),u=v(s);function v(e){return e&&e.__esModule?e:{default:e}}var E=function(e){var t=e||{},n=t.handleEvent?t.handleEvent:E.handleEvent;h.default.call(this,{handleEvent:n}),this.handleDownEvent_=t.handleDownEvent?t.handleDownEvent:E.handleDownEvent,this.handleDragEvent_=t.handleDragEvent?t.handleDragEvent:E.handleDragEvent,this.handleMoveEvent_=t.handleMoveEvent?t.handleMoveEvent:E.handleMoveEvent,this.handleUpEvent_=t.handleUpEvent?t.handleUpEvent:E.handleUpEvent,this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]};t.default.inherits(E,h.default),E.centroid=function(e){for(var t=e.length,n=0,a=0,i=0;i<t;i++)n+=e[i].clientX,a+=e[i].clientY;return[n/t,a/t]},E.prototype.isPointerDraggingEvent_=function(e){var t=e.type;return t===r.default.POINTERDOWN||t===r.default.POINTERDRAG||t===r.default.POINTERUP},E.prototype.updateTrackedPointers_=function(e){if(this.isPointerDraggingEvent_(e)){var t=e.pointerEvent,n=t.pointerId.toString();e.type==r.default.POINTERUP?delete this.trackedPointers_[n]:e.type==r.default.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=u.default.getValues(this.trackedPointers_)}},E.handleDragEvent=t.default.nullFunction,E.handleUpEvent=a.default.FALSE,E.handleDownEvent=a.default.FALSE,E.handleMoveEvent=t.default.nullFunction,E.handleEvent=function(e){if(!(e instanceof d.default))return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==r.default.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==r.default.POINTERUP){var n=this.handleUpEvent_(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==r.default.POINTERDOWN){var a=this.handleDownEvent_(e);this.handlingDownUpSequence=a,t=this.shouldStopEvent(a)}else e.type==r.default.POINTERMOVE&&this.handleMoveEvent_(e);return!t},E.prototype.shouldStopEvent=function(e){return e},exports.default=E;
},{"../index.js":42,"../functions.js":136,"../mapbrowsereventtype.js":128,"../mapbrowserpointerevent.js":210,"../interaction/interaction.js":214,"../obj.js":52}],144:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=g(t),i=require("../viewhint.js"),n=g(i),r=require("../coordinate.js"),s=g(r),a=require("../easing.js"),o=g(a),l=require("../events/condition.js"),h=g(l),d=require("../functions.js"),u=g(d),c=require("../interaction/pointer.js"),_=g(c);function g(t){return t&&t.__esModule?t:{default:t}}var f=function(t){_.default.call(this,{handleDownEvent:f.handleDownEvent_,handleDragEvent:f.handleDragEvent_,handleUpEvent:f.handleUpEvent_});var e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=e.condition?e.condition:h.default.noModifierKeys,this.noKinetic_=!1};e.default.inherits(f,_.default),f.handleDragEvent_=function(t){var e=this.targetPointers,i=_.default.centroid(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],a=t.map.getView(),o=a.getState(),l=[n,r];s.default.scale(l,o.resolution),s.default.rotate(l,o.rotation),s.default.add(l,o.center),l=a.constrainCenter(l),a.setCenter(l)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},f.handleUpEvent_=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=i.getCenter(),l=e.getPixelFromCoordinate(a),h=e.getCoordinateFromPixel([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animate({center:i.constrainCenter(h),duration:500,easing:o.default.easeOut})}return i.setHint(n.default.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},f.handleDownEvent_=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(n.default.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},f.prototype.shouldStopEvent=u.default.FALSE,exports.default=f;
},{"../index.js":42,"../viewhint.js":64,"../coordinate.js":72,"../easing.js":74,"../events/condition.js":215,"../functions.js":136,"../interaction/pointer.js":216}],145:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=c(t),n=require("../rotationconstraint.js"),i=c(n),a=require("../viewhint.js"),o=c(a),r=require("../events/condition.js"),l=c(r),u=require("../functions.js"),d=c(u),s=require("../interaction/interaction.js"),f=c(s),v=require("../interaction/pointer.js"),h=c(v);function c(t){return t&&t.__esModule?t:{default:t}}var _=function(t){var e=t||{};h.default.call(this,{handleDownEvent:_.handleDownEvent_,handleDragEvent:_.handleDragEvent_,handleUpEvent:_.handleUpEvent_}),this.condition_=e.condition?e.condition:l.default.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==e.duration?e.duration:250};e.default.inherits(_,h.default),_.handleDragEvent_=function(t){if(l.default.mouseOnly(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==i.default.disable){var a=e.getSize(),o=t.pixel,r=Math.atan2(a[1]/2-o[1],o[0]-a[0]/2);if(void 0!==this.lastAngle_){var u=r-this.lastAngle_,d=n.getRotation();f.default.rotateWithoutConstraints(n,d-u)}this.lastAngle_=r}}},_.handleUpEvent_=function(t){if(!l.default.mouseOnly(t))return!0;var e=t.map.getView();e.setHint(o.default.INTERACTING,-1);var n=e.getRotation();return f.default.rotate(e,n,void 0,this.duration_),!1},_.handleDownEvent_=function(t){return!!l.default.mouseOnly(t)&&(!(!l.default.mouseActionButton(t)||!this.condition_(t))&&(t.map.getView().setHint(o.default.INTERACTING,1),this.lastAngle_=void 0,!0))},_.prototype.shouldStopEvent=d.default.FALSE,exports.default=_;
},{"../index.js":42,"../rotationconstraint.js":62,"../viewhint.js":64,"../events/condition.js":215,"../functions.js":136,"../interaction/interaction.js":214,"../interaction/pointer.js":216}],258:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=o(e),i=require("../disposable.js"),s=o(i),r=require("../geom/polygon.js"),n=o(r);function o(e){return e&&e.__esModule?e:{default:e}}var l=function(e){this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null};t.default.inherits(l,s.default),l.prototype.disposeInternal=function(){this.setMap(null)},l.prototype.render_=function(){var e=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(e[0],t[0])+"px",i.top=Math.min(e[1],t[1])+"px",i.width=Math.abs(t[0]-e[0])+"px",i.height=Math.abs(t[1]-e[1])+"px"},l.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left=t.top=t.width=t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},l.prototype.setPixels=function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()},l.prototype.createOrUpdateGeometry=function(){var e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new n.default([i])},l.prototype.getGeometry=function(){return this.geometry_},exports.default=l;
},{"../index.js":42,"../disposable.js":225,"../geom/polygon.js":84}],217:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events/event.js"),e=u(t),n=require("../index.js"),i=u(n),o=require("../events/condition.js"),a=u(o),s=require("../interaction/pointer.js"),d=u(s),r=require("../render/box.js"),l=u(r);function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t){d.default.call(this,{handleDownEvent:h.handleDownEvent_,handleDragEvent:h.handleDragEvent_,handleUpEvent:h.handleUpEvent_});var e=t||{};this.box_=new l.default(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,this.startPixel_=null,this.condition_=e.condition?e.condition:a.default.always,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:h.defaultBoxEndCondition};i.default.inherits(h,d.default),h.defaultBoxEndCondition=function(t,e,n){var i=n[0]-e[0],o=n[1]-e[1];return i*i+o*o>=this.minArea_},h.handleDragEvent_=function(t){a.default.mouseOnly(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new h.Event(h.EventType_.BOXDRAG,t.coordinate,t)))},h.prototype.getGeometry=function(){return this.box_.getGeometry()},h.prototype.onBoxEnd=i.default.nullFunction,h.handleUpEvent_=function(t){return!a.default.mouseOnly(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new h.Event(h.EventType_.BOXEND,t.coordinate,t))),!1)},h.handleDownEvent_=function(t){return!!a.default.mouseOnly(t)&&(!(!a.default.mouseActionButton(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new h.Event(h.EventType_.BOXSTART,t.coordinate,t)),!0))},h.EventType_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},h.Event=function(t,n,i){e.default.call(this,t),this.coordinate=n,this.mapBrowserEvent=i},i.default.inherits(h.Event,e.default),exports.default=h;
},{"../events/event.js":152,"../index.js":42,"../events/condition.js":215,"../interaction/pointer.js":216,"../render/box.js":258}],146:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=l(e),o=require("../easing.js"),i=l(o),n=require("../events/condition.js"),r=l(n),a=require("../extent.js"),u=l(a),s=require("../interaction/dragbox.js"),d=l(s);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){var t=e||{},o=t.condition?t.condition:r.default.shiftKeyOnly;this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out,d.default.call(this,{condition:o,className:t.className||"ol-dragzoom"})};t.default.inherits(c,d.default),c.prototype.onBoxEnd=function(){var e=this.getMap(),t=e.getView(),o=e.getSize(),n=this.getGeometry().getExtent();if(this.out_){var r=t.calculateExtent(o),a=u.default.createOrUpdateFromCoordinates([e.getPixelFromCoordinate(u.default.getBottomLeft(n)),e.getPixelFromCoordinate(u.default.getTopRight(n))]),s=t.getResolutionForExtent(a,o);u.default.scaleFromCenter(r,1/s),n=r}var d=t.constrainResolution(t.getResolutionForExtent(n,o)),l=u.default.getCenter(n);l=t.constrainCenter(l),t.animate({resolution:d,center:l,duration:this.duration_,easing:i.default.easeOut})},exports.default=c;
},{"../index.js":42,"../easing.js":74,"../events/condition.js":215,"../extent.js":76,"../interaction/dragbox.js":217}],218:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={LEFT:37,UP:38,RIGHT:39,DOWN:40};exports.default=e;
},{}],147:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=v(e),i=require("../coordinate.js"),n=v(i),a=require("../events/eventtype.js"),d=v(a),o=require("../events/keycode.js"),r=v(o),u=require("../events/condition.js"),l=v(u),f=require("../interaction/interaction.js"),s=v(f);function v(e){return e&&e.__esModule?e:{default:e}}var c=function(e){s.default.call(this,{handleEvent:c.handleEvent});var t=e||{};this.defaultCondition_=function(e){return l.default.noModifierKeys(e)&&l.default.targetNotEditable(e)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128};t.default.inherits(c,s.default),c.handleEvent=function(e){var t=!1;if(e.type==d.default.KEYDOWN){var i=e.originalEvent.keyCode;if(this.condition_(e)&&(i==r.default.DOWN||i==r.default.LEFT||i==r.default.RIGHT||i==r.default.UP)){var a=e.map.getView(),o=a.getResolution()*this.pixelDelta_,u=0,l=0;i==r.default.DOWN?l=-o:i==r.default.LEFT?u=-o:i==r.default.RIGHT?u=o:l=o;var f=[u,l];n.default.rotate(f,a.getRotation()),s.default.pan(a,f,this.duration_),e.preventDefault(),t=!0}}return!t},exports.default=c;
},{"../index.js":42,"../coordinate.js":72,"../events/eventtype.js":153,"../events/keycode.js":218,"../events/condition.js":215,"../interaction/interaction.js":214}],148:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=u(e),i=require("../events/eventtype.js"),a=u(i),n=require("../events/condition.js"),d=u(n),r=require("../interaction/interaction.js"),o=u(r);function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){o.default.call(this,{handleEvent:l.handleEvent});var t=e||{};this.condition_=t.condition?t.condition:d.default.targetNotEditable,this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100};t.default.inherits(l,o.default),l.handleEvent=function(e){var t=!1;if(e.type==a.default.KEYDOWN||e.type==a.default.KEYPRESS){var i=e.originalEvent.charCode;if(this.condition_(e)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=e.map,d=i=="+".charCodeAt(0)?this.delta_:-this.delta_,r=n.getView();o.default.zoomByDelta(r,d,void 0,this.duration_),e.preventDefault(),t=!0}}return!t},exports.default=l;
},{"../index.js":42,"../events/eventtype.js":153,"../events/condition.js":215,"../interaction/interaction.js":214}],149:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=m(t),i=require("../viewhint.js"),a=m(i),o=require("../easing.js"),s=m(o),n=require("../events/eventtype.js"),r=m(n),h=require("../has.js"),d=m(h),u=require("../interaction/interaction.js"),l=m(u),_=require("../math.js"),c=m(_);function m(t){return t&&t.__esModule?t:{default:t}}var f=function(t){l.default.call(this,{handleEvent:f.handleEvent});var e=t||{};this.delta_=0,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=e.constrainResolution||!1,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5};e.default.inherits(f,l.default),f.handleEvent=function(t){var e=t.type;if(e!==r.default.WHEEL&&e!==r.default.MOUSEWHEEL)return!0;t.preventDefault();var i,o=t.map,n=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==r.default.WHEEL?(i=n.deltaY,d.default.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=d.default.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==r.default.MOUSEWHEEL&&(i=-n.wheelDeltaY,d.default.SAFARI&&(i/=3)),0===i)return!1;var h=Date.now();if(void 0===this.startTime_&&(this.startTime_=h),(!this.mode_||h-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?f.Mode_.TRACKPAD:f.Mode_.WHEEL),this.mode_===f.Mode_.TRACKPAD){var u=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):u.setHint(a.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var l=u.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),_=u.getMinResolution(),c=u.getMaxResolution(),m=0;if(l<_?(l=Math.max(l,_/this.trackpadZoomBuffer_),m=1):l>c&&(l=Math.min(l,c*this.trackpadZoomBuffer_),m=-1),this.lastAnchor_){var v=u.calculateCenterZoom(l,this.lastAnchor_);u.setCenter(u.constrainCenter(v))}return u.setResolution(l),0===m&&this.constrainResolution_&&u.animate({resolution:u.constrainResolution(l,i>0?-1:1),easing:s.default.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),m>0?u.animate({resolution:_,easing:s.default.easeOut,anchor:this.lastAnchor_,duration:500}):m<0&&u.animate({resolution:c,easing:s.default.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=h,!1}this.delta_+=i;var E=Math.max(this.timeout_-(h-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),E),!1},f.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(a.default.INTERACTING,-1)},f.prototype.handleWheelZoom_=function(t){var i=t.getView();i.getAnimating()&&i.cancelAnimations();var a=e.default.MOUSEWHEELZOOM_MAXDELTA,o=c.default.clamp(this.delta_,-a,a);l.default.zoomByDelta(i,-o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},f.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},f.Mode_={TRACKPAD:"trackpad",WHEEL:"wheel"},exports.default=f;
},{"../index.js":42,"../viewhint.js":64,"../easing.js":74,"../events/eventtype.js":153,"../has.js":137,"../interaction/interaction.js":214,"../math.js":78}],150:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=_(t),i=require("../viewhint.js"),n=_(i),a=require("../functions.js"),r=_(a),o=require("../interaction/interaction.js"),s=_(o),h=require("../interaction/pointer.js"),l=_(h),d=require("../rotationconstraint.js"),u=_(d);function _(t){return t&&t.__esModule?t:{default:t}}var g=function(t){l.default.call(this,{handleDownEvent:g.handleDownEvent_,handleDragEvent:g.handleDragEvent_,handleUpEvent:g.handleUpEvent_});var e=t||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==e.threshold?e.threshold:.3,this.duration_=void 0!==e.duration?e.duration:250};e.default.inherits(g,l.default),g.handleDragEvent_=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],a=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var r=a-this.lastAngle_;this.rotationDelta_+=r,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=r}this.lastAngle_=a;var o=t.map,h=o.getView();if(h.getConstraints().rotation!==u.default.disable){var d=o.getViewport().getBoundingClientRect(),_=l.default.centroid(this.targetPointers);if(_[0]-=d.left,_[1]-=d.top,this.anchor_=o.getCoordinateFromPixel(_),this.rotating_){var g=h.getRotation();o.render(),s.default.rotateWithoutConstraints(h,g+e,this.anchor_)}}},g.handleUpEvent_=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(n.default.INTERACTING,-1),this.rotating_){var i=e.getRotation();s.default.rotate(e,i,this.anchor_,this.duration_)}return!1}return!0},g.handleDownEvent_=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(n.default.INTERACTING,1),!0}return!1},g.prototype.shouldStopEvent=r.default.FALSE,exports.default=g;
},{"../index.js":42,"../viewhint.js":64,"../functions.js":136,"../interaction/interaction.js":214,"../interaction/pointer.js":216,"../rotationconstraint.js":62}],151:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=h(t),n=require("../viewhint.js"),i=h(n),a=require("../functions.js"),o=h(a),s=require("../interaction/interaction.js"),r=h(s),l=require("../interaction/pointer.js"),u=h(l);function h(t){return t&&t.__esModule?t:{default:t}}var d=function(t){u.default.call(this,{handleDownEvent:d.handleDownEvent_,handleDragEvent:d.handleDragEvent_,handleUpEvent:d.handleUpEvent_});var e=t||{};this.constrainResolution_=e.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1};e.default.inherits(d,u.default),d.handleDragEvent_=function(t){var e=1,n=this.targetPointers[0],i=this.targetPointers[1],a=n.clientX-i.clientX,o=n.clientY-i.clientY,s=Math.sqrt(a*a+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var l=t.map,h=l.getView(),d=h.getResolution(),c=h.getMaxResolution(),_=h.getMinResolution(),v=d*e;v>c?(e=c/d,v=c):v<_&&(e=_/d,v=_),1!=e&&(this.lastScaleDelta_=e);var g=l.getViewport().getBoundingClientRect(),f=u.default.centroid(this.targetPointers);f[0]-=g.left,f[1]-=g.top,this.anchor_=l.getCoordinateFromPixel(f),l.render(),r.default.zoomWithoutConstraints(h,v,this.anchor_)},d.handleUpEvent_=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(i.default.INTERACTING,-1);var n=e.getResolution();if(this.constrainResolution_||n<e.getMinResolution()||n>e.getMaxResolution()){var a=this.lastScaleDelta_-1;r.default.zoom(e,n,this.anchor_,this.duration_,a)}return!1}return!0},d.handleDownEvent_=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(i.default.INTERACTING,1),!0}return!1},d.prototype.shouldStopEvent=o.default.FALSE,exports.default=d;
},{"../index.js":42,"../viewhint.js":64,"../functions.js":136,"../interaction/interaction.js":214,"../interaction/pointer.js":216}],50:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("./collection.js"),e=g(o),t=require("./kinetic.js"),i=g(t),r=require("./interaction/doubleclickzoom.js"),n=g(r),a=require("./interaction/dragpan.js"),u=g(a),d=require("./interaction/dragrotate.js"),s=g(d),l=require("./interaction/dragzoom.js"),c=g(l),m=require("./interaction/keyboardpan.js"),h=g(m),f=require("./interaction/keyboardzoom.js"),p=g(f),j=require("./interaction/mousewheelzoom.js"),v=g(j),w=require("./interaction/pinchrotate.js"),z=g(w),q=require("./interaction/pinchzoom.js"),D=g(q);function g(o){return o&&o.__esModule?o:{default:o}}var k={defaults:function(o){var t=o||{},r=new e.default,a=new i.default(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&r.push(new s.default),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&r.push(new n.default({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&r.push(new u.default({kinetic:a})),(void 0===t.pinchRotate||t.pinchRotate)&&r.push(new z.default),(void 0===t.pinchZoom||t.pinchZoom)&&r.push(new D.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(r.push(new h.default),r.push(new p.default({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&r.push(new v.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&r.push(new c.default({duration:t.zoomDuration})),r}};exports.default=k;
},{"./collection.js":123,"./kinetic.js":124,"./interaction/doubleclickzoom.js":143,"./interaction/dragpan.js":144,"./interaction/dragrotate.js":145,"./interaction/dragzoom.js":146,"./interaction/keyboardpan.js":147,"./interaction/keyboardzoom.js":148,"./interaction/mousewheelzoom.js":149,"./interaction/pinchrotate.js":150,"./interaction/pinchzoom.js":151}],221:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=u(t),n=require("./events/eventtarget.js"),o=u(n),i=require("./events/eventtype.js"),r=u(i);function u(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e,n,i){o.default.call(this),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state=i};e.default.inherits(s,o.default),s.prototype.changed=function(){this.dispatchEvent(r.default.CHANGE)},s.prototype.getExtent=function(){return this.extent},s.prototype.getImage=function(){},s.prototype.getPixelRatio=function(){return this.pixelRatio_},s.prototype.getResolution=function(){return this.resolution},s.prototype.getState=function(){return this.state},s.prototype.load=function(){},exports.default=s;
},{"./index.js":42,"./events/eventtarget.js":211,"./events/eventtype.js":153}],222:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={IDLE:0,LOADING:1,LOADED:2,ERROR:3};exports.default=e;
},{}],178:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=o(t),r=require("./imagebase.js"),a=o(r),i=require("./imagestate.js"),s=o(i);function o(t){return t&&t.__esModule?t:{default:t}}var u=function(t,e,r,i,o){this.loader_=void 0!==o?o:null;var u=void 0!==o?s.default.IDLE:s.default.LOADED;a.default.call(this,t,e,r,u),this.canvas_=i,this.error_=null};e.default.inherits(u,a.default),u.prototype.getError=function(){return this.error_},u.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=s.default.ERROR):this.state=s.default.LOADED,this.changed()},u.prototype.load=function(){this.state==s.default.IDLE&&(this.state=s.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},u.prototype.getImage=function(){return this.canvas_},exports.default=u;
},{"./index.js":42,"./imagebase.js":221,"./imagestate.js":222}],177:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};exports.default=e;
},{}],186:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={IMAGE:"image",VECTOR:"vector"};exports.default=e;
},{}],192:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=i(e),r=require("../events/event.js"),s=i(r);function i(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,i,u){s.default.call(this,e),this.vectorContext=t,this.frameState=r,this.context=i,this.glContext=u};t.default.inherits(u,s.default),exports.default=u;
},{"../index.js":42,"../events/event.js":152}],195:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=u(e),s=require("../asserts.js"),n=u(s),r=require("../events/eventtarget.js"),i=u(r),o=require("../events/eventtype.js"),l=u(o);function u(e){return e&&e.__esModule?e:{default:e}}var h=function(e){i.default.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null};t.default.inherits(h,i.default),h.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},h.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(l.default.CLEAR)},h.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},h.prototype.forEach=function(e,t){for(var s=this.oldest_;s;)e.call(t,s.value_,s.key_,this),s=s.newer},h.prototype.get=function(e){var t=this.entries_[e];return n.default.assert(void 0!==t,15),t===this.newest_?t.value_:(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t,t.value_)},h.prototype.remove=function(e){var t=this.entries_[e];return n.default.assert(void 0!==t,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},h.prototype.getCount=function(){return this.count_},h.prototype.getKeys=function(){var e,t=new Array(this.count_),s=0;for(e=this.newest_;e;e=e.older)t[s++]=e.key_;return t},h.prototype.getValues=function(){var e,t=new Array(this.count_),s=0;for(e=this.newest_;e;e=e.older)t[s++]=e.value_;return t},h.prototype.peekLast=function(){return this.oldest_.value_},h.prototype.peekLastKey=function(){return this.oldest_.key_},h.prototype.peekFirstKey=function(){return this.newest_.key_},h.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},h.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},h.prototype.set=function(e,t){n.default.assert(!(e in this.entries_),16);var s={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=s:this.oldest_=s,this.newest_=s,this.entries_[e]=s,++this.count_},h.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},exports.default=h;
},{"../index.js":42,"../asserts.js":70,"../events/eventtarget.js":211,"../events/eventtype.js":153}],184:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../css.js"),t=d(e),a=require("../dom.js"),r=d(a),n=require("../obj.js"),o=d(n),l=require("../structs/lrucache.js"),u=d(l),s=require("../transform.js"),i=d(s);function d(e){return e&&e.__esModule?e:{default:e}}var f={defaultFont:"10px sans-serif",defaultFillStyle:[0,0,0,1],defaultLineCap:"round",defaultLineDash:[],defaultLineDashOffset:0,defaultLineJoin:"round",defaultMiterLimit:10,defaultStrokeStyle:[0,0,0,1],defaultTextAlign:"center",defaultTextBaseline:"middle",defaultPadding:[0,0,0,0],defaultLineWidth:1};f.labelCache=new u.default,f.checkedFonts_={},f.measureContext_=null,f.textHeights_={},f.checkFont=function(){var e,a,r=60,n=f.checkedFonts_,l=f.labelCache,u="32px monospace",s="wmytzilWMYTZIL@#/&?$%10";function i(e){var t=f.getMeasureContext();t.font=u,a=t.measureText(s).width;var r=!0;"monospace"!=e&&(t.font="32px "+e+",monospace",r=t.measureText(s).width!=a);return r}function d(){var t=!0;for(var a in n)n[a]<r&&(i(a)?(n[a]=r,o.default.clear(f.textHeights_),f.measureContext_=null,l.clear()):(++n[a],t=!1));t&&(window.clearInterval(e),e=void 0)}return function(a){var o=t.default.getFontFamilies(a);if(o)for(var l=0,u=o.length;l<u;++l){var s=o[l];s in n||(n[s]=r,i(s)||(n[s]=0,void 0===e&&(e=window.setInterval(d,32))))}}}(),f.getMeasureContext=function(){var e=f.measureContext_;return e||(e=f.measureContext_=r.default.createCanvasContext2D(1,1)),e},f.measureTextHeight=function(){var e,t=f.textHeights_;return function(a){var r=t[a];return void 0==r&&(e||((e=document.createElement("span")).textContent="M",e.style.margin=e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=a,document.body.appendChild(e),r=t[a]=e.offsetHeight,document.body.removeChild(e)),r}}(),f.measureTextWidth=function(e,t){var a=f.getMeasureContext();return e!=a.font&&(a.font=e),a.measureText(t).width},f.rotateAtOffset=function(e,t,a,r){0!==t&&(e.translate(a,r),e.rotate(t),e.translate(-a,-r))},f.resetTransform_=i.default.create(),f.drawImage=function(e,t,a,r,n,o,l,u,s,i,d){var c;1!=a&&(c=e.globalAlpha,e.globalAlpha=c*a),t&&e.setTransform.apply(e,t),e.drawImage(r,n,o,l,u,s,i,l*d,u*d),c&&(e.globalAlpha=c),t&&e.setTransform.apply(e,f.resetTransform_)},exports.default=f;
},{"../css.js":181,"../dom.js":134,"../obj.js":52,"../structs/lrucache.js":195,"../transform.js":139}],259:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./asserts.js"),e=a(r),t=require("./math.js"),n=a(t);function a(r){return r&&r.__esModule?r:{default:r}}var u={HEX_COLOR_RE_:/^#(?:[0-9a-f]{3,4}){1,2}$/i,NAMED_COLOR_RE_:/^([a-z]*)$/i,asArray:function(r){return Array.isArray(r)?r:u.fromString(r)},asString:function(r){return"string"==typeof r?r:u.toString(r)},fromNamed:function(r){var e=document.createElement("div");e.style.color=r,document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}};u.fromString=function(){var r={},e=0;return function(t){var n;if(r.hasOwnProperty(t))n=r[t];else{if(e>=1024){var a,i=0;for(a in r)0==(3&i++)&&(delete r[a],--e)}n=u.fromStringInternal_(t),r[t]=n,++e}return n}}(),u.fromStringInternal_=function(r){var t,n,a,i,o,s;if(u.NAMED_COLOR_RE_.exec(r)&&(r=u.fromNamed(r)),u.HEX_COLOR_RE_.exec(r)){var l,f=r.length-1;l=f<=4?1:2;var d=4===f||8===f;t=parseInt(r.substr(1+0*l,l),16),n=parseInt(r.substr(1+1*l,l),16),a=parseInt(r.substr(1+2*l,l),16),i=d?parseInt(r.substr(1+3*l,l),16):255,1==l&&(t=(t<<4)+t,n=(n<<4)+n,a=(a<<4)+a,d&&(i=(i<<4)+i)),o=[t,n,a,i/255]}else 0==r.indexOf("rgba(")?(s=r.slice(5,-1).split(",").map(Number),o=u.normalize(s)):0==r.indexOf("rgb(")?((s=r.slice(4,-1).split(",").map(Number)).push(1),o=u.normalize(s)):e.default.assert(!1,14);return o},u.normalize=function(r,e){var t=e||[];return t[0]=n.default.clamp(r[0]+.5|0,0,255),t[1]=n.default.clamp(r[1]+.5|0,0,255),t[2]=n.default.clamp(r[2]+.5|0,0,255),t[3]=n.default.clamp(r[3],0,1),t},u.toString=function(r){var e=r[0];e!=(0|e)&&(e=e+.5|0);var t=r[1];t!=(0|t)&&(t=t+.5|0);var n=r[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+t+","+n+","+(void 0===r[3]?1:r[3])+")"},exports.default=u;
},{"./asserts.js":70,"./math.js":78}],241:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./color.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var n={asColorLike:function(e){return n.isColorLike(e)?e:r.default.asString(e)},isColorLike:function(e){return"string"==typeof e||e instanceof CanvasPattern||e instanceof CanvasGradient}};exports.default=n;
},{"./color.js":259}],233:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){};t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},exports.default=t;
},{}],204:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=v(t),i=require("../../array.js"),a=v(i),s=require("../../colorlike.js"),l=v(s),o=require("../../extent.js"),n=v(o),r=require("../../geom/geometrytype.js"),h=v(r),f=require("../../geom/simplegeometry.js"),_=v(f),g=require("../../geom/flat/transform.js"),d=v(g),S=require("../../has.js"),x=v(S),u=require("../vectorcontext.js"),m=v(u),c=require("../canvas.js"),p=v(c),y=require("../../transform.js"),k=v(y);function v(t){return t&&t.__esModule?t:{default:t}}var L=function(t,e,i,a,s){m.default.call(this),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=a,this.viewRotation_=s,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageSnapToPixel_=!1,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=k.default.create()};e.default.inherits(L,m.default),L.prototype.drawImages_=function(t,e,i,a){if(this.image_){var s=d.default.transform2D(t,e,i,2,this.transform_,this.pixelCoordinates_),l=this.context_,o=this.tmpLocalTransform_,n=l.globalAlpha;1!=this.imageOpacity_&&(l.globalAlpha=n*this.imageOpacity_);var r,h,f=this.imageRotation_;for(this.imageRotateWithView_&&(f+=this.viewRotation_),r=0,h=s.length;r<h;r+=2){var _=s[r]-this.imageAnchorX_,g=s[r+1]-this.imageAnchorY_;if(this.imageSnapToPixel_&&(_=Math.round(_),g=Math.round(g)),0!==f||1!=this.imageScale_){var S=_+this.imageAnchorX_,x=g+this.imageAnchorY_;k.default.compose(o,S,x,this.imageScale_,this.imageScale_,f,-S,-x),l.setTransform.apply(l,o)}l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,g,this.imageWidth_,this.imageHeight_)}0===f&&1==this.imageScale_||l.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(l.globalAlpha=n)}},L.prototype.drawText_=function(t,e,i,a){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var s=d.default.transform2D(t,e,i,a,this.transform_,this.pixelCoordinates_),l=this.context_,o=this.textRotation_;for(this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=a){var n=s[e]+this.textOffsetX_,r=s[e+1]+this.textOffsetY_;if(0!==o||1!=this.textScale_){var h=k.default.compose(this.tmpLocalTransform_,n,r,this.textScale_,this.textScale_,o,-n,-r);l.setTransform.apply(l,h)}this.textStrokeState_&&l.strokeText(this.text_,n,r),this.textFillState_&&l.fillText(this.text_,n,r)}0===o&&1==this.textScale_||l.setTransform(1,0,0,1,0,0)}},L.prototype.moveToLineTo_=function(t,e,i,a,s){var l=this.context_,o=d.default.transform2D(t,e,i,a,this.transform_,this.pixelCoordinates_);l.moveTo(o[0],o[1]);var n=o.length;s&&(n-=2);for(var r=2;r<n;r+=2)l.lineTo(o[r],o[r+1]);return s&&l.closePath(),i},L.prototype.drawRings_=function(t,e,i,a){var s,l;for(s=0,l=i.length;s<l;++s)e=this.moveToLineTo_(t,e,i[s],a,!0);return e},L.prototype.drawCircle=function(t){if(n.default.intersects(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=_.default.transform2D(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],a=e[3]-e[1],s=Math.sqrt(i*i+a*a),l=this.context_;l.beginPath(),l.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&l.fill(),this.strokeState_&&l.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},L.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},L.prototype.drawGeometry=function(t){switch(t.getType()){case h.default.POINT:this.drawPoint(t);break;case h.default.LINE_STRING:this.drawLineString(t);break;case h.default.POLYGON:this.drawPolygon(t);break;case h.default.MULTI_POINT:this.drawMultiPoint(t);break;case h.default.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case h.default.MULTI_POLYGON:this.drawMultiPolygon(t);break;case h.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case h.default.CIRCLE:this.drawCircle(t)}},L.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&n.default.intersects(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},L.prototype.drawGeometryCollection=function(t){var e,i,a=t.getGeometriesArray();for(e=0,i=a.length;e<i;++e)this.drawGeometry(a[e])},L.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},L.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},L.prototype.drawLineString=function(t){if(n.default.intersects(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},L.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(n.default.intersects(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i,a,s=this.context_,l=t.getFlatCoordinates(),o=0,r=t.getEnds(),h=t.getStride();for(s.beginPath(),i=0,a=r.length;i<a;++i)o=this.moveToLineTo_(l,o,r[i],h,!1);s.stroke()}if(""!==this.text_){var f=t.getFlatMidpoints();this.drawText_(f,0,f.length,2)}}},L.prototype.drawPolygon=function(t){if(n.default.intersects(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},L.prototype.drawMultiPolygon=function(t){if(n.default.intersects(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e,i,a=this.context_,s=t.getOrientedFlatCoordinates(),l=0,o=t.getEndss(),r=t.getStride();for(a.beginPath(),e=0,i=o.length;e<i;++e){var h=o[e];l=this.drawRings_(s,l,h,r)}this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}if(""!==this.text_){var f=t.getFlatInteriorPoints();this.drawText_(f,0,f.length,2)}}},L.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},L.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),x.default.CANVAS_LINE_DASH&&(a.default.equals(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,x.default.CANVAS_LINE_DASH&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},L.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:p.default.defaultTextAlign;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=a&&(i.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=a,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},L.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:l.default.asColorLike(i||p.default.defaultFillStyle)}}else this.fillState_=null;if(e){var a=e.getColor(),s=e.getLineCap(),o=e.getLineDash(),n=e.getLineDashOffset(),r=e.getLineJoin(),h=e.getWidth(),f=e.getMiterLimit();this.strokeState_={lineCap:void 0!==s?s:p.default.defaultLineCap,lineDash:o||p.default.defaultLineDash,lineDashOffset:n||p.default.defaultLineDashOffset,lineJoin:void 0!==r?r:p.default.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==h?h:p.default.defaultLineWidth),miterLimit:void 0!==f?f:p.default.defaultMiterLimit,strokeStyle:l.default.asColorLike(a||p.default.defaultStrokeStyle)}}else this.strokeState_=null},L.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),a=t.getOrigin(),s=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=s[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageSnapToPixel_=t.getSnapToPixel(),this.imageWidth_=s[0]}else this.image_=null},L.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:l.default.asColorLike(i||p.default.defaultFillStyle)}}else this.textFillState_=null;var a=t.getStroke();if(a){var s=a.getColor(),o=a.getLineCap(),n=a.getLineDash(),r=a.getLineDashOffset(),h=a.getLineJoin(),f=a.getWidth(),_=a.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:p.default.defaultLineCap,lineDash:n||p.default.defaultLineDash,lineDashOffset:r||p.default.defaultLineDashOffset,lineJoin:void 0!==h?h:p.default.defaultLineJoin,lineWidth:void 0!==f?f:p.default.defaultLineWidth,miterLimit:void 0!==_?_:p.default.defaultMiterLimit,strokeStyle:l.default.asColorLike(s||p.default.defaultStrokeStyle)}}else this.textStrokeState_=null;var g=t.getFont(),d=t.getOffsetX(),S=t.getOffsetY(),x=t.getRotateWithView(),u=t.getRotation(),m=t.getScale(),c=t.getText(),y=t.getTextAlign(),k=t.getTextBaseline();this.textState_={font:void 0!==g?g:p.default.defaultFont,textAlign:void 0!==y?y:p.default.defaultTextAlign,textBaseline:void 0!==k?k:p.default.defaultTextBaseline},this.text_=void 0!==c?c:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==S?this.pixelRatio_*S:0,this.textRotateWithView_=void 0!==x&&x,this.textRotation_=void 0!==u?u:0,this.textScale_=this.pixelRatio_*(void 0!==m?m:1)}else this.text_=""},exports.default=L;
},{"../../index.js":42,"../../array.js":68,"../../colorlike.js":241,"../../extent.js":76,"../../geom/geometrytype.js":82,"../../geom/simplegeometry.js":86,"../../geom/flat/transform.js":175,"../../has.js":137,"../vectorcontext.js":233,"../canvas.js":184,"../../transform.js":139}],227:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=E(e),r=require("../imagestate.js"),i=E(r),o=require("../observable.js"),a=E(o),n=require("../tilestate.js"),u=E(n),s=require("../asserts.js"),d=E(s),l=require("../events.js"),f=E(l),g=require("../events/eventtype.js"),p=E(g),c=require("../functions.js"),y=E(c),h=require("../source/state.js"),v=E(h);function E(e){return e&&e.__esModule?e:{default:e}}var S=function(e){a.default.call(this),this.layer_=e};t.default.inherits(S,a.default),S.prototype.forEachFeatureAtCoordinate=t.default.nullFunction,S.prototype.hasFeatureAtCoordinate=y.default.FALSE,S.prototype.createLoadedTileFinder=function(e,t,r){return function(i,o){return e.forEachLoadedTile(t,i,o,function(e){r[i]||(r[i]={}),r[i][e.tileCoord.toString()]=e})}},S.prototype.getLayer=function(){return this.layer_},S.prototype.handleImageChange_=function(e){e.target.getState()===i.default.LOADED&&this.renderIfReadyAndVisible()},S.prototype.loadImage=function(e){var t=e.getState();return t!=i.default.LOADED&&t!=i.default.ERROR&&f.default.listen(e,p.default.CHANGE,this.handleImageChange_,this),t==i.default.IDLE&&(e.load(),t=e.getState()),t==i.default.LOADED},S.prototype.renderIfReadyAndVisible=function(){var e=this.getLayer();e.getVisible()&&e.getSourceState()==v.default.READY&&this.changed()},S.prototype.scheduleExpireCache=function(e,r){if(r.canExpireCache()){var i=function(e,r,i){var o=t.default.getUid(e).toString();o in i.usedTiles&&e.expireCache(i.viewState.projection,i.usedTiles[o])}.bind(null,r);e.postRenderFunctions.push(i)}},S.prototype.updateLogos=function(e,t){var r=t.getLogo();void 0!==r&&("string"==typeof r?e.logos[r]="":r&&(d.default.assert("string"==typeof r.href,44),d.default.assert("string"==typeof r.src,45),e.logos[r.src]=r.href))},S.prototype.updateUsedTiles=function(e,r,i,o){var a=t.default.getUid(r).toString(),n=i.toString();a in e?n in e[a]?e[a][n].extend(o):e[a][n]=o:(e[a]={},e[a][n]=o)},S.prototype.manageTilePyramid=function(e,r,i,o,a,n,s,d,l,f){var g=t.default.getUid(r).toString();g in e.wantedTiles||(e.wantedTiles[g]={});var p,c,y,h,v,E,S=e.wantedTiles[g],T=e.tileQueue;for(E=i.getMinZoom();E<=s;++E)for(c=i.getTileRangeForExtentAndZ(n,E,c),y=i.getResolution(E),h=c.minX;h<=c.maxX;++h)for(v=c.minY;v<=c.maxY;++v)s-E<=d?((p=r.getTile(E,h,v,o,a)).getState()==u.default.IDLE&&(S[p.getKey()]=!0,T.isKeyQueued(p.getKey())||T.enqueue([p,g,i.getTileCoordCenter(p.tileCoord),y])),void 0!==l&&l.call(f,p)):r.useTile(E,h,v,a)},exports.default=S;
},{"../index.js":42,"../imagestate.js":222,"../observable.js":140,"../tilestate.js":179,"../asserts.js":70,"../events.js":135,"../events/eventtype.js":153,"../functions.js":136,"../source/state.js":194}],199:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=T(e),o=require("../../extent.js"),r=T(o),a=require("../../functions.js"),i=T(a),n=require("../../render/event.js"),s=T(n),f=require("../../render/eventtype.js"),u=T(f),l=require("../../render/canvas.js"),p=T(l),d=require("../../render/canvas/immediate.js"),c=T(d),v=require("../layer.js"),h=T(v),m=require("../../transform.js"),y=T(m);function T(e){return e&&e.__esModule?e:{default:e}}var x=function(e){h.default.call(this,e),this.renderedResolution,this.transform_=y.default.create()};t.default.inherits(x,h.default),x.prototype.clip=function(e,t,o){var a=t.pixelRatio,i=t.size[0]*a,n=t.size[1]*a,s=t.viewState.rotation,f=r.default.getTopLeft(o),u=r.default.getTopRight(o),l=r.default.getBottomRight(o),d=r.default.getBottomLeft(o);y.default.apply(t.coordinateToPixelTransform,f),y.default.apply(t.coordinateToPixelTransform,u),y.default.apply(t.coordinateToPixelTransform,l),y.default.apply(t.coordinateToPixelTransform,d),e.save(),p.default.rotateAtOffset(e,-s,i/2,n/2),e.beginPath(),e.moveTo(f[0]*a,f[1]*a),e.lineTo(u[0]*a,u[1]*a),e.lineTo(l[0]*a,l[1]*a),e.lineTo(d[0]*a,d[1]*a),e.clip(),p.default.rotateAtOffset(e,s,i/2,n/2)},x.prototype.dispatchComposeEvent_=function(e,t,o,r){var a=this.getLayer();if(a.hasListener(e)){var i=o.size[0]*o.pixelRatio,n=o.size[1]*o.pixelRatio,f=o.viewState.rotation;p.default.rotateAtOffset(t,-f,i/2,n/2);var u=void 0!==r?r:this.getTransform(o,0),l=new c.default(t,o.pixelRatio,o.extent,u,o.viewState.rotation),d=new s.default(e,l,o,t,null);a.dispatchEvent(d),p.default.rotateAtOffset(t,f,i/2,n/2)}},x.prototype.forEachLayerAtCoordinate=function(e,t,o,r){return this.forEachFeatureAtCoordinate(e,t,0,i.default.TRUE,this)?o.call(r,this.getLayer(),null):void 0},x.prototype.postCompose=function(e,t,o,r){this.dispatchComposeEvent_(u.default.POSTCOMPOSE,e,t,r)},x.prototype.preCompose=function(e,t,o){this.dispatchComposeEvent_(u.default.PRECOMPOSE,e,t,o)},x.prototype.dispatchRenderEvent=function(e,t,o){this.dispatchComposeEvent_(u.default.RENDER,e,t,o)},x.prototype.getTransform=function(e,t){var o=e.viewState,r=e.pixelRatio,a=r*e.size[0]/2,i=r*e.size[1]/2,n=r/o.resolution,s=-n,f=-o.rotation,u=-o.center[0]+t,l=-o.center[1];return y.default.compose(this.transform_,a,i,n,s,f,u,l)},x.prototype.composeFrame=function(e,t,o){},x.prototype.prepareFrame=function(e,t){},exports.default=x;
},{"../../index.js":42,"../../extent.js":76,"../../functions.js":136,"../../render/event.js":192,"../../render/eventtype.js":183,"../../render/canvas.js":184,"../../render/canvas/immediate.js":204,"../layer.js":227,"../../transform.js":139}],200:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=c(t),a=require("../../coordinate.js"),r=c(a),o=require("../../dom.js"),i=c(o),n=require("../../extent.js"),s=c(n),u=require("../canvas/layer.js"),l=c(u),h=require("../../transform.js"),d=c(h);function c(t){return t&&t.__esModule?t:{default:t}}var f=function(t){l.default.call(this,t),this.coordinateToCanvasPixelTransform=d.default.create(),this.hitCanvasContext_=null};e.default.inherits(f,l.default),f.prototype.composeFrame=function(t,e,a){this.preCompose(a,t);var r=this.getImage();if(r){var o=e.extent,i=void 0!==o&&!s.default.containsExtent(o,t.extent)&&s.default.intersects(o,t.extent);i&&this.clip(a,t,o);var n=this.getImageTransform(),u=a.globalAlpha;a.globalAlpha=e.opacity;var l=n[4],h=n[5],d=r.width*n[0],c=r.height*n[3];a.drawImage(r,0,0,+r.width,+r.height,Math.round(l),Math.round(h),Math.round(d),Math.round(c)),a.globalAlpha=u,i&&a.restore()}this.postCompose(a,t,e)},f.prototype.getImage=function(){},f.prototype.getImageTransform=function(){},f.prototype.forEachFeatureAtCoordinate=function(t,e,a,r,o){var i=this.getLayer(),n=i.getSource(),s=e.viewState.resolution,u=e.viewState.rotation,l=e.skippedFeatureUids;return n.forEachFeatureAtCoordinate(t,s,u,a,l,function(t){return r.call(o,t,i)})},f.prototype.forEachLayerAtCoordinate=function(t,a,o,n){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==e.default.nullFunction)return l.default.prototype.forEachLayerAtCoordinate.apply(this,arguments);var s=d.default.apply(this.coordinateToCanvasPixelTransform,t.slice());r.default.scale(s,a.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=i.default.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),s[0],s[1],1,1,0,0,1,1);var u=this.hitCanvasContext_.getImageData(0,0,1,1).data;return u[3]>0?o.call(n,this.getLayer(),u):void 0}},exports.default=f;
},{"../../index.js":42,"../../coordinate.js":72,"../../dom.js":134,"../../extent.js":76,"../canvas/layer.js":199,"../../transform.js":139}],102:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=A(e),r=require("../../imagecanvas.js"),a=A(r),i=require("../../layertype.js"),s=A(i),n=require("../../viewhint.js"),o=A(n),u=require("../../array.js"),d=A(u),l=require("../../extent.js"),f=A(l),c=require("../../layer/vectorrendertype.js"),g=A(c),p=require("../../obj.js"),h=A(p),m=require("../../plugins.js"),v=A(m),_=require("../type.js"),y=A(_),R=require("../canvas/intermediatecanvas.js"),j=A(R),T=require("../../transform.js"),E=A(T);function A(e){return e&&e.__esModule?e:{default:e}}var q=function(e){j.default.call(this,e),this.image_=null,this.imageTransform_=E.default.create(),this.skippedFeatures_=[],this.vectorRenderer_=null};t.default.inherits(q,j.default),q.handles=function(e,t){return e===y.default.CANVAS&&(t.getType()===s.default.IMAGE||t.getType()===s.default.VECTOR&&t.getRenderMode()===g.default.IMAGE)},q.create=function(e,t){var r=new q(t);if(t.getType()===s.default.VECTOR)for(var a=v.default.getLayerRendererPlugins(),i=0,n=a.length;i<n;++i){var o=a[i];o!==q&&o.handles(y.default.CANVAS,t)&&r.setVectorRenderer(o.create(e,t))}return r},q.prototype.getImage=function(){return this.image_?this.image_.getImage():null},q.prototype.getImageTransform=function(){return this.imageTransform_},q.prototype.prepareFrame=function(e,r){var i,s=e.pixelRatio,n=e.size,u=e.viewState,l=u.center,c=u.resolution,g=this.getLayer().getSource(),p=e.viewHints,m=e.extent;if(void 0!==r.extent&&(m=f.default.getIntersection(m,r.extent)),!p[o.default.ANIMATING]&&!p[o.default.INTERACTING]&&!f.default.isEmpty(m)){var v=u.projection;if(!t.default.ENABLE_RASTER_REPROJECTION){var _=g.getProjection();_&&(v=_)}var y=this.vectorRenderer_;if(y){var R=y.context,j=h.default.assign({},e,{size:[f.default.getWidth(m)/c,f.default.getHeight(m)/c],viewState:h.default.assign({},e.viewState,{rotation:0})}),T=Object.keys(j.skippedFeatureUids).sort();!y.prepareFrame(j,r)||!y.replayGroupChanged&&d.default.equals(T,this.skippedFeatures_)||(R.canvas.width=j.size[0]*s,R.canvas.height=j.size[1]*s,y.composeFrame(j,r,R),this.image_=new a.default(m,c,s,R.canvas),this.skippedFeatures_=T)}else{if(i=g.getImage(m,c,s,v))this.loadImage(i)&&(this.image_=i)}}if(this.image_){var A=(i=this.image_).getExtent(),q=i.getResolution(),I=i.getPixelRatio(),x=s*q/(c*I),C=E.default.compose(this.imageTransform_,s*n[0]/2,s*n[1]/2,x,x,0,I*(A[0]-l[0])/q,I*(l[1]-A[3])/q);E.default.compose(this.coordinateToCanvasPixelTransform,s*n[0]/2-C[4],s*n[1]/2-C[5],s/c,-s/c,0,-l[0],-l[1]),this.updateLogos(e,g),this.renderedResolution=q*s/I}return!!this.image_},q.prototype.forEachFeatureAtCoordinate=function(e,t,r,a,i){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,a,i):j.default.prototype.forEachFeatureAtCoordinate.call(this,e,t,r,a,i)},q.prototype.setVectorRenderer=function(e){this.vectorRenderer_=e},exports.default=q;
},{"../../index.js":42,"../../imagecanvas.js":178,"../../layertype.js":177,"../../viewhint.js":64,"../../array.js":68,"../../extent.js":76,"../../layer/vectorrendertype.js":186,"../../obj.js":52,"../../plugins.js":54,"../type.js":155,"../canvas/intermediatecanvas.js":200,"../../transform.js":139}],256:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../color.js"),t=i(e);function i(e){return e&&e.__esModule?e:{default:e}}var c=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};c.getKey=function(e,i,c){return i+":"+e+":"+(c?t.default.asString(c):"null")},c.prototype.clear=function(){this.cache_={},this.cacheSize_=0},c.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var e,t,i=0;for(e in this.cache_)t=this.cache_[e],0!=(3&i++)||t.hasListener()||(delete this.cache_[e],--this.cacheSize_)}},c.prototype.get=function(e,t,i){var h=c.getKey(e,t,i);return h in this.cache_?this.cache_[h]:null},c.prototype.set=function(e,t,i,h){var a=c.getKey(e,t,i);this.cache_[a]=h,++this.cacheSize_},c.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},exports.default=c;
},{"../color.js":259}],226:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./style/iconimagecache.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var a={};a.iconImageCache=new t.default,exports.default=a;
},{"./style/iconimagecache.js":256}],193:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),r=L(e),t=require("../disposable.js"),n=L(t),a=require("../events.js"),i=L(a),o=require("../events/eventtype.js"),s=L(o),u=require("../extent.js"),d=L(u),l=require("../functions.js"),y=L(l),f=require("../layer/layer.js"),p=L(f),c=require("../plugins.js"),h=L(c),v=require("../style.js"),R=L(v),_=require("../transform.js"),g=L(_);function L(e){return e&&e.__esModule?e:{default:e}}var m=function(e,r){n.default.call(this),this.map_=r,this.layerRenderers_={},this.layerRendererListeners_={}};r.default.inherits(m,n.default),m.prototype.calculateMatrices2D=function(e){var r=e.viewState,t=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;g.default.compose(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),g.default.invert(g.default.setFromArray(n,t))},m.prototype.removeLayerRenderers=function(){for(var e in this.layerRenderers_)this.removeLayerRendererByKey_(e).dispose()},m.expireIconCache_=function(e,r){R.default.iconImageCache.expire()},m.prototype.forEachFeatureAtCoordinate=function(e,t,n,a,i,o,s){var u,l=t.viewState,y=l.resolution;function f(e,n){var o=r.default.getUid(e).toString(),s=t.layerStates[r.default.getUid(n)].managed;if(!(o in t.skippedFeatureUids)||s)return a.call(i,e,s?n:null)}var c=l.projection,h=e;if(c.canWrapX()){var v=c.getExtent(),R=d.default.getWidth(v),_=e[0];if(_<v[0]||_>v[2])h=[_+R*Math.ceil((v[0]-_)/R),e[1]]}var g,L=t.layerStatesArray;for(g=L.length-1;g>=0;--g){var m=L[g],x=m.layer;if(p.default.visibleAtResolution(m,y)&&o.call(s,x)){var j=this.getLayerRenderer(x);if(x.getSource()&&(u=j.forEachFeatureAtCoordinate(x.getSource().getWrapX()?h:e,t,n,f,i)),u)return u}}},m.prototype.forEachLayerAtPixel=function(e,r,t,n,a,i){},m.prototype.hasFeatureAtCoordinate=function(e,r,t,n,a){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,y.default.TRUE,this,n,a)},m.prototype.getLayerRenderer=function(e){var t=r.default.getUid(e).toString();if(t in this.layerRenderers_)return this.layerRenderers_[t];for(var n,a=h.default.getLayerRendererPlugins(),o=this.getType(),u=0,d=a.length;u<d;++u){var l=a[u];if(l.handles(o,e)){n=l.create(this,e);break}}if(!n)throw new Error("Unable to create renderer for layer: "+e.getType());return this.layerRenderers_[t]=n,this.layerRendererListeners_[t]=i.default.listen(n,s.default.CHANGE,this.handleLayerRendererChange_,this),n},m.prototype.getLayerRendererByKey=function(e){return this.layerRenderers_[e]},m.prototype.getLayerRenderers=function(){return this.layerRenderers_},m.prototype.getMap=function(){return this.map_},m.prototype.getType=function(){},m.prototype.handleLayerRendererChange_=function(){this.map_.render()},m.prototype.removeLayerRendererByKey_=function(e){var r=this.layerRenderers_[e];return delete this.layerRenderers_[e],i.default.unlistenByKey(this.layerRendererListeners_[e]),delete this.layerRendererListeners_[e],r},m.prototype.renderFrame=r.default.nullFunction,m.prototype.removeUnusedLayerRenderers_=function(e,r){var t;for(t in this.layerRenderers_)r&&t in r.layerStates||this.removeLayerRendererByKey_(t).dispose()},m.prototype.scheduleExpireIconCache=function(e){e.postRenderFunctions.push(m.expireIconCache_)},m.prototype.scheduleRemoveUnusedLayerRenderers=function(e){var r;for(r in this.layerRenderers_)if(!(r in e.layerStates))return void e.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},m.sortByZIndex=function(e,r){return e.zIndex-r.zIndex},exports.default=m;
},{"../index.js":42,"../disposable.js":225,"../events.js":135,"../events/eventtype.js":153,"../extent.js":76,"../functions.js":136,"../layer/layer.js":191,"../plugins.js":54,"../style.js":226,"../transform.js":139}],104:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../transform.js"),t=g(e),r=require("../../index.js"),a=g(r),s=require("../../array.js"),i=g(s),n=require("../../css.js"),o=g(n),l=require("../../dom.js"),u=g(l),d=require("../../layer/layer.js"),h=g(d),c=require("../../render/event.js"),f=g(c),v=require("../../render/eventtype.js"),p=g(v),y=require("../../render/canvas.js"),_=g(y),m=require("../../render/canvas/immediate.js"),S=g(m),x=require("../map.js"),j=g(x),A=require("../type.js"),C=g(A),E=require("../../source/state.js"),q=g(E);function g(e){return e&&e.__esModule?e:{default:e}}var w=function(e,r){j.default.call(this,e,r),this.context_=u.default.createCanvasContext2D(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=o.default.CLASS_UNSELECTABLE,e.insertBefore(this.canvas_,e.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=t.default.create()};a.default.inherits(w,j.default),w.handles=function(e){return e===C.default.CANVAS},w.create=function(e,t){return new w(e,t)},w.prototype.dispatchComposeEvent_=function(e,t){var r=this.getMap(),a=this.context_;if(r.hasListener(e)){var s=t.extent,i=t.pixelRatio,n=t.viewState.rotation,o=this.getTransform(t),l=new S.default(a,i,s,o,n),u=new f.default(e,l,t,a,null);r.dispatchEvent(u)}},w.prototype.getTransform=function(e){var r=e.viewState,a=this.canvas_.width/2,s=this.canvas_.height/2,i=e.pixelRatio/r.resolution,n=-i,o=-r.rotation,l=-r.center[0],u=-r.center[1];return t.default.compose(this.transform_,a,s,i,n,o,l,u)},w.prototype.getType=function(){return C.default.CANVAS},w.prototype.renderFrame=function(e){if(e){var t=this.context_,r=e.pixelRatio,a=Math.round(e.size[0]*r),s=Math.round(e.size[1]*r);this.canvas_.width!=a||this.canvas_.height!=s?(this.canvas_.width=a,this.canvas_.height=s):t.clearRect(0,0,a,s);var n=e.viewState.rotation;this.calculateMatrices2D(e),this.dispatchComposeEvent_(p.default.PRECOMPOSE,e);var o=e.layerStatesArray;i.default.stableSort(o,j.default.sortByZIndex),n&&(t.save(),_.default.rotateAtOffset(t,n,a/2,s/2));var l,u,d,c,f,v=e.viewState.resolution;for(l=0,u=o.length;l<u;++l)d=(f=o[l]).layer,c=this.getLayerRenderer(d),h.default.visibleAtResolution(f,v)&&f.sourceState==q.default.READY&&c.prepareFrame(e,f)&&c.composeFrame(e,f,t);n&&t.restore(),this.dispatchComposeEvent_(p.default.POSTCOMPOSE,e),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},w.prototype.forEachLayerAtPixel=function(e,r,a,s,i,n){var o,l,u=r.viewState.resolution,d=r.layerStatesArray,c=d.length,f=t.default.apply(r.pixelToCoordinateTransform,e.slice());for(l=c-1;l>=0;--l){var v=d[l],p=v.layer;if(h.default.visibleAtResolution(v,u)&&i.call(n,p))if(o=this.getLayerRenderer(p).forEachLayerAtCoordinate(f,r,a,s))return o}},exports.default=w;
},{"../../transform.js":139,"../../index.js":42,"../../array.js":68,"../../css.js":181,"../../dom.js":134,"../../layer/layer.js":191,"../../render/event.js":192,"../../render/eventtype.js":183,"../../render/canvas.js":184,"../../render/canvas/immediate.js":204,"../map.js":193,"../type.js":155,"../../source/state.js":194}],182:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m};t.createOrUpdate=function(i,n,m,e,s){return void 0!==s?(s.minX=i,s.maxX=n,s.minY=m,s.maxY=e,s):new t(i,n,m,e)},t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},exports.default=t;
},{}],106:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=R(e),i=require("../../layertype.js"),r=R(i),n=require("../../tilerange.js"),a=R(n),s=require("../../tilestate.js"),o=R(s),l=require("../../viewhint.js"),d=R(l),h=require("../../dom.js"),u=R(h),g=require("../../extent.js"),f=R(g),c=require("../type.js"),T=R(c),m=require("../canvas/intermediatecanvas.js"),p=R(m),x=require("../../transform.js"),v=R(x);function R(e){return e&&e.__esModule?e:{default:e}}var E=function(e){p.default.call(this,e),this.context=null===this.context?null:u.default.createCanvasContext2D(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.tmpExtent=f.default.createEmpty(),this.tmpTileRange_=new a.default(0,0,0,0),this.imageTransform_=v.default.create(),this.zDirection=0};t.default.inherits(E,p.default),E.handles=function(e,t){return e===T.default.CANVAS&&t.getType()===r.default.TILE},E.create=function(e,t){return new E(t)},E.prototype.isDrawableTile_=function(e){var t=e.getState(),i=this.getLayer().getUseInterimTilesOnError();return t==o.default.LOADED||t==o.default.EMPTY||t==o.default.ERROR&&!i},E.prototype.prepareFrame=function(e,i){var r=e.pixelRatio,n=e.size,a=e.viewState,s=a.projection,l=a.resolution,h=a.center,u=this.getLayer(),g=u.getSource(),c=g.getRevision(),T=g.getTileGridForProjection(s),m=T.getZForResolution(l,this.zDirection),p=T.getResolution(m),x=Math.round(l/p)||1,R=e.extent;if(void 0!==i.extent&&(R=f.default.getIntersection(R,i.extent)),f.default.isEmpty(R))return!1;var E=T.getTileRangeForExtentAndZ(R,m),_=T.getTileRangeExtent(m,E),y=g.getTilePixelRatio(r),w={};w[m]={};var j,I,C,A=this.createLoadedTileFinder(g,s,w),D=this.tmpExtent,q=this.tmpTileRange_,S=!1;for(I=E.minX;I<=E.maxX;++I)for(C=E.minY;C<=E.maxY;++C){if((j=g.getTile(m,I,C,r,s)).getState()==o.default.ERROR&&(u.getUseInterimTilesOnError()?u.getPreload()>0&&(S=!0):j.setState(o.default.LOADED)),this.isDrawableTile_(j)||(j=j.getInterimTile()),this.isDrawableTile_(j)){var L=t.default.getUid(this);if(j.getState()==o.default.LOADED){w[m][j.tileCoord.toString()]=j;var O=j.inTransition(L);S||!O&&-1!==this.renderedTiles.indexOf(j)||(S=!0)}if(1===j.getAlpha(L,e.time))continue}var P=T.getTileCoordChildTileRange(j.tileCoord,q,D),b=!1;P&&(b=A(m+1,P)),b||T.forEachTileCoordParentTileRange(j.tileCoord,A,null,q,D)}var M=p*r/y*x,N=e.viewHints,z=N[d.default.ANIMATING]||N[d.default.INTERACTING];if(!(this.renderedResolution&&Date.now()-e.time>16&&z)&&(S||!this.renderedExtent_||!f.default.containsExtent(this.renderedExtent_,R)||this.renderedRevision!=c||x!=this.oversampling_||!z&&M!=this.renderedResolution)){var F=this.context;if(F){var U=g.getTilePixelSize(m,r,s),G=Math.round(E.getWidth()*U[0]/x),Y=Math.round(E.getHeight()*U[1]/x),H=F.canvas;H.width!=G||H.height!=Y?(this.oversampling_=x,H.width=G,H.height=Y):(this.renderedExtent_&&!f.default.equals(_,this.renderedExtent_)&&F.clearRect(0,0,G,Y),x=this.oversampling_)}this.renderedTiles.length=0;var X,Z,k,V,W,B,J,K,Q,$,ee=Object.keys(w).map(Number);for(ee.sort(function(e,t){return e===m?1:t===m?-1:e>t?1:e<t?-1:0}),V=0,W=ee.length;V<W;++V)for(var te in k=ee[V],Z=g.getTilePixelSize(k,r,s),X=T.getResolution(k)/p,J=y*g.getGutter(s),K=w[k])j=K[te],I=((B=T.getTileCoordExtent(j.getTileCoord(),D))[0]-_[0])/p*y/x,C=(_[3]-B[3])/p*y/x,Q=Z[0]*X/x,$=Z[1]*X/x,this.drawTileImage(j,e,i,I,C,Q,$,J,m===k),this.renderedTiles.push(j);this.renderedRevision=c,this.renderedResolution=p*r/y*x,this.renderedExtent_=_}var ie=this.renderedResolution/l,re=v.default.compose(this.imageTransform_,r*n[0]/2,r*n[1]/2,ie,ie,0,(this.renderedExtent_[0]-h[0])/this.renderedResolution*r,(h[1]-this.renderedExtent_[3])/this.renderedResolution*r);return v.default.compose(this.coordinateToCanvasPixelTransform,r*n[0]/2-re[4],r*n[1]/2-re[5],r/l,-r/l,0,-h[0],-h[1]),this.updateUsedTiles(e.usedTiles,g,m,E),this.manageTilePyramid(e,g,T,r,s,R,m,u.getPreload()),this.scheduleExpireCache(e,g),this.updateLogos(e,g),this.renderedTiles.length>0},E.prototype.drawTileImage=function(e,i,r,n,a,s,o,l,d){var h=e.getImage(this.getLayer());if(h){var u=t.default.getUid(this),g=d?e.getAlpha(u,i.time):1;1!==g||this.getLayer().getSource().getOpaque(i.viewState.projection)||this.context.clearRect(n,a,s,o);var f=g!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=g),this.context.drawImage(h,l,l,h.width-2*l,h.height-2*l,n,a,s,o),f&&this.context.restore(),1!==g?i.animate=!0:d&&e.endTransition(u)}},E.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},E.prototype.getLayer,E.prototype.getImageTransform=function(){return this.imageTransform_},exports.default=E;
},{"../../index.js":42,"../../layertype.js":177,"../../tilerange.js":182,"../../tilestate.js":179,"../../viewhint.js":64,"../../dom.js":134,"../../extent.js":76,"../type.js":155,"../canvas/intermediatecanvas.js":200,"../../transform.js":139}],234:[function(require,module,exports) {
"use strict";function t(t,r,f,n,e){o(t,r,f||0,n||t.length-1,e||a)}function o(t,a,f,n,e){for(;n>f;){if(n-f>600){var u=n-f+1,h=a-f+1,i=Math.log(u),l=.5*Math.exp(2*i/3),M=.5*Math.sqrt(i*l*(u-l)/u)*(h-u/2<0?-1:1);o(t,a,Math.max(f,Math.floor(a-h*l/u+M)),Math.min(n,Math.floor(a+(u-h)*l/u+M)),e)}var c=t[a],s=f,m=n;for(r(t,f,a),e(t[n],c)>0&&r(t,f,n);s<m;){for(r(t,s,m),s++,m--;e(t[s],c)<0;)s++;for(;e(t[m],c)>0;)m--}0===e(t[f],c)?r(t,f,m):r(t,++m,n),m<=a&&(f=m+1),a<=m&&(n=m-1)}}function r(t,o,r){var a=t[o];t[o]=t[r],t[r]=a}function a(t,o){return t<o?-1:t>o?1:0}module.exports=t,module.exports.default=t;
},{}],209:[function(require,module,exports) {
"use strict";module.exports=i;var t=require("quickselect");function i(t,n){if(!(this instanceof i))return new i(t,n);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&this._initFormat(n),this.clear()}function n(t,i,n){if(!n)return i.indexOf(t);for(var h=0;h<i.length;h++)if(n(t,i[h]))return h;return-1}function h(t,i){a(t,0,t.children.length,i,t)}function a(t,i,n,h,a){a||(a=x(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var e,o=i;o<n;o++)e=t.children[o],r(a,t.leaf?h(e):e);return a}function r(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function e(t,i){return t.minX-i.minX}function o(t,i){return t.minY-i.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function m(t,i){var n=Math.max(t.minX,i.minX),h=Math.max(t.minY,i.minY),a=Math.min(t.maxX,i.maxX),r=Math.min(t.maxY,i.maxY);return Math.max(0,a-n)*Math.max(0,r-h)}function u(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function f(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function x(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,h,a,r){for(var e,o=[n,h];o.length;)(h=o.pop())-(n=o.pop())<=a||(e=n+Math.ceil((h-n)/a/2)*a,t(i,e,n,h,r),o.push(n,e,e,h))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],h=this.toBBox;if(!f(t,i))return n;for(var a,r,e,o,s=[];i;){for(a=0,r=i.children.length;a<r;a++)e=i.children[a],f(t,o=i.leaf?h(e):e)&&(i.leaf?n.push(e):u(t,o)?this._all(e,n):s.push(e));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!f(t,i))return!1;for(var h,a,r,e,o=[];i;){for(h=0,a=i.children.length;h<a;h++)if(r=i.children[h],f(t,e=i.leaf?n(r):r)){if(i.leaf||u(t,e))return!0;o.push(r)}i=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var h=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===h.height)this._splitRoot(this.data,h);else{if(this.data.height<h.height){var a=this.data;this.data=h,h=a}this._insert(h,this.data.height-h.height-1,!0)}else this.data=h;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=x([]),this},remove:function(t,i){if(!t)return this;for(var h,a,r,e,o=this.data,s=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),a=l[l.length-1],h=c.pop(),e=!0),o.leaf&&-1!==(r=n(t,o.children,i)))return o.children.splice(r,1),l.push(o),this._condense(l),this;e||o.leaf||!u(o,s)?a?(h++,o=a.children[h],e=!1):o=null:(l.push(o),c.push(h),h=0,a=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:e,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,a){var r,e=n-i+1,o=this._maxEntries;if(e<=o)return h(r=x(t.slice(i,n+1)),this.toBBox),r;a||(a=Math.ceil(Math.log(e)/Math.log(o)),o=Math.ceil(e/Math.pow(o,a-1))),(r=x([])).leaf=!1,r.height=a;var s,l,c,m,u=Math.ceil(e/o),f=u*Math.ceil(Math.sqrt(o));for(d(t,i,n,f,this.compareMinX),s=i;s<=n;s+=f)for(d(t,s,c=Math.min(s+f-1,n),u,this.compareMinY),l=s;l<=c;l+=u)m=Math.min(l+u-1,c),r.children.push(this._build(t,l,m,a-1));return h(r,this.toBBox),r},_chooseSubtree:function(t,i,n,h){for(var a,r,e,o,l,m,u,f;h.push(i),!i.leaf&&h.length-1!==n;){for(u=f=1/0,a=0,r=i.children.length;a<r;a++)l=s(e=i.children[a]),(m=c(t,e)-l)<f?(f=m,u=l<u?l:u,o=e):m===f&&l<u&&(u=l,o=e);i=o||i.children[0]}return i},_insert:function(t,i,n){var h=this.toBBox,a=n?t:h(t),e=[],o=this._chooseSubtree(a,this.data,i,e);for(o.children.push(t),r(o,a);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(a,e,i)},_split:function(t,i){var n=t[i],a=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,a);var e=this._chooseSplitIndex(n,r,a),o=x(n.children.splice(e,n.children.length-e));o.height=n.height,o.leaf=n.leaf,h(n,this.toBBox),h(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=x([t,i]),this.data.height=t.height+1,this.data.leaf=!1,h(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var h,r,e,o,l,c,u,f;for(c=u=1/0,h=i;h<=n-i;h++)o=m(r=a(t,0,h,this.toBBox),e=a(t,h,n,this.toBBox)),l=s(r)+s(e),o<c?(c=o,f=h,u=l<u?l:u):o===c&&l<u&&(u=l,f=h);return f},_chooseSplitAxis:function(t,i,n){var h=t.leaf?this.compareMinX:e,a=t.leaf?this.compareMinY:o;this._allDistMargin(t,i,n,h)<this._allDistMargin(t,i,n,a)&&t.children.sort(h)},_allDistMargin:function(t,i,n,h){t.children.sort(h);var e,o,s=this.toBBox,c=a(t,0,i,s),m=a(t,n-i,n,s),u=l(c)+l(m);for(e=i;e<n-i;e++)o=t.children[e],r(c,t.leaf?s(o):o),u+=l(c);for(e=n-i-1;e>=i;e--)o=t.children[e],r(m,t.leaf?s(o):o),u+=l(m);return u},_adjustParentBBoxes:function(t,i,n){for(var h=n;h>=0;h--)r(i[h],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():h(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};
},{"quickselect":234}],235:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){};t.prototype.getReplay=function(t,e){},t.prototype.isEmpty=function(){},exports.default=t;
},{}],188:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};exports.default=e;
},{}],270:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={lineString:function(r,t,e,n){var i,a=r[t],u=r[t+1],o=0;for(i=t+n;i<e;i+=n){var s=r[i],l=r[i+1];o+=Math.sqrt((s-a)*(s-a)+(l-u)*(l-u)),a=s,u=l}return o},linearRing:function(t,e,n,i){var a=r.lineString(t,e,n,i),u=t[n-i]-t[e],o=t[n-i+1]-t[e+1];return a+=Math.sqrt(u*u+o*o)}};exports.default=r;
},{}],271:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../math.js"),a=r(t);function r(t){return t&&t.__esModule?t:{default:t}}var e={lineString:function(t,r,e,h,u,M,n,o){for(var l,f,s,i=[],p=t[r]>t[e-h],v=u.length,d=t[r],P=t[r+1],I=t[r+=h],c=t[r+1],w=0,_=Math.sqrt(Math.pow(I-d,2)+Math.pow(c-P,2)),q="",b=0,g=0;g<v;++g){f=p?v-g-1:g;var j=u.charAt(f),x=M(q=p?j+q:q+j)-b;b+=x;for(var m=n+x/2;r<e-h&&w+_<m;)d=I,P=c,I=t[r+=h],c=t[r+1],w+=_,_=Math.sqrt(Math.pow(I-d,2)+Math.pow(c-P,2));var y=m-w,A=Math.atan2(c-P,I-d);if(p&&(A+=A>0?-Math.PI:Math.PI),void 0!==s){var O=A-s;if(O+=O>Math.PI?-2*Math.PI:O<-Math.PI?2*Math.PI:0,Math.abs(O)>o)return null}var S=y/_,k=a.default.lerp(d,I,S),z=a.default.lerp(P,c,S);s==A?(p&&(l[0]=k,l[1]=z,l[2]=x/2),l[4]=q):(b=x,l=[k,z,x/2,A,q=j],p?i.unshift(l):i.push(l),s=A),n+=x}return i}};exports.default=e;
},{"../../math.js":78}],261:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12};exports.default=E;
},{}],189:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../render/replaytype.js"),T=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var r={};r.ORDER=[T.default.POLYGON,T.default.CIRCLE,T.default.LINE_STRING,T.default.IMAGE,T.default.TEXT,T.default.DEFAULT],r.TEXT_ALIGN={},r.TEXT_ALIGN.left=0,r.TEXT_ALIGN.end=0,r.TEXT_ALIGN.center=.5,r.TEXT_ALIGN.right=1,r.TEXT_ALIGN.start=1,r.TEXT_ALIGN.top=0,r.TEXT_ALIGN.middle=.5,r.TEXT_ALIGN.hanging=.2,r.TEXT_ALIGN.alphabetic=.8,r.TEXT_ALIGN.ideographic=.8,r.TEXT_ALIGN.bottom=1,exports.default=r;
},{"../render/replaytype.js":188}],236:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=N(t),i=require("../../array.js"),r=N(i),a=require("../../colorlike.js"),n=N(a),s=require("../../extent.js"),l=N(s),o=require("../../extent/relationship.js"),u=N(o),d=require("../../geom/geometrytype.js"),h=N(d),f=require("../../geom/flat/inflate.js"),c=N(f),p=require("../../geom/flat/length.js"),_=N(p),y=require("../../geom/flat/textpath.js"),g=N(y),v=require("../../geom/flat/transform.js"),m=N(v),x=require("../../has.js"),E=N(x),L=require("../../obj.js"),T=N(L),S=require("../vectorcontext.js"),C=N(S),I=require("../canvas.js"),O=N(I),k=require("../canvas/instruction.js"),b=N(k),D=require("../replay.js"),G=N(D),M=require("../../transform.js"),R=N(M);function N(t){return t&&t.__esModule?t:{default:t}}var q=function(t,e,i,r,a,n){C.default.call(this),this.declutterTree=n,this.tmpExtent_=l.default.createEmpty(),this.tolerance=t,this.maxExtent=e,this.overlaps=a,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.fillOrigin_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=R.default.create(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0,this.tmpLocalTransform_=R.default.create(),this.resetTransform_=R.default.create()};e.default.inherits(q,C.default),q.prototype.replayTextBackground_=function(t,e,i,r,a,n,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,a),t.lineTo.apply(t,e),n&&(this.fillOrigin_=n[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},q.prototype.replayImage_=function(t,e,i,r,a,n,s,o,u,d,h,f,c,p,_,y,g,v){var m=g||v,x=this.tmpLocalTransform_;e-=a*=c,i-=n*=c,p&&(e=Math.round(e),i=Math.round(i));var E,L,T,S,C=_+d>r.width?r.width-d:_,I=o+h>r.height?r.height-h:o,k=this.tmpExtent_,b=y[3]+C*c+y[1],D=y[0]+I*c+y[2],G=e-y[3],M=i-y[0];(m||0!==f)&&(E=[G,M],L=[G+b,M],T=[G+b,M+D],S=[G,M+D]);var N=null;if(0!==f){var q=e+a,j=i+n;N=R.default.compose(x,q,j,1,1,f,-q,-j),l.default.createOrUpdateEmpty(k),l.default.extendCoordinate(k,R.default.apply(x,E)),l.default.extendCoordinate(k,R.default.apply(x,L)),l.default.extendCoordinate(k,R.default.apply(x,T)),l.default.extendCoordinate(k,R.default.apply(x,S))}else l.default.createOrUpdate(G,M,G+b,M+D,k);var F=t.canvas,W=k[0]<=F.width&&k[2]>=0&&k[1]<=F.height&&k[3]>=0;if(s){if(!W&&1==s[4])return;l.default.extend(s,k);var w=W?[t,N?N.slice(0):null,u,r,d,h,C,I,e,i,c]:null;w&&m&&w.push(g,v,E,L,T,S),s.push(w)}else W&&(m&&this.replayTextBackground_(t,E,L,T,S,g,v),O.default.drawImage(t,N,u,r,d,h,C,I,e,i,c))},q.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},q.prototype.appendFlatCoordinates=function(t,e,i,r,a,n){var s=this.coordinates.length,o=this.getBufferedMaxExtent();n&&(e+=r);var d,h,f,c=[t[e],t[e+1]],p=[NaN,NaN],_=!0;for(d=e+r;d<i;d+=r)p[0]=t[d],p[1]=t[d+1],(f=l.default.coordinateRelationship(o,p))!==h?(_&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],_=!1):f===u.default.INTERSECTING?(this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],_=!1):_=!0,c[0]=p[0],c[1]=p[1],h=f;return(a&&_||d===e+r)&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),s},q.prototype.drawCustomCoordinates_=function(t,e,i,r,a){for(var n=0,s=i.length;n<s;++n){var l=i[n],o=this.appendFlatCoordinates(t,e,l,r,!1,!1);a.push(o),e=l}return e},q.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var r,a,n,s,l,o=t.getType(),u=t.getStride(),d=this.coordinates.length;if(o==h.default.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),s=[];var f=t.getEndss();l=0;for(var p=0,_=f.length;p<_;++p){var y=[];l=this.drawCustomCoordinates_(r,l,f[p],u,y),s.push(y)}this.instructions.push([b.default.CUSTOM,d,s,t,i,c.default.coordinatesss])}else o==h.default.POLYGON||o==h.default.MULTI_LINE_STRING?(n=[],r=o==h.default.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(r,0,t.getEnds(),u,n),this.instructions.push([b.default.CUSTOM,d,n,t,i,c.default.coordinatess])):o==h.default.LINE_STRING||o==h.default.MULTI_POINT?(r=t.getFlatCoordinates(),a=this.appendFlatCoordinates(r,0,r.length,u,!1,!1),this.instructions.push([b.default.CUSTOM,d,a,t,i,c.default.coordinates])):o==h.default.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),a=this.coordinates.length,this.instructions.push([b.default.CUSTOM,d,a,t,i]));this.endGeometry(t,e)},q.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[b.default.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[b.default.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},q.prototype.fill_=function(t){if(this.fillOrigin_){var e=R.default.apply(this.renderedTransform_,this.fillOrigin_.slice());t.translate(e[0],e[1]),t.rotate(this.viewRotation_)}t.fill(),this.fillOrigin_&&t.setTransform.apply(t,O.default.resetTransform_)},q.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],E.default.CANVAS_LINE_DASH&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},q.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){var i=t[4];if(1==i||i==t.length-5){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(r)){this.declutterTree.insert(r);for(var a=O.default.drawImage,n=5,s=t.length;n<s;++n){var o=t[n];o&&(o.length>11&&this.replayTextBackground_(o[0],o[13],o[14],o[15],o[16],o[11],o[12]),a.apply(void 0,o))}}t.length=5,l.default.createOrUpdateEmpty(t)}}},q.prototype.replay_=function(t,i,a,n,s,o){var u;this.pixelCoordinates_&&r.default.equals(i,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=m.default.transform2D(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),R.default.setFromArray(this.renderedTransform_,i));for(var d,h,f,c,p,y,v,x,E,L=!T.default.isEmpty(a),S=0,C=n.length,I=0,k=0,D=0,M=null,N=null,q=this.coordinateCache_,j=this.viewRotation_,F={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:j},W=this.instructions!=n||this.overlaps?0:200;S<C;){var w,P,Y,A=n[S];switch(A[0]){case b.default.BEGIN_GEOMETRY:w=A[1],L&&a[e.default.getUid(w).toString()]||!w.getGeometry()?S=A[2]:void 0===o||l.default.intersects(o,w.getGeometry().getExtent())?++S:S=A[2]+1;break;case b.default.BEGIN_PATH:k>W&&(this.fill_(t),k=0),D>W&&(t.stroke(),D=0),k||D||(t.beginPath(),c=p=NaN),++S;break;case b.default.CIRCLE:var U=u[I=A[1]],B=u[I+1],J=u[I+2]-U,H=u[I+3]-B,K=Math.sqrt(J*J+H*H);t.moveTo(U+K,B),t.arc(U,B,K,0,2*Math.PI,!0),++S;break;case b.default.CLOSE_PATH:t.closePath(),++S;break;case b.default.CUSTOM:I=A[1],d=A[2];var X=A[3],V=A[4],z=6==A.length?A[5]:void 0;F.geometry=X,F.feature=w,S in q||(q[S]=[]);var Q=q[S];z?z(u,I,d,2,Q):(Q[0]=u[I],Q[1]=u[I+1],Q.length=2),V(Q,F),++S;break;case b.default.DRAW_IMAGE:I=A[1],d=A[2],E=A[3],h=A[4],f=A[5],x=s?null:A[6];var Z,$,tt,et=A[7],it=A[8],rt=A[9],at=A[10],nt=A[11],st=A[12],lt=A[13],ot=A[14],ut=A[15];for(A.length>16?(Z=A[16],$=A[17],tt=A[18]):(Z=O.default.defaultPadding,$=tt=!1),nt&&(st+=j);I<d;I+=2)this.replayImage_(t,u[I],u[I+1],E,h,f,x,et,it,rt,at,st,lt,ot,ut,Z,$?M:null,tt?N:null);this.renderDeclutter_(x,w),++S;break;case b.default.DRAW_CHARS:var dt=A[1],ht=A[2],ft=A[3];x=s?null:A[4];var ct=A[5],pt=A[6],_t=A[7],yt=A[8],gt=A[9],vt=A[10],mt=A[11],xt=A[12],Et=A[13],Lt=A[14],Tt=_.default.lineString(u,dt,ht,2),St=yt(xt);if(ct||St<=Tt){var Ct=this.textStates[Et].textAlign,It=(Tt-St)*G.default.TEXT_ALIGN[Ct],Ot=g.default.lineString(u,dt,ht,2,xt,yt,It,_t);if(Ot){var kt,bt,Dt,Gt,Mt;if(vt)for(kt=0,bt=Ot.length;kt<bt;++kt)Dt=(Mt=Ot[kt])[4],Gt=this.getImage(Dt,Et,"",vt),h=Mt[2]+mt,f=ft*Gt.height+2*(.5-ft)*mt-gt,this.replayImage_(t,Mt[0],Mt[1],Gt,h,f,x,Gt.height,1,0,0,Mt[3],Lt,!1,Gt.width,O.default.defaultPadding,null,null);if(pt)for(kt=0,bt=Ot.length;kt<bt;++kt)Dt=(Mt=Ot[kt])[4],Gt=this.getImage(Dt,Et,pt,""),h=Mt[2],f=ft*Gt.height-gt,this.replayImage_(t,Mt[0],Mt[1],Gt,h,f,x,Gt.height,1,0,0,Mt[3],Lt,!1,Gt.width,O.default.defaultPadding,null,null)}}this.renderDeclutter_(x,w),++S;break;case b.default.END_GEOMETRY:if(void 0!==s){var Rt=s(w=A[1]);if(Rt)return Rt}++S;break;case b.default.FILL:W?k++:this.fill_(t),++S;break;case b.default.MOVE_TO_LINE_TO:for(I=A[1],d=A[2],P=u[I],v=(Y=u[I+1])+.5|0,(y=P+.5|0)===c&&v===p||(t.moveTo(P,Y),c=y,p=v),I+=2;I<d;I+=2)y=(P=u[I])+.5|0,v=(Y=u[I+1])+.5|0,I!=d-2&&y===c&&v===p||(t.lineTo(P,Y),c=y,p=v);++S;break;case b.default.SET_FILL_STYLE:M=A,this.fillOrigin_=A[2],k&&(this.fill_(t),k=0,D&&(t.stroke(),D=0)),t.fillStyle=A[1],++S;break;case b.default.SET_STROKE_STYLE:N=A,D&&(t.stroke(),D=0),this.setStrokeStyle_(t,A),++S;break;case b.default.STROKE:W?D++:t.stroke(),++S;break;default:++S}}k&&this.fill_(t),D&&t.stroke()},q.prototype.replay=function(t,e,i,r){this.viewRotation_=i,this.replay_(t,e,r,this.instructions,void 0,void 0)},q.prototype.replayHitDetection=function(t,e,i,r,a,n){return this.viewRotation_=i,this.replay_(t,e,r,this.hitDetectionInstructions,a,n)},q.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,a,n=e.length,s=-1;for(t=0;t<n;++t)(a=(i=e[t])[0])==b.default.END_GEOMETRY?s=t:a==b.default.BEGIN_GEOMETRY&&(i[2]=t,r.default.reverseSubArray(this.hitDetectionInstructions,s,t),s=-1)},q.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var r=t.getColor();i.fillStyle=n.default.asColorLike(r||O.default.defaultFillStyle)}else i.fillStyle=void 0;if(e){var a=e.getColor();i.strokeStyle=n.default.asColorLike(a||O.default.defaultStrokeStyle);var s=e.getLineCap();i.lineCap=void 0!==s?s:O.default.defaultLineCap;var l=e.getLineDash();i.lineDash=l?l.slice():O.default.defaultLineDash;var o=e.getLineDashOffset();i.lineDashOffset=o||O.default.defaultLineDashOffset;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:O.default.defaultLineJoin;var d=e.getWidth();i.lineWidth=void 0!==d?d:O.default.defaultLineWidth;var h=e.getMiterLimit();i.miterLimit=void 0!==h?h:O.default.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},q.prototype.applyFill=function(t,e){var i=t.fillStyle,r=[b.default.SET_FILL_STYLE,i];if("string"!=typeof i){var a=e.getExtent();r.push([a[0],a[3]])}this.instructions.push(r)},q.prototype.applyStroke=function(t){this.instructions.push([b.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio])},q.prototype.updateFillStyle=function(t,e,i){var r=t.fillStyle;"string"==typeof r&&t.currentFillStyle==r||(e.call(this,t,i),t.currentFillStyle=r)},q.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,a=t.lineCap,n=t.lineDash,s=t.lineDashOffset,l=t.lineJoin,o=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=a||n!=t.currentLineDash&&!r.default.equals(t.currentLineDash,n)||t.currentLineDashOffset!=s||t.currentLineJoin!=l||t.currentLineWidth!=o||t.currentMiterLimit!=u)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=a,t.currentLineDash=n,t.currentLineDashOffset=s,t.currentLineJoin=l,t.currentLineWidth=o,t.currentMiterLimit=u)},q.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[b.default.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},q.prototype.finish=e.default.nullFunction,q.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=l.default.clone(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;l.default.buffer(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},exports.default=q;
},{"../../index.js":42,"../../array.js":68,"../../colorlike.js":241,"../../extent.js":76,"../../extent/relationship.js":161,"../../geom/geometrytype.js":82,"../../geom/flat/inflate.js":170,"../../geom/flat/length.js":270,"../../geom/flat/textpath.js":271,"../../geom/flat/transform.js":175,"../../has.js":137,"../../obj.js":52,"../vectorcontext.js":233,"../canvas.js":184,"../canvas/instruction.js":261,"../replay.js":189,"../../transform.js":139}],237:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),i=n(t),h=require("../canvas/instruction.js"),e=n(h),s=require("../canvas/replay.js"),o=n(s);function n(t){return t&&t.__esModule?t:{default:t}}var r=function(t,i,h,e,s,n){o.default.call(this,t,i,h,e,s,n),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.snapToPixel_=void 0,this.width_=void 0};i.default.inherits(r,o.default),r.prototype.drawCoordinates_=function(t,i,h,e){return this.appendFlatCoordinates(t,i,h,e,!1,!1)},r.prototype.drawPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var h=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(h,0,h.length,s);this.instructions.push([e.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)}},r.prototype.drawMultiPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var h=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(h,0,h.length,s);this.instructions.push([e.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)}},r.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.snapToPixel_=void 0,this.width_=void 0},r.prototype.setImageStyle=function(t,i){var h=t.getAnchor(),e=t.getSize(),s=t.getHitDetectionImage(1),o=t.getImage(1),n=t.getOrigin();this.anchorX_=h[0],this.anchorY_=h[1],this.declutterGroup_=i,this.hitDetectionImage_=s,this.image_=o,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.snapToPixel_=t.getSnapToPixel(),this.width_=e[0]},exports.default=r;
},{"../../index.js":42,"../canvas/instruction.js":261,"../canvas/replay.js":236}],238:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=r(t),i=require("../canvas/instruction.js"),s=r(i),n=require("../canvas/replay.js"),o=r(n);function r(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e,i,s,n,r){o.default.call(this,t,e,i,s,n,r)};e.default.inherits(a,o.default),a.prototype.drawFlatCoordinates_=function(t,e,i,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,i,n,!1,!1),a=[s.default.MOVE_TO_LINE_TO,o,r];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i},a.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([s.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],[s.default.BEGIN_PATH]);var r=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(r,0,r.length,a),this.hitDetectionInstructions.push([s.default.STROKE]),this.endGeometry(t,e)}},a.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([s.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],[s.default.BEGIN_PATH]);var r,a,l=t.getEnds(),h=t.getFlatCoordinates(),u=t.getStride(),d=0;for(r=0,a=l.length;r<a;++r)d=this.drawFlatCoordinates_(h,d,l[r],u);this.hitDetectionInstructions.push([s.default.STROKE]),this.endGeometry(t,e)}},a.prototype.finish=function(){var t=this.state;void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push([s.default.STROKE]),this.reverseHitDetectionInstructions(),this.state=null},a.prototype.applyStroke=function(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push([s.default.STROKE]),t.lastStroke=this.coordinates.length),t.lastStroke=0,o.default.prototype.applyStroke.call(this,t),this.instructions.push([s.default.BEGIN_PATH])},exports.default=a;
},{"../../index.js":42,"../canvas/instruction.js":261,"../canvas/replay.js":236}],239:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=f(t),i=require("../../color.js"),s=f(i),n=require("../../geom/flat/simplify.js"),o=f(n),r=require("../canvas.js"),l=f(r),a=require("../canvas/instruction.js"),h=f(a),u=require("../canvas/replay.js"),d=f(u);function f(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e,i,s,n,o){d.default.call(this,t,e,i,s,n,o)};e.default.inherits(c,d.default),c.prototype.drawFlatCoordinatess_=function(t,e,i,s){var n=this.state,o=void 0!==n.fillStyle,r=void 0!=n.strokeStyle,l=i.length,a=[h.default.BEGIN_PATH];this.instructions.push(a),this.hitDetectionInstructions.push(a);for(var u=0;u<l;++u){var d=i[u],f=this.coordinates.length,c=this.appendFlatCoordinates(t,e,d,s,!0,!r),S=[h.default.MOVE_TO_LINE_TO,f,c];if(this.instructions.push(S),this.hitDetectionInstructions.push(S),r){var p=[h.default.CLOSE_PATH];this.instructions.push(p),this.hitDetectionInstructions.push(p)}e=d}var y=[h.default.FILL];if(this.hitDetectionInstructions.push(y),o&&this.instructions.push(y),r){var v=[h.default.STROKE];this.instructions.push(v),this.hitDetectionInstructions.push(v)}return e},c.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,s.default.asString(l.default.defaultFillStyle)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length;this.appendFlatCoordinates(r,0,r.length,a,!1,!1);var d=[h.default.BEGIN_PATH],f=[h.default.CIRCLE,u];this.instructions.push(d,f),this.hitDetectionInstructions.push(d,f);var c=[h.default.FILL];if(this.hitDetectionInstructions.push(c),void 0!==i.fillStyle&&this.instructions.push(c),void 0!==i.strokeStyle){var S=[h.default.STROKE];this.instructions.push(S),this.hitDetectionInstructions.push(S)}this.endGeometry(t,e)}},c.prototype.drawPolygon=function(t,e){var i=this.state;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,s.default.asString(l.default.defaultFillStyle)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var n=t.getEnds(),o=t.getOrientedFlatCoordinates(),r=t.getStride();this.drawFlatCoordinatess_(o,0,n,r),this.endGeometry(t,e)},c.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,s.default.asString(l.default.defaultFillStyle)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r,a,u=t.getEndss(),d=t.getOrientedFlatCoordinates(),f=t.getStride(),c=0;for(r=0,a=u.length;r<a;++r)c=this.drawFlatCoordinatess_(d,c,u[r],f);this.endGeometry(t,e)}},c.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t){var e,i,s=this.coordinates;for(e=0,i=s.length;e<i;++e)s[e]=o.default.snap(s[e],t)}},c.prototype.setFillStrokeStyles_=function(t){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.applyFill,t),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},exports.default=c;
},{"../../index.js":42,"../../color.js":259,"../../geom/flat/simplify.js":174,"../canvas.js":184,"../canvas/instruction.js":261,"../canvas/replay.js":236}],269:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={lineString:function(e,r,t,o,a){var i,s,n,u,v,d,c,f,l,p=t,M=t,h=0,x=0,_=t;for(i=t;i<o;i+=a){var b=r[i],g=r[i+1];void 0!==u&&(f=b-u,l=g-v,n=Math.sqrt(f*f+l*l),void 0!==d&&(x+=s,Math.acos((d*f+c*l)/(s*n))>e&&(x>h&&(h=x,p=_,M=i),x=0,_=i-a)),s=n,d=f,c=l),u=b,v=g}return(x+=n)>h?[_,i]:[p,M]}};exports.default=e;
},{}],268:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={POINT:"point",LINE:"line"};exports.default=e;
},{}],240:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=T(t),i=require("../../colorlike.js"),l=T(i),a=require("../../dom.js"),s=T(a),n=require("../../extent.js"),r=T(n),h=require("../../geom/flat/straightchunk.js"),o=T(h),f=require("../../geom/geometrytype.js"),d=T(f),u=require("../../has.js"),g=T(u),x=require("../canvas.js"),_=T(x),S=require("../canvas/instruction.js"),c=T(S),p=require("../canvas/replay.js"),k=T(p),y=require("../replay.js"),v=T(y),m=require("../../style/textplacement.js"),L=T(m);function T(t){return t&&t.__esModule?t:{default:t}}var A=function(t,e,i,l,a,s){k.default.call(this,t,e,i,l,a,s),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},_.default.labelCache.prune()};e.default.inherits(A,k.default),A.measureTextWidths=function(t,e,i){var l,a,s=e.length,n=0;for(a=0;a<s;++a)l=_.default.measureTextWidth(t,e[a]),n=Math.max(n,l),i.push(l);return n},A.prototype.drawText=function(t,e){var i=this.textFillState_,l=this.textStrokeState_,a=this.textState_;if(""!==this.text_&&a&&(i||l)){var s,n,h=this.coordinates.length,f=t.getType(),u=null,g=2,x=2;if(a.placement===L.default.LINE){if(!r.default.intersects(this.getBufferedMaxExtent(),t.getExtent()))return;var _;if(u=t.getFlatCoordinates(),x=t.getStride(),f==d.default.LINE_STRING)_=[u.length];else if(f==d.default.MULTI_LINE_STRING)_=t.getEnds();else if(f==d.default.POLYGON)_=t.getEnds().slice(0,1);else if(f==d.default.MULTI_POLYGON){var S=t.getEndss();for(_=[],s=0,n=S.length;s<n;++s)_.push(S[s][0])}this.beginGeometry(t,e);for(var c,p=a.textAlign,k=0,y=0,v=_.length;y<v;++y){if(void 0==p){var m=o.default.lineString(a.maxAngle,u,k,_[y],x);k=m[0],c=m[1]}else c=_[y];for(s=k;s<c;s+=x)this.coordinates.push(u[s],u[s+1]);g=this.coordinates.length,k=_[y],this.drawChars_(h,g,this.declutterGroup_),h=g}this.endGeometry(t,e)}else{var T=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),A=T.width/this.pixelRatio;switch(f){case d.default.POINT:case d.default.MULTI_POINT:g=(u=t.getFlatCoordinates()).length;break;case d.default.LINE_STRING:u=t.getFlatMidpoint();break;case d.default.CIRCLE:u=t.getCenter();break;case d.default.MULTI_LINE_STRING:g=(u=t.getFlatMidpoints()).length;break;case d.default.POLYGON:if(u=t.getFlatInteriorPoint(),!a.overflow&&u[2]/this.resolution<A)return;x=3;break;case d.default.MULTI_POLYGON:var I=t.getFlatInteriorPoints();for(u=[],s=0,n=I.length;s<n;s+=3)(a.overflow||I[s+2]/this.resolution>=A)&&u.push(I[s],I[s+1]);if(0==(g=u.length))return}g=this.appendFlatCoordinates(u,0,g,x,!1,!1),this.beginGeometry(t,e),(a.backgroundFill||a.backgroundStroke)&&(this.setFillStrokeStyle(a.backgroundFill,a.backgroundStroke),this.updateFillStyle(this.state,this.applyFill,t),this.updateStrokeStyle(this.state,this.applyStroke)),this.drawTextImage_(T,h,g),this.endGeometry(t,e)}}},A.prototype.getImage=function(t,e,i,l){var a,n=l+e+t+i+this.pixelRatio,r=_.default.labelCache;if(!r.containsKey(n)){var h=l?this.strokeStates[l]||this.textStrokeState_:null,o=i?this.fillStates[i]||this.textFillState_:null,f=this.textStates[e]||this.textState_,d=this.pixelRatio,u=f.scale*d,x=v.default.TEXT_ALIGN[f.textAlign||_.default.defaultTextAlign],S=l&&h.lineWidth?h.lineWidth:0,c=t.split("\n"),p=c.length,k=[],y=A.measureTextWidths(f.font,c,k),m=_.default.measureTextHeight(f.font),L=m*p,T=y+S,I=s.default.createCanvasContext2D(Math.ceil(T*u),Math.ceil((L+S)*u));a=I.canvas,r.set(n,a),1!=u&&I.scale(u,u),I.font=f.font,l&&(I.strokeStyle=h.strokeStyle,I.lineWidth=S*(g.default.SAFARI?u:1),I.lineCap=h.lineCap,I.lineJoin=h.lineJoin,I.miterLimit=h.miterLimit,g.default.CANVAS_LINE_DASH&&h.lineDash.length&&(I.setLineDash(h.lineDash),I.lineDashOffset=h.lineDashOffset)),i&&(I.fillStyle=o.fillStyle),I.textBaseline="middle",I.textAlign="center";var O,F=.5-x,C=x*a.width/u+F*S;if(l)for(O=0;O<p;++O)I.strokeText(c[O],C+F*k[O],.5*(S+m)+O*m);if(i)for(O=0;O<p;++O)I.fillText(c[O],C+F*k[O],.5*(S+m)+O*m)}return r.get(n)},A.prototype.drawTextImage_=function(t,e,i){var l=this.textState_,a=this.textStrokeState_,s=this.pixelRatio,n=v.default.TEXT_ALIGN[l.textAlign||_.default.defaultTextAlign],r=v.default.TEXT_ALIGN[l.textBaseline],h=a&&a.lineWidth?a.lineWidth:0,o=n*t.width/s+2*(.5-n)*h,f=r*t.height/s+2*(.5-r)*h;this.instructions.push([c.default.DRAW_IMAGE,e,i,t,(o-this.textOffsetX_)*s,(f-this.textOffsetY_)*s,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,t.width,l.padding==_.default.defaultPadding?_.default.defaultPadding:l.padding.map(function(t){return t*s}),!!l.backgroundFill,!!l.backgroundStroke]),this.hitDetectionInstructions.push([c.default.DRAW_IMAGE,e,i,t,(o-this.textOffsetX_)*s,(f-this.textOffsetY_)*s,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/s,!0,t.width,l.padding,!!l.backgroundFill,!!l.backgroundStroke])},A.prototype.drawChars_=function(t,e,i){var l=this.textStrokeState_,a=this.textState_,s=this.textFillState_,n=this.strokeKey_;l&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:l.strokeStyle,lineCap:l.lineCap,lineDashOffset:l.lineDashOffset,lineWidth:l.lineWidth,lineJoin:l.lineJoin,miterLimit:l.miterLimit,lineDash:l.lineDash}));var r=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:a.font,textAlign:a.textAlign||_.default.defaultTextAlign,scale:a.scale});var h=this.fillKey_;s&&(h in this.fillStates||(this.fillStates[h]={fillStyle:s.fillStyle}));var o=this.pixelRatio,f=v.default.TEXT_ALIGN[a.textBaseline],d=this.textOffsetY_*o,u=this.text_,g=a.font,x=a.scale,S=l?l.lineWidth*x/2:0,p=this.widths_[g];p||(this.widths_[g]=p={}),this.instructions.push([c.default.DRAW_CHARS,t,e,f,i,a.overflow,h,a.maxAngle,function(t){var e=p[t];return e||(e=p[t]=_.default.measureTextWidth(g,t)),e*x*o},d,n,S*o,u,r,1]),this.hitDetectionInstructions.push([c.default.DRAW_CHARS,t,e,f,i,a.overflow,h,a.maxAngle,function(t){var e=p[t];return e||(e=p[t]=_.default.measureTextWidth(g,t)),e*x},d,n,S,u,r,1/o])},A.prototype.setTextStyle=function(t,i){var a,s,n;if(t){this.declutterGroup_=i;var r=t.getFill();r?((s=this.textFillState_)||(s=this.textFillState_={}),s.fillStyle=l.default.asColorLike(r.getColor()||_.default.defaultFillStyle)):s=this.textFillState_=null;var h=t.getStroke();if(h){(n=this.textStrokeState_)||(n=this.textStrokeState_={});var o=h.getLineDash(),f=h.getLineDashOffset(),d=h.getWidth(),u=h.getMiterLimit();n.lineCap=h.getLineCap()||_.default.defaultLineCap,n.lineDash=o?o.slice():_.default.defaultLineDash,n.lineDashOffset=void 0===f?_.default.defaultLineDashOffset:f,n.lineJoin=h.getLineJoin()||_.default.defaultLineJoin,n.lineWidth=void 0===d?_.default.defaultLineWidth:d,n.miterLimit=void 0===u?_.default.defaultMiterLimit:u,n.strokeStyle=l.default.asColorLike(h.getColor()||_.default.defaultStrokeStyle)}else n=this.textStrokeState_=null;a=this.textState_;var g=t.getFont()||_.default.defaultFont;_.default.checkFont(g);var x=t.getScale();a.overflow=t.getOverflow(),a.font=g,a.maxAngle=t.getMaxAngle(),a.placement=t.getPlacement(),a.textAlign=t.getTextAlign(),a.textBaseline=t.getTextBaseline()||_.default.defaultTextBaseline,a.backgroundFill=t.getBackgroundFill(),a.backgroundStroke=t.getBackgroundStroke(),a.padding=t.getPadding()||_.default.defaultPadding,a.scale=void 0===x?1:x;var S=t.getOffsetX(),c=t.getOffsetY(),p=t.getRotateWithView(),k=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===S?0:S,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0===k?0:k,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:e.default.getUid(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=a.font+a.scale+(a.textAlign||"?"),this.fillKey_=s?"string"==typeof s.fillStyle?s.fillStyle:"|"+e.default.getUid(s.fillStyle):""}else this.text_=""},exports.default=A;
},{"../../index.js":42,"../../colorlike.js":241,"../../dom.js":134,"../../extent.js":76,"../../geom/flat/straightchunk.js":269,"../../geom/geometrytype.js":82,"../../has.js":137,"../canvas.js":184,"../canvas/instruction.js":261,"../canvas/replay.js":236,"../replay.js":189,"../../style/textplacement.js":268}],198:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),r=E(e),t=require("../../array.js"),i=E(t),a=require("../../dom.js"),l=E(a),o=require("../../extent.js"),n=E(o),s=require("../../geom/flat/transform.js"),u=E(s),f=require("../../obj.js"),d=E(f),c=require("../replaygroup.js"),p=E(c),y=require("../replaytype.js"),h=E(y),_=require("../canvas/replay.js"),v=E(_),C=require("../canvas/imagereplay.js"),m=E(C),x=require("../canvas/linestringreplay.js"),g=E(x),T=require("../canvas/polygonreplay.js"),R=E(T),A=require("../canvas/textreplay.js"),j=E(A),B=require("../replay.js"),I=E(B),D=require("../../transform.js"),q=E(D);function E(e){return e&&e.__esModule?e:{default:e}}var M=function(e,r,t,i,a,o,n){p.default.call(this),this.declutterTree_=o,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=r,this.overlaps_=a,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=n,this.replaysByZIndex_={},this.hitDetectionContext_=l.default.createCanvasContext2D(1,1),this.hitDetectionTransform_=q.default.create()};r.default.inherits(M,p.default),M.circleArrayCache_={0:[[!0]]},M.fillCircleArrayRowToMiddle_=function(e,r,t){var i,a=Math.floor(e.length/2);if(r>=a)for(i=a;i<r;i++)e[i][t]=!0;else if(r<a)for(i=r+1;i<a;i++)e[i][t]=!0},M.getCircleArray_=function(e){if(void 0!==M.circleArrayCache_[e])return M.circleArrayCache_[e];for(var r=2*e+1,t=new Array(r),i=0;i<r;i++)t[i]=new Array(r);for(var a=e,l=0,o=0;a>=l;)M.fillCircleArrayRowToMiddle_(t,e+a,e+l),M.fillCircleArrayRowToMiddle_(t,e+l,e+a),M.fillCircleArrayRowToMiddle_(t,e-l,e+a),M.fillCircleArrayRowToMiddle_(t,e-a,e+l),M.fillCircleArrayRowToMiddle_(t,e-a,e-l),M.fillCircleArrayRowToMiddle_(t,e-l,e-a),M.fillCircleArrayRowToMiddle_(t,e+l,e-a),M.fillCircleArrayRowToMiddle_(t,e+a,e-l),2*((o+=1+2*++l)-a)+1>0&&(o+=1-2*(a-=1));return M.circleArrayCache_[e]=t,t},M.replayDeclutter=function(e,r,t){for(var a=Object.keys(e).map(Number).sort(i.default.numberSafeCompareFunction),l={},o=0,n=a.length;o<n;++o)for(var s=e[a[o].toString()],u=0,f=s.length;u<f;){var d=s[u++],c=s[u++];d.replay(r,c,t,l)}},M.prototype.addDeclutter=function(e){var r=null;return this.declutterTree_&&(e?(r=this.declutterGroup_)[4]++:(r=this.declutterGroup_=n.default.createEmpty()).push(1)),r},M.prototype.clip=function(e,r){var t=this.getClipCoords(r);e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.clip()},M.prototype.hasReplays=function(e){for(var r in this.replaysByZIndex_)for(var t=this.replaysByZIndex_[r],i=0,a=e.length;i<a;++i)if(e[i]in t)return!0;return!1},M.prototype.finish=function(){var e;for(e in this.replaysByZIndex_){var r,t=this.replaysByZIndex_[e];for(r in t)t[r].finish()}},M.prototype.forEachFeatureAtCoordinate=function(e,r,t,i,a,l,o){var s,u=2*(i=Math.round(i))+1,f=q.default.compose(this.hitDetectionTransform_,i+.5,i+.5,1/r,-1/r,-t,-e[0],-e[1]),d=this.hitDetectionContext_;d.canvas.width!==u||d.canvas.height!==u?(d.canvas.width=u,d.canvas.height=u):d.clearRect(0,0,u,u),void 0!==this.renderBuffer_&&(s=n.default.createEmpty(),n.default.extendCoordinate(s,e),n.default.buffer(s,r*(this.renderBuffer_+i),s));var c,p=M.getCircleArray_(i);return this.declutterTree_&&(c=this.declutterTree_.all().map(function(e){return e.value})),this.replayHitDetection_(d,f,t,a,function(e){for(var r=d.getImageData(0,0,u,u).data,t=0;t<u;t++)for(var i=0;i<u;i++){var a;if(p[t][i]&&r[4*(i*u+t)+3]>0)return c&&-1===c.indexOf(e)||(a=l(e)),a||void d.clearRect(0,0,u,u)}},s,o)},M.prototype.getClipCoords=function(e){var r=this.maxExtent_,t=r[0],i=r[1],a=r[2],l=r[3],o=[t,i,t,l,a,l,a,i];return u.default.transform2D(o,0,8,2,e,o),o},M.prototype.getReplay=function(e,r){var t=void 0!==e?e.toString():"0",i=this.replaysByZIndex_[t];void 0===i&&(i={},this.replaysByZIndex_[t]=i);var a=i[r];void 0===a&&(a=new(0,M.BATCH_CONSTRUCTORS_[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),i[r]=a);return a},M.prototype.getReplays=function(){return this.replaysByZIndex_},M.prototype.isEmpty=function(){return d.default.isEmpty(this.replaysByZIndex_)},M.prototype.replay=function(e,r,t,a,l,o){var n=Object.keys(this.replaysByZIndex_).map(Number);n.sort(i.default.numberSafeCompareFunction),e.save(),this.clip(e,r);var s,u,f,d,c,p,y=l||I.default.ORDER;for(s=0,u=n.length;s<u;++s){var _=n[s].toString();for(c=this.replaysByZIndex_[_],f=0,d=y.length;f<d;++f){var v=y[f];if(void 0!==(p=c[v]))if(!o||v!=h.default.IMAGE&&v!=h.default.TEXT)p.replay(e,r,t,a);else{var C=o[_];C?C.push(p,r.slice(0)):o[_]=[p,r.slice(0)]}}}e.restore()},M.prototype.replayHitDetection_=function(e,r,t,a,l,o,n){var s,u,f,d,c,p=Object.keys(this.replaysByZIndex_).map(Number);for(p.sort(i.default.numberSafeCompareFunction),s=p.length-1;s>=0;--s){var y=p[s].toString();for(f=this.replaysByZIndex_[y],u=I.default.ORDER.length-1;u>=0;--u){var _=I.default.ORDER[u];if(void 0!==(d=f[_]))if(!n||_!=h.default.IMAGE&&_!=h.default.TEXT){if(c=d.replayHitDetection(e,r,t,a,l,o))return c}else{var v=n[y];v?v.push(d,r.slice(0)):n[y]=[d,r.slice(0)]}}}},M.BATCH_CONSTRUCTORS_={Circle:R.default,Default:v.default,Image:m.default,LineString:g.default,Polygon:R.default,Text:j.default},exports.default=M;
},{"../../index.js":42,"../../array.js":68,"../../dom.js":134,"../../extent.js":76,"../../geom/flat/transform.js":175,"../../obj.js":52,"../replaygroup.js":235,"../replaytype.js":188,"../canvas/replay.js":236,"../canvas/imagereplay.js":237,"../canvas/linestringreplay.js":238,"../canvas/polygonreplay.js":239,"../canvas/textreplay.js":240,"../replay.js":189,"../../transform.js":139}],185:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=g(e),r=require("../imagestate.js"),a=g(r),l=require("../geom/geometrytype.js"),n=g(l),d=require("../render/replaytype.js"),i=g(d);function g(e){return e&&e.__esModule?e:{default:e}}var o={defaultOrder:function(e,r){return t.default.getUid(e)-t.default.getUid(r)},getSquaredTolerance:function(e,t){var r=o.getTolerance(e,t);return r*r},getTolerance:function(e,r){return t.default.SIMPLIFY_TOLERANCE*e/r},renderCircleGeometry_:function(e,t,r,a){var l=r.getFill(),n=r.getStroke();if(l||n){var d=e.getReplay(r.getZIndex(),i.default.CIRCLE);d.setFillStrokeStyle(l,n),d.drawCircle(t,a)}var g=r.getText();if(g){var o=e.getReplay(r.getZIndex(),i.default.TEXT);o.setTextStyle(g,e.addDeclutter(!1)),o.drawText(t,a)}},renderFeature:function(e,t,r,l,n,d){var i,g,u=!1;return(i=r.getImage())&&((g=i.getImageState())==a.default.LOADED||g==a.default.ERROR?i.unlistenImageChange(n,d):(g==a.default.IDLE&&i.load(),g=i.getImageState(),i.listenImageChange(n,d),u=!0)),o.renderFeature_(e,t,r,l),u},renderFeature_:function(e,t,r,a){var l=r.getGeometryFunction()(t);if(l){var n=l.getSimplifiedGeometry(a);if(r.getRenderer())o.renderGeometry_(e,n,r,t);else(0,o.GEOMETRY_RENDERERS_[n.getType()])(e,n,r,t)}},renderGeometry_:function(e,t,r,a){if(t.getType()!=n.default.GEOMETRY_COLLECTION)e.getReplay(r.getZIndex(),i.default.DEFAULT).drawCustom(t,a,r.getRenderer());else for(var l=t.getGeometries(),d=0,g=l.length;d<g;++d)o.renderGeometry_(e,l[d],r,a)},renderGeometryCollectionGeometry_:function(e,t,r,a){var l,n,d=t.getGeometriesArray();for(l=0,n=d.length;l<n;++l){(0,o.GEOMETRY_RENDERERS_[d[l].getType()])(e,d[l],r,a)}},renderLineStringGeometry_:function(e,t,r,a){var l=r.getStroke();if(l){var n=e.getReplay(r.getZIndex(),i.default.LINE_STRING);n.setFillStrokeStyle(null,l),n.drawLineString(t,a)}var d=r.getText();if(d){var g=e.getReplay(r.getZIndex(),i.default.TEXT);g.setTextStyle(d,e.addDeclutter(!1)),g.drawText(t,a)}},renderMultiLineStringGeometry_:function(e,t,r,a){var l=r.getStroke();if(l){var n=e.getReplay(r.getZIndex(),i.default.LINE_STRING);n.setFillStrokeStyle(null,l),n.drawMultiLineString(t,a)}var d=r.getText();if(d){var g=e.getReplay(r.getZIndex(),i.default.TEXT);g.setTextStyle(d,e.addDeclutter(!1)),g.drawText(t,a)}},renderMultiPolygonGeometry_:function(e,t,r,a){var l=r.getFill(),n=r.getStroke();if(n||l){var d=e.getReplay(r.getZIndex(),i.default.POLYGON);d.setFillStrokeStyle(l,n),d.drawMultiPolygon(t,a)}var g=r.getText();if(g){var o=e.getReplay(r.getZIndex(),i.default.TEXT);o.setTextStyle(g,e.addDeclutter(!1)),o.drawText(t,a)}},renderPointGeometry_:function(e,t,r,l){var n=r.getImage();if(n){if(n.getImageState()!=a.default.LOADED)return;var d=e.getReplay(r.getZIndex(),i.default.IMAGE);d.setImageStyle(n,e.addDeclutter(!1)),d.drawPoint(t,l)}var g=r.getText();if(g){var o=e.getReplay(r.getZIndex(),i.default.TEXT);o.setTextStyle(g,e.addDeclutter(!!n)),o.drawText(t,l)}},renderMultiPointGeometry_:function(e,t,r,l){var n=r.getImage();if(n){if(n.getImageState()!=a.default.LOADED)return;var d=e.getReplay(r.getZIndex(),i.default.IMAGE);d.setImageStyle(n,e.addDeclutter(!1)),d.drawMultiPoint(t,l)}var g=r.getText();if(g){var o=e.getReplay(r.getZIndex(),i.default.TEXT);o.setTextStyle(g,e.addDeclutter(!!n)),o.drawText(t,l)}},renderPolygonGeometry_:function(e,t,r,a){var l=r.getFill(),n=r.getStroke();if(l||n){var d=e.getReplay(r.getZIndex(),i.default.POLYGON);d.setFillStrokeStyle(l,n),d.drawPolygon(t,a)}var g=r.getText();if(g){var o=e.getReplay(r.getZIndex(),i.default.TEXT);o.setTextStyle(g,e.addDeclutter(!1)),o.drawText(t,a)}}};o.GEOMETRY_RENDERERS_={Point:o.renderPointGeometry_,LineString:o.renderLineStringGeometry_,Polygon:o.renderPolygonGeometry_,MultiPoint:o.renderMultiPointGeometry_,MultiLineString:o.renderMultiLineStringGeometry_,MultiPolygon:o.renderMultiPolygonGeometry_,GeometryCollection:o.renderGeometryCollectionGeometry_,Circle:o.renderCircleGeometry_},exports.default=o;
},{"../index.js":42,"../imagestate.js":222,"../geom/geometrytype.js":82,"../render/replaytype.js":188}],108:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=T(e),r=require("../../layertype.js"),a=T(r),i=require("../../viewhint.js"),n=T(i),s=require("../../dom.js"),l=T(s),d=require("../../events.js"),o=T(d),u=require("../../events/eventtype.js"),h=T(u),f=require("rbush"),p=T(f),c=require("../../extent.js"),g=T(c),v=require("../../render/eventtype.js"),y=T(v),_=require("../../render/canvas.js"),x=T(_),E=require("../../render/canvas/replaygroup.js"),R=T(E),C=require("../type.js"),A=T(C),m=require("../canvas/layer.js"),j=T(m),q=require("../vector.js"),F=T(q);function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e){j.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,p.default)(9):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=g.default.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=l.default.createCanvasContext2D(),o.default.listen(x.default.labelCache,h.default.CLEAR,this.handleFontsChanged_,this)};t.default.inherits(I,j.default),I.handles=function(e,t){return e===A.default.CANVAS&&t.getType()===a.default.VECTOR},I.create=function(e,t){return new I(t)},I.prototype.disposeInternal=function(){o.default.unlisten(x.default.labelCache,h.default.CLEAR,this.handleFontsChanged_,this),j.default.prototype.disposeInternal.call(this)},I.prototype.composeFrame=function(e,t,r){var a=e.extent,i=e.pixelRatio,n=t.managed?e.skippedFeatureUids:{},s=e.viewState,l=s.projection,d=s.rotation,o=l.getExtent(),u=this.getLayer().getSource(),h=this.getTransform(e,0);this.preCompose(r,e,h);var f=t.extent,p=void 0!==f;p&&this.clip(r,e,f);var c=this.replayGroup_;if(c&&!c.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var v,_=this.getLayer(),E=0,R=0,C=1!==t.opacity,A=_.hasListener(y.default.RENDER);if(C||A){var m=r.canvas.width,j=r.canvas.height;if(d){var q=Math.round(Math.sqrt(m*m+j*j));E=(q-m)/2,R=(q-j)/2,m=j=q}this.context.canvas.width=m,this.context.canvas.height=j,v=this.context}else v=r;var F=v.globalAlpha;C||(v.globalAlpha=t.opacity),v!=r&&v.translate(E,R);var T=e.size[0]*i,I=e.size[1]*i;if(x.default.rotateAtOffset(v,-d,T/2,I/2),c.replay(v,h,d,n),u.getWrapX()&&l.canWrapX()&&!g.default.containsExtent(o,a)){for(var S,b=a[0],w=g.default.getWidth(o),G=0;b<o[0];)S=w*--G,h=this.getTransform(e,S),c.replay(v,h,d,n),b+=w;for(G=0,b=a[2];b>o[2];)S=w*++G,h=this.getTransform(e,S),c.replay(v,h,d,n),b-=w;h=this.getTransform(e,0)}if(x.default.rotateAtOffset(v,d,T/2,I/2),v!=r){if(A&&this.dispatchRenderEvent(v,e,h),C){var O=r.globalAlpha;r.globalAlpha=t.opacity,r.drawImage(v.canvas,-E,-R),r.globalAlpha=O}else r.drawImage(v.canvas,-E,-R);v.translate(-E,-R)}C||(v.globalAlpha=F)}p&&r.restore(),this.postCompose(r,e,t,h)},I.prototype.forEachFeatureAtCoordinate=function(e,r,a,i,n){if(this.replayGroup_){var s=r.viewState.resolution,l=r.viewState.rotation,d=this.getLayer(),o={};return this.replayGroup_.forEachFeatureAtCoordinate(e,s,l,a,{},function(e){var r=t.default.getUid(e).toString();if(!(r in o))return o[r]=!0,i.call(n,e,d)},null)}},I.prototype.handleFontsChanged_=function(e){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},I.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},I.prototype.prepareFrame=function(e,t){var r=this.getLayer(),a=r.getSource();this.updateLogos(e,a);var i=e.viewHints[n.default.ANIMATING],s=e.viewHints[n.default.INTERACTING],l=r.getUpdateWhileAnimating(),d=r.getUpdateWhileInteracting();if(!this.dirty_&&!l&&i||!d&&s)return!0;var o=e.extent,u=e.viewState,h=u.projection,f=u.resolution,p=e.pixelRatio,c=r.getRevision(),v=r.getRenderBuffer(),y=r.getRenderOrder();void 0===y&&(y=F.default.defaultOrder);var _=g.default.buffer(o,v*f),x=u.projection.getExtent();if(a.getWrapX()&&u.projection.canWrapX()&&!g.default.containsExtent(x,e.extent)){var E=g.default.getWidth(x),C=Math.max(g.default.getWidth(_)/2,E);_[0]=x[0]-C,_[2]=x[2]+C}if(!this.dirty_&&this.renderedResolution_==f&&this.renderedRevision_==c&&this.renderedRenderOrder_==y&&g.default.containsExtent(this.renderedExtent_,_))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var A=new R.default(F.default.getTolerance(f,p),_,f,p,a.getOverlaps(),this.declutterTree_,r.getRenderBuffer());a.loadFeatures(_,f,h);var m=function(e){var t,a=e.getStyleFunction();if(a?t=a.call(e,f):(a=r.getStyleFunction())&&(t=a(e,f)),t){var i=this.renderFeature(e,f,p,t,A);this.dirty_=this.dirty_||i}}.bind(this);if(y){var j=[];a.forEachFeatureInExtent(_,function(e){j.push(e)},this),j.sort(y);for(var q=0,T=j.length;q<T;++q)m(j[q])}else a.forEachFeatureInExtent(_,m,this);return A.finish(),this.renderedResolution_=f,this.renderedRevision_=c,this.renderedRenderOrder_=y,this.renderedExtent_=_,this.replayGroup_=A,this.replayGroupChanged=!0,!0},I.prototype.renderFeature=function(e,t,r,a,i){if(!a)return!1;var n=!1;if(Array.isArray(a))for(var s=0,l=a.length;s<l;++s)n=F.default.renderFeature(i,e,a[s],F.default.getSquaredTolerance(t,r),this.handleStyleImageChange_,this)||n;else n=F.default.renderFeature(i,e,a,F.default.getSquaredTolerance(t,r),this.handleStyleImageChange_,this);return n},exports.default=I;
},{"../../index.js":42,"../../layertype.js":177,"../../viewhint.js":64,"../../dom.js":134,"../../events.js":135,"../../events/eventtype.js":153,"rbush":209,"../../extent.js":76,"../../render/eventtype.js":183,"../../render/canvas.js":184,"../../render/canvas/replaygroup.js":198,"../type.js":155,"../canvas/layer.js":199,"../vector.js":185}],187:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};exports.default=e;
},{}],110:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=V(e),r=require("../../layertype.js"),i=V(r),a=require("../../tilestate.js"),o=V(a),n=require("../../dom.js"),l=V(n),d=require("../../events.js"),s=V(d),u=require("../../events/eventtype.js"),f=V(u),p=require("rbush"),g=V(p),h=require("../../extent.js"),y=V(h),c=require("../../layer/vectortilerendertype.js"),v=V(c),R=require("../../proj.js"),T=V(R),C=require("../../proj/units.js"),E=V(C),S=require("../../render/replaytype.js"),_=V(S),j=require("../../render/canvas.js"),m=V(j),x=require("../../render/canvas/replaygroup.js"),L=V(x),O=require("../../render/replay.js"),A=V(O),I=require("../type.js"),q=V(I),G=require("../canvas/tilelayer.js"),F=V(G),w=require("../vector.js"),P=V(w),M=require("../../transform.js"),b=V(M);function V(e){return e&&e.__esModule?e:{default:e}}var D=function(e){this.context=null,F.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,g.default)(9):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=b.default.create(),this.zDirection=e.getRenderMode()==v.default.VECTOR?1:0,s.default.listen(m.default.labelCache,f.default.CLEAR,this.handleFontsChanged_,this)};t.default.inherits(D,F.default),D.handles=function(e,t){return e===q.default.CANVAS&&t.getType()===i.default.VECTOR_TILE},D.create=function(e,t){return new D(t)},D.IMAGE_REPLAYS={image:[_.default.POLYGON,_.default.CIRCLE,_.default.LINE_STRING,_.default.IMAGE,_.default.TEXT],hybrid:[_.default.POLYGON,_.default.LINE_STRING]},D.VECTOR_REPLAYS={image:[_.default.DEFAULT],hybrid:[_.default.IMAGE,_.default.TEXT,_.default.DEFAULT],vector:A.default.ORDER},D.prototype.disposeInternal=function(){s.default.unlisten(m.default.labelCache,f.default.CLEAR,this.handleFontsChanged_,this),F.default.prototype.disposeInternal.call(this)},D.prototype.prepareFrame=function(e,t){var r=this.getLayer(),i=r.getRevision();if(this.renderedLayerRevision_!=i){this.renderedTiles.length=0;var a=r.getRenderMode();this.context||a==v.default.VECTOR||(this.context=l.default.createCanvasContext2D()),this.context&&a==v.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=i,F.default.prototype.prepareFrame.apply(this,arguments)},D.prototype.createReplayGroup_=function(e,t){var r=this.getLayer(),i=t.pixelRatio,a=t.viewState.projection,n=r.getRevision(),l=r.getRenderOrder()||null,d=e.getReplayState(r);if(d.dirty||d.renderedRevision!=n||d.renderedRenderOrder!=l){for(var s=r.getSource(),u=s.getTileGrid(),f=s.getTileGridForProjection(a),p=f.getResolution(e.tileCoord[0]),g=f.getTileCoordExtent(e.wrappedTileCoord),h={},c=0,v=e.tileKeys.length;c<v;++c){var R=e.getTile(e.tileKeys[c]);if(R.getState()!=o.default.ERROR){var C=R.tileCoord,S=u.getTileCoordExtent(C),_=y.default.getIntersection(g,S),j=y.default.equals(S,_)?null:y.default.buffer(_,r.getRenderBuffer()*p),m=R.getProjection(),x=!1;T.default.equivalent(a,m)||(x=!0,R.setProjection(a)),d.dirty=!1;var O,A=new L.default(0,_,p,i,s.getOverlaps(),this.declutterTree_,r.getRenderBuffer()),I=P.default.getSquaredTolerance(p,i),q=function(e){var t,i=e.getStyleFunction();if(i?t=i.call(e,p):(i=r.getStyleFunction())&&(t=i(e,p)),t){var a=this.renderFeature(e,I,t,A);this.dirty_=this.dirty_||a,d.dirty=d.dirty||a}},G=R.getFeatures();l&&l!==d.renderedRenderOrder&&G.sort(l);for(var F=0,w=G.length;F<w;++F)O=G[F],x&&(m.getUnits()==E.default.TILE_PIXELS&&(m.setWorldExtent(S),m.setExtent(R.getExtent())),O.getGeometry().transform(m,a)),j&&!y.default.intersects(j,O.getGeometry().getExtent())||q.call(this,O);for(var M in A.finish(),A.getReplays())h[M]=!0;R.setReplayGroup(r,e.tileCoord.toString(),A)}}d.renderedRevision=n,d.renderedRenderOrder=l}},D.prototype.drawTileImage=function(e,t,r,i,a,o,n,l,d){var s=e;this.createReplayGroup_(s,t),this.context&&(this.renderTileImage_(s,t,r),F.default.prototype.drawTileImage.apply(this,arguments))},D.prototype.forEachFeatureAtCoordinate=function(e,r,i,a,n){var l=r.viewState.resolution,d=r.viewState.rotation;i=void 0==i?0:i;var s,u,f,p,g,h,c,v,R=this.getLayer(),T={},C=this.renderedTiles,E=R.getSource().getTileGridForProjection(r.viewState.projection);for(f=0,p=C.length;f<p;++f)if(c=(h=C[f]).wrappedTileCoord,v=E.getTileCoordExtent(c,this.tmpExtent),s=y.default.buffer(v,i*l,s),y.default.containsCoordinate(s,e))for(var S=0,_=h.tileKeys.length;S<_;++S){var j=h.getTile(h.tileKeys[S]);j.getState()!=o.default.ERROR&&(g=j.getReplayGroup(R,h.tileCoord.toString()),u=u||g.forEachFeatureAtCoordinate(e,l,d,i,{},function(e){var r=t.default.getUid(e).toString();if(!(r in T))return T[r]=!0,a.call(n,e,R)},null))}return u},D.prototype.getReplayTransform_=function(e,t){var r=this.getLayer().getSource().getTileGrid(),i=e.tileCoord,a=r.getResolution(i[0]),o=t.viewState,n=t.pixelRatio,l=o.resolution/n,d=r.getTileCoordExtent(i,this.tmpExtent),s=o.center,u=y.default.getTopLeft(d),f=t.size,p=Math.round(n*f[0]/2),g=Math.round(n*f[1]/2);return b.default.compose(this.tmpTransform_,p,g,a/l,a/l,o.rotation,(u[0]-s[0])/a,(s[1]-u[1])/a)},D.prototype.handleFontsChanged_=function(e){var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},D.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},D.prototype.postCompose=function(e,t,r){var i,a,n=this.getLayer(),l=n.getDeclutter()?{}:null,d=n.getSource(),s=n.getRenderMode(),u=D.VECTOR_REPLAYS[s],f=t.pixelRatio,p=t.viewState.rotation,g=t.size;p&&(i=Math.round(f*g[0]/2),a=Math.round(f*g[1]/2),m.default.rotateAtOffset(e,-p,i,a)),l&&this.declutterTree_.clear();for(var h=this.renderedTiles,y=d.getTileGridForProjection(t.viewState.projection),c=[],R=[],T=h.length-1;T>=0;--T){var C=h[T];if(C.getState()!=o.default.ABORT)for(var E=C.tileCoord,S=y.getTileCoordExtent(E)[0]-y.getTileCoordExtent(C.wrappedTileCoord)[0],_=void 0,j=0,x=C.tileKeys.length;j<x;++j){var O=C.getTile(C.tileKeys[j]);if(O.getState()!=o.default.ERROR){var A=O.getReplayGroup(n,E.toString());if(s==v.default.VECTOR||A.hasReplays(u)){_||(_=this.getTransform(t,S));var I=O.tileCoord[0],q=A.getClipCoords(_);e.save(),e.globalAlpha=r.opacity;for(var G=0,w=c.length;G<w;++G){var P=c[G];I<R[G]&&(e.beginPath(),e.moveTo(q[0],q[1]),e.lineTo(q[2],q[3]),e.lineTo(q[4],q[5]),e.lineTo(q[6],q[7]),e.moveTo(P[6],P[7]),e.lineTo(P[4],P[5]),e.lineTo(P[2],P[3]),e.lineTo(P[0],P[1]),e.clip())}A.replay(e,_,p,{},u,l),e.restore(),c.push(q),R.push(I)}}}}l&&L.default.replayDeclutter(l,e,p),p&&m.default.rotateAtOffset(e,p,i,a),F.default.prototype.postCompose.apply(this,arguments)},D.prototype.renderFeature=function(e,t,r,i){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var o=0,n=r.length;o<n;++o)a=P.default.renderFeature(i,e,r[o],t,this.handleStyleImageChange_,this)||a;else a=P.default.renderFeature(i,e,r,t,this.handleStyleImageChange_,this);return a},D.prototype.renderTileImage_=function(e,t,r){var i=this.getLayer(),a=e.getReplayState(i),n=i.getRevision(),l=D.IMAGE_REPLAYS[i.getRenderMode()];if(l&&a.renderedTileRevision!==n){a.renderedTileRevision=n;var d=e.wrappedTileCoord,s=d[0],u=t.pixelRatio,f=i.getSource(),p=f.getTileGridForProjection(t.viewState.projection),g=p.getResolution(s),h=e.getContext(i),y=f.getTilePixelSize(s,u,t.viewState.projection);h.canvas.width=y[0],h.canvas.height=y[1];for(var c=p.getTileCoordExtent(d),v=0,R=e.tileKeys.length;v<R;++v){var T=e.getTile(e.tileKeys[v]);if(T.getState()!=o.default.ERROR){var C=u/g,E=b.default.reset(this.tmpTransform_);b.default.scale(E,C,-C),b.default.translate(E,-c[0],-c[3]),T.getReplayGroup(i,e.tileCoord.toString()).replay(h,E,0,{},l)}}}},exports.default=D;
},{"../../index.js":42,"../../layertype.js":177,"../../tilestate.js":179,"../../dom.js":134,"../../events.js":135,"../../events/eventtype.js":153,"rbush":209,"../../extent.js":76,"../../layer/vectortilerendertype.js":187,"../../proj.js":34,"../../proj/units.js":88,"../../render/replaytype.js":188,"../../render/canvas.js":184,"../../render/canvas/replaygroup.js":198,"../../render/replay.js":189,"../type.js":155,"../canvas/tilelayer.js":106,"../vector.js":185,"../../transform.js":139}],267:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../functions.js"),t=o(e);function o(e){return e&&e.__esModule?e:{default:e}}var r=function(e){this.source_=e};r.prototype.getType=function(){},r.prototype.getSource=function(){return this.source_},r.prototype.isAnimated=t.default.FALSE,exports.default=r;
},{"../functions.js":136}],244:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=s(e),r=require("../webgl.js"),u=s(r),l=require("../webgl/shader.js"),i=s(l);function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e){i.default.call(this,e)};t.default.inherits(a,i.default),a.prototype.getType=function(){return u.default.FRAGMENT_SHADER},exports.default=a;
},{"../index.js":42,"../webgl.js":180,"../webgl/shader.js":267}],245:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=s(e),r=require("../webgl.js"),u=s(r),l=require("../webgl/shader.js"),i=s(l);function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e){i.default.call(this,e)};t.default.inherits(a,i.default),a.prototype.getType=function(){return u.default.VERTEX_SHADER},exports.default=a;
},{"../index.js":42,"../webgl.js":180,"../webgl/shader.js":267}],274:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var i=require("../../../index.js"),e=r(i),t=require("../../../webgl/fragment.js"),o=r(t),n=require("../../../webgl/vertex.js"),a=r(n);function r(i){return i&&i.__esModule?i:{default:i}}var l={};l.fragment=new o.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),l.vertex=new a.default(e.default.DEBUG_WEBGL?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}"),exports.default=l;
},{"../../../index.js":42,"../../../webgl/fragment.js":244,"../../../webgl/vertex.js":245}],275:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../index.js"),i=o(t);function o(t){return t&&t.__esModule?t:{default:t}}var e=function(t,o){this.u_projectionMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_pixelRatio=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_pixelRatio":"l"),this.u_opacity=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_opacity":"m"),this.u_fillColor=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_fillColor":"n"),this.u_strokeColor=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_strokeColor":"o"),this.u_size=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_size":"p"),this.a_position=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_position":"e"),this.a_instruction=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_instruction":"f"),this.a_radius=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_radius":"g")};exports.default=e;
},{"../../../../index.js":42}],229:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={create:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},fromTransform:function(e,r){return e[0]=r[0],e[1]=r[1],e[4]=r[2],e[5]=r[3],e[12]=r[4],e[13]=r[5],e}};exports.default=e;
},{}],273:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=d(t),r=require("../../extent.js"),i=d(r),a=require("../vectorcontext.js"),n=d(a),s=require("../../transform.js"),o=d(s),l=require("../../vec/mat4.js"),f=d(l),u=require("../../webgl.js"),c=d(u);function d(t){return t&&t.__esModule?t:{default:t}}var p=function(t,e){n.default.call(this),this.tolerance=t,this.maxExtent=e,this.origin=i.default.getCenter(e),this.projectionMatrix_=o.default.create(),this.offsetRotateMatrix_=o.default.create(),this.offsetScaleMatrix_=o.default.create(),this.tmpMat4_=f.default.create(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0};e.default.inherits(p,n.default),p.prototype.getDeleteResourcesFunction=function(t){},p.prototype.finish=function(t){},p.prototype.setUpProgram=function(t,e,r,i){},p.prototype.shutDownProgram=function(t,e){},p.prototype.drawReplay=function(t,e,r,i){},p.prototype.drawHitDetectionReplayOneByOne=function(t,e,r,i,a){},p.prototype.drawHitDetectionReplay=function(t,e,r,i,a,n){return a?this.drawHitDetectionReplayOneByOne(t,e,r,i,n):this.drawHitDetectionReplayAll(t,e,r,i)},p.prototype.drawHitDetectionReplayAll=function(t,e,r,i){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,r,!0);var a=i(null);return a||void 0},p.prototype.replay=function(t,e,r,i,a,n,s,l,u,d,p){var E,_,h,S,T,R,m,y,I=t.getGL();this.lineStringReplay&&(E=I.isEnabled(I.STENCIL_TEST),_=I.getParameter(I.STENCIL_FUNC),h=I.getParameter(I.STENCIL_VALUE_MASK),S=I.getParameter(I.STENCIL_REF),T=I.getParameter(I.STENCIL_WRITEMASK),R=I.getParameter(I.STENCIL_FAIL),m=I.getParameter(I.STENCIL_PASS_DEPTH_PASS),y=I.getParameter(I.STENCIL_PASS_DEPTH_FAIL),I.enable(I.STENCIL_TEST),I.clear(I.STENCIL_BUFFER_BIT),I.stencilMask(255),I.stencilFunc(I.ALWAYS,1,255),I.stencilOp(I.KEEP,I.KEEP,I.REPLACE),this.lineStringReplay.replay(t,e,r,i,a,n,s,l,u,d,p),I.stencilMask(0),I.stencilFunc(I.NOTEQUAL,1,255)),t.bindBuffer(c.default.ARRAY_BUFFER,this.verticesBuffer),t.bindBuffer(c.default.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var M=this.setUpProgram(I,t,a,n),g=o.default.reset(this.projectionMatrix_);o.default.scale(g,2/(r*a[0]),2/(r*a[1])),o.default.rotate(g,-i),o.default.translate(g,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var L=o.default.reset(this.offsetScaleMatrix_);o.default.scale(L,2/a[0],2/a[1]);var x,F=o.default.reset(this.offsetRotateMatrix_);return 0!==i&&o.default.rotate(F,-i),I.uniformMatrix4fv(M.u_projectionMatrix,!1,f.default.fromTransform(this.tmpMat4_,g)),I.uniformMatrix4fv(M.u_offsetScaleMatrix,!1,f.default.fromTransform(this.tmpMat4_,L)),I.uniformMatrix4fv(M.u_offsetRotateMatrix,!1,f.default.fromTransform(this.tmpMat4_,F)),I.uniform1f(M.u_opacity,s),void 0===u?this.drawReplay(I,t,l,!1):x=this.drawHitDetectionReplay(I,t,l,u,d,p),this.shutDownProgram(I,M),this.lineStringReplay&&(E||I.disable(I.STENCIL_TEST),I.clear(I.STENCIL_BUFFER_BIT),I.stencilFunc(_,S,h),I.stencilMask(T),I.stencilOp(R,y,m)),x},p.prototype.drawElements=function(t,e,r,i){var a=e.hasOESElementIndexUint?c.default.UNSIGNED_INT:c.default.UNSIGNED_SHORT,n=i-r,s=r*(e.hasOESElementIndexUint?4:2);t.drawElements(c.default.TRIANGLES,n,a,s)},exports.default=p;
},{"../../index.js":42,"../../extent.js":76,"../vectorcontext.js":233,"../../transform.js":139,"../../vec/mat4.js":229,"../../webgl.js":180}],272:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={defaultFont:"10px sans-serif",defaultFillStyle:[0,0,0,1],defaultLineCap:"round",defaultLineDash:[],defaultLineDashOffset:0,defaultLineJoin:"round",defaultMiterLimit:10,defaultStrokeStyle:[0,0,0,1],defaultTextAlign:.5,defaultTextBaseline:.5,defaultLineWidth:1,triangleIsCounterClockwise:function(t,l,a,u,i,d){var n=(a-t)*(d-l)-(i-t)*(u-l);return n<=e.EPSILON&&n>=-e.EPSILON?void 0:n>0}};e.EPSILON=Number.EPSILON||2.220446049250313e-16,exports.default=e;
},{}],197:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../webgl.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t){this.arr_=void 0!==e?e:[],this.usage_=void 0!==t?t:u.Usage_.STATIC_DRAW};u.prototype.getArray=function(){return this.arr_},u.prototype.getUsage=function(){return this.usage_},u.Usage_={STATIC_DRAW:t.default.STATIC_DRAW,STREAM_DRAW:t.default.STREAM_DRAW,DYNAMIC_DRAW:t.default.DYNAMIC_DRAW},exports.default=u;
},{"../webgl.js":180}],246:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=w(t),s=require("../../array.js"),i=w(s),r=require("../../color.js"),a=w(r),l=require("../../extent.js"),n=w(l),h=require("../../obj.js"),o=w(h),d=require("../../geom/flat/transform.js"),u=w(d),f=require("../webgl/circlereplay/defaultshader.js"),c=w(f),_=require("../webgl/circlereplay/defaultshader/locations.js"),y=w(_),v=require("../webgl/replay.js"),g=w(v),p=require("../webgl.js"),I=w(p),S=require("../../webgl.js"),b=w(S),C=require("../../webgl/buffer.js"),m=w(C);function w(t){return t&&t.__esModule?t:{default:t}}var A=function(t,e){g.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};e.default.inherits(A,g.default),A.prototype.drawCoordinates_=function(t,e,s,i){var r,a,l=this.vertices.length,n=this.indices.length,h=l/4;for(r=e,a=s;r<a;r+=i)this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=0,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=1,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=2,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=3,this.vertices[l++]=this.radius_,this.indices[n++]=h,this.indices[n++]=h+1,this.indices[n++]=h+2,this.indices[n++]=h+2,this.indices[n++]=h+3,this.indices[n++]=h,h+=4},A.prototype.drawCircle=function(t,e){var s=t.getRadius(),i=t.getStride();if(s){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=s;var r=t.getFlatCoordinates();r=u.default.translate(r,0,2,i,-this.origin[0],-this.origin[1]),this.drawCoordinates_(r,0,2,i)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var a=this.styles_[this.styles_.length-1];this.state_.fillColor=a[0],this.state_.strokeColor=a[1],this.state_.lineWidth=a[2],this.state_.changed=!1}},A.prototype.finish=function(t){this.verticesBuffer=new m.default(this.vertices),this.indicesBuffer=new m.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},A.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,s=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(s)}},A.prototype.setUpProgram=function(t,e,s,i){var r,a;r=c.default.fragment,a=c.default.vertex;var l,n=e.getProgram(r,a);return this.defaultLocations_?l=this.defaultLocations_:(l=new y.default(t,n),this.defaultLocations_=l),e.useProgram(n),t.enableVertexAttribArray(l.a_position),t.vertexAttribPointer(l.a_position,2,b.default.FLOAT,!1,16,0),t.enableVertexAttribArray(l.a_instruction),t.vertexAttribPointer(l.a_instruction,1,b.default.FLOAT,!1,16,8),t.enableVertexAttribArray(l.a_radius),t.vertexAttribPointer(l.a_radius,1,b.default.FLOAT,!1,16,12),t.uniform2fv(l.u_size,s),t.uniform1f(l.u_pixelRatio,i),l},A.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},A.prototype.drawReplay=function(t,e,s,i){var r,a,l,n;if(o.default.isEmpty(s))for(l=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)a=this.styleIndices_[r],n=this.styles_[r],this.setFillStyle_(t,n[0]),this.setStrokeStyle_(t,n[1],n[2]),this.drawElements(t,e,a,l),l=a;else this.drawReplaySkipping_(t,e,s)},A.prototype.drawHitDetectionReplayOneByOne=function(t,s,i,r,a){var l,h,o,d,u,f,c;for(c=this.startIndices.length-2,o=this.startIndices[c+1],l=this.styleIndices_.length-1;l>=0;--l)for(d=this.styles_[l],this.setFillStyle_(t,d[0]),this.setStrokeStyle_(t,d[1],d[2]),u=this.styleIndices_[l];c>=0&&this.startIndices[c]>=u;){if(h=this.startIndices[c],f=this.startIndicesFeature[c],void 0===i[e.default.getUid(f).toString()]&&f.getGeometry()&&(void 0===a||n.default.intersects(a,f.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,s,h,o);var _=r(f);if(_)return _}c--,o=h}},A.prototype.drawReplaySkipping_=function(t,s,i){var r,a,l,n,h,o,d,u;for(d=this.startIndices.length-2,l=a=this.startIndices[d+1],r=this.styleIndices_.length-1;r>=0;--r){for(n=this.styles_[r],this.setFillStyle_(t,n[0]),this.setStrokeStyle_(t,n[1],n[2]),h=this.styleIndices_[r];d>=0&&this.startIndices[d]>=h;)u=this.startIndices[d],o=this.startIndicesFeature[d],i[e.default.getUid(o).toString()]&&(a!==l&&this.drawElements(t,s,a,l),l=u),d--,a=u;a!==l&&this.drawElements(t,s,a,l),a=l=h}},A.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},A.prototype.setStrokeStyle_=function(t,e,s){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,s)},A.prototype.setFillStrokeStyle=function(t,e){var s,r;if(e){var l=e.getLineDash();this.state_.lineDash=l||I.default.defaultLineDash;var n=e.getLineDashOffset();this.state_.lineDashOffset=n||I.default.defaultLineDashOffset,s=(s=e.getColor())instanceof CanvasGradient||s instanceof CanvasPattern?I.default.defaultStrokeStyle:a.default.asArray(s).map(function(t,e){return 3!=e?t/255:t})||I.default.defaultStrokeStyle,r=void 0!==(r=e.getWidth())?r:I.default.defaultLineWidth}else s=[0,0,0,0],r=0;var h=t?t.getColor():[0,0,0,0];h=h instanceof CanvasGradient||h instanceof CanvasPattern?I.default.defaultFillStyle:a.default.asArray(h).map(function(t,e){return 3!=e?t/255:t})||I.default.defaultFillStyle,this.state_.strokeColor&&i.default.equals(this.state_.strokeColor,s)&&this.state_.fillColor&&i.default.equals(this.state_.fillColor,h)&&this.state_.lineWidth===r||(this.state_.changed=!0,this.state_.fillColor=h,this.state_.strokeColor=s,this.state_.lineWidth=r,this.styles_.push([h,s,r]))},exports.default=A;
},{"../../index.js":42,"../../array.js":68,"../../color.js":259,"../../extent.js":76,"../../obj.js":52,"../../geom/flat/transform.js":175,"../webgl/circlereplay/defaultshader.js":274,"../webgl/circlereplay/defaultshader/locations.js":275,"../webgl/replay.js":273,"../webgl.js":272,"../../webgl.js":180,"../../webgl/buffer.js":197}],294:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../index.js"),a=n(t),e=require("../../../webgl/fragment.js"),o=n(e),i=require("../../../webgl/vertex.js"),r=n(i);function n(t){return t&&t.__esModule?t:{default:t}}var f={};f.fragment=new o.default(a.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),f.vertex=new r.default(a.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}"),exports.default=f;
},{"../../../index.js":42,"../../../webgl/fragment.js":244,"../../../webgl/vertex.js":245}],295:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../index.js"),e=i(t);function i(t){return t&&t.__esModule?t:{default:t}}var o=function(t,i){this.u_projectionMatrix=t.getUniformLocation(i,e.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(i,e.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(i,e.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_opacity=t.getUniformLocation(i,e.default.DEBUG_WEBGL?"u_opacity":"k"),this.u_image=t.getUniformLocation(i,e.default.DEBUG_WEBGL?"u_image":"l"),this.a_position=t.getAttribLocation(i,e.default.DEBUG_WEBGL?"a_position":"c"),this.a_texCoord=t.getAttribLocation(i,e.default.DEBUG_WEBGL?"a_texCoord":"d"),this.a_offsets=t.getAttribLocation(i,e.default.DEBUG_WEBGL?"a_offsets":"e"),this.a_opacity=t.getAttribLocation(i,e.default.DEBUG_WEBGL?"a_opacity":"f"),this.a_rotateWithView=t.getAttribLocation(i,e.default.DEBUG_WEBGL?"a_rotateWithView":"g")};exports.default=o;
},{"../../../../index.js":42}],196:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};exports.default=e;
},{}],190:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=_(e),r=require("../disposable.js"),i=_(r),a=require("../array.js"),n=_(a),u=require("../events.js"),f=_(u),h=require("../obj.js"),s=_(h),o=require("../webgl.js"),d=_(o),c=require("../webgl/contexteventtype.js"),l=_(c);function _(e){return e&&e.__esModule?e:{default:e}}var E=function(e,r){this.canvas_=e,this.gl_=r,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=n.default.includes(t.default.WEBGL_EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&r.getExtension("OES_element_index_uint"),f.default.listen(this.canvas_,l.default.LOST,this.handleWebGLContextLost,this),f.default.listen(this.canvas_,l.default.RESTORED,this.handleWebGLContextRestored,this)};t.default.inherits(E,i.default),E.prototype.bindBuffer=function(e,r){var i=this.getGL(),a=r.getArray(),n=String(t.default.getUid(r));if(n in this.bufferCache_){var u=this.bufferCache_[n];i.bindBuffer(e,u.buffer)}else{var f,h=i.createBuffer();i.bindBuffer(e,h),e==d.default.ARRAY_BUFFER?f=new Float32Array(a):e==d.default.ELEMENT_ARRAY_BUFFER&&(f=this.hasOESElementIndexUint?new Uint32Array(a):new Uint16Array(a)),i.bufferData(e,f,r.getUsage()),this.bufferCache_[n]={buf:r,buffer:h}}},E.prototype.deleteBuffer=function(e){var r=this.getGL(),i=String(t.default.getUid(e)),a=this.bufferCache_[i];r.isContextLost()||r.deleteBuffer(a.buffer),delete this.bufferCache_[i]},E.prototype.disposeInternal=function(){f.default.unlistenAll(this.canvas_);var e=this.getGL();if(!e.isContextLost()){var t;for(t in this.bufferCache_)e.deleteBuffer(this.bufferCache_[t].buffer);for(t in this.programCache_)e.deleteProgram(this.programCache_[t]);for(t in this.shaderCache_)e.deleteShader(this.shaderCache_[t]);e.deleteFramebuffer(this.hitDetectionFramebuffer_),e.deleteRenderbuffer(this.hitDetectionRenderbuffer_),e.deleteTexture(this.hitDetectionTexture_)}},E.prototype.getCanvas=function(){return this.canvas_},E.prototype.getGL=function(){return this.gl_},E.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},E.prototype.getShader=function(e){var r=String(t.default.getUid(e));if(r in this.shaderCache_)return this.shaderCache_[r];var i=this.getGL(),a=i.createShader(e.getType());return i.shaderSource(a,e.getSource()),i.compileShader(a),this.shaderCache_[r]=a,a},E.prototype.getProgram=function(e,r){var i=t.default.getUid(e)+"/"+t.default.getUid(r);if(i in this.programCache_)return this.programCache_[i];var a=this.getGL(),n=a.createProgram();return a.attachShader(n,this.getShader(e)),a.attachShader(n,this.getShader(r)),a.linkProgram(n),this.programCache_[i]=n,n},E.prototype.handleWebGLContextLost=function(){s.default.clear(this.bufferCache_),s.default.clear(this.shaderCache_),s.default.clear(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},E.prototype.handleWebGLContextRestored=function(){},E.prototype.initHitDetectionFramebuffer_=function(){var e=this.gl_,t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);var r=E.createEmptyTexture(e,1,1),i=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,1,1),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,i),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=t,this.hitDetectionTexture_=r,this.hitDetectionRenderbuffer_=i},E.prototype.useProgram=function(e){return e!=this.currentProgram_&&(this.getGL().useProgram(e),this.currentProgram_=e,!0)},E.createTexture_=function(e,t,r){var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),void 0!==t&&e.texParameteri(d.default.TEXTURE_2D,d.default.TEXTURE_WRAP_S,t),void 0!==r&&e.texParameteri(d.default.TEXTURE_2D,d.default.TEXTURE_WRAP_T,r),i},E.createEmptyTexture=function(e,t,r,i,a){var n=E.createTexture_(e,i,a);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),n},E.createTexture=function(e,t,r,i){var a=E.createTexture_(e,r,i);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),a},exports.default=E;
},{"../index.js":42,"../disposable.js":225,"../array.js":68,"../events.js":135,"../obj.js":52,"../webgl.js":180,"../webgl/contexteventtype.js":196}],277:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=p(t),i=require("../../extent.js"),r=p(i),s=require("../../obj.js"),o=p(s),h=require("../webgl/texturereplay/defaultshader.js"),a=p(h),n=require("../webgl/texturereplay/defaultshader/locations.js"),d=p(n),c=require("../webgl/replay.js"),u=p(c),l=require("../../webgl.js"),v=p(l),f=require("../../webgl/context.js"),g=p(f);function p(t){return t&&t.__esModule?t:{default:t}}var x=function(t,e){u.default.call(this,t,e),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0};e.default.inherits(x,u.default),x.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,r=this.getTextures(!0),s=t.getGL();return function(){var o,h;if(!s.isContextLost())for(o=0,h=r.length;o<h;++o)s.deleteTexture(r[o]);t.deleteBuffer(e),t.deleteBuffer(i)}},x.prototype.drawCoordinates=function(t,e,i,r){var s,o,h,a,n,d,c=this.anchorX,u=this.anchorY,l=this.height,v=this.imageHeight,f=this.imageWidth,g=this.opacity,p=this.originX,x=this.originY,y=this.rotateWithView?1:0,b=-this.rotation,A=this.scale,_=this.width,T=Math.cos(b),w=Math.sin(b),E=this.indices.length,I=this.vertices.length;for(s=e;s<i;s+=r)n=t[s]-this.origin[0],d=t[s+1]-this.origin[1],o=I/8,h=-A*c,a=-A*(l-u),this.vertices[I++]=n,this.vertices[I++]=d,this.vertices[I++]=h*T-a*w,this.vertices[I++]=h*w+a*T,this.vertices[I++]=p/f,this.vertices[I++]=(x+l)/v,this.vertices[I++]=g,this.vertices[I++]=y,h=A*(_-c),a=-A*(l-u),this.vertices[I++]=n,this.vertices[I++]=d,this.vertices[I++]=h*T-a*w,this.vertices[I++]=h*w+a*T,this.vertices[I++]=(p+_)/f,this.vertices[I++]=(x+l)/v,this.vertices[I++]=g,this.vertices[I++]=y,h=A*(_-c),a=A*u,this.vertices[I++]=n,this.vertices[I++]=d,this.vertices[I++]=h*T-a*w,this.vertices[I++]=h*w+a*T,this.vertices[I++]=(p+_)/f,this.vertices[I++]=x/v,this.vertices[I++]=g,this.vertices[I++]=y,h=-A*c,a=A*u,this.vertices[I++]=n,this.vertices[I++]=d,this.vertices[I++]=h*T-a*w,this.vertices[I++]=h*w+a*T,this.vertices[I++]=p/f,this.vertices[I++]=x/v,this.vertices[I++]=g,this.vertices[I++]=y,this.indices[E++]=o,this.indices[E++]=o+1,this.indices[E++]=o+2,this.indices[E++]=o,this.indices[E++]=o+2,this.indices[E++]=o+3;return I},x.prototype.createTextures=function(t,i,r,s){var o,h,a,n,d=i.length;for(n=0;n<d;++n)h=i[n],(a=e.default.getUid(h).toString())in r?o=r[a]:(o=g.default.createTexture(s,h,v.default.CLAMP_TO_EDGE,v.default.CLAMP_TO_EDGE),r[a]=o),t[n]=o},x.prototype.setUpProgram=function(t,e,i,r){var s,o=a.default.fragment,h=a.default.vertex,n=e.getProgram(o,h);return this.defaultLocations?s=this.defaultLocations:(s=new d.default(t,n),this.defaultLocations=s),e.useProgram(n),t.enableVertexAttribArray(s.a_position),t.vertexAttribPointer(s.a_position,2,v.default.FLOAT,!1,32,0),t.enableVertexAttribArray(s.a_offsets),t.vertexAttribPointer(s.a_offsets,2,v.default.FLOAT,!1,32,8),t.enableVertexAttribArray(s.a_texCoord),t.vertexAttribPointer(s.a_texCoord,2,v.default.FLOAT,!1,32,16),t.enableVertexAttribArray(s.a_opacity),t.vertexAttribPointer(s.a_opacity,1,v.default.FLOAT,!1,32,24),t.enableVertexAttribArray(s.a_rotateWithView),t.vertexAttribPointer(s.a_rotateWithView,1,v.default.FLOAT,!1,32,28),s},x.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},x.prototype.drawReplay=function(t,e,i,r){var s,h,a,n=r?this.getHitDetectionTextures():this.getTextures(),d=r?this.hitDetectionGroupIndices:this.groupIndices;if(o.default.isEmpty(i))for(s=0,h=n.length,a=0;s<h;++s){t.bindTexture(v.default.TEXTURE_2D,n[s]);var c=d[s];this.drawElements(t,e,a,c),a=c}else this.drawReplaySkipping(t,e,i,n,d)},x.prototype.drawReplaySkipping=function(t,i,r,s,o){var h,a,n=0;for(h=0,a=s.length;h<a;++h){t.bindTexture(v.default.TEXTURE_2D,s[h]);for(var d=h>0?o[h-1]:0,c=o[h],u=d,l=d;n<this.startIndices.length&&this.startIndices[n]<=c;){var f=this.startIndicesFeature[n];void 0!==r[e.default.getUid(f).toString()]?(u!==l&&this.drawElements(t,i,u,l),l=u=n===this.startIndices.length-1?c:this.startIndices[n+1]):l=n===this.startIndices.length-1?c:this.startIndices[n+1],n++}u!==l&&this.drawElements(t,i,u,l)}},x.prototype.drawHitDetectionReplayOneByOne=function(t,i,s,o,h){var a,n,d,c,u,l=this.startIndices.length-1,f=this.getHitDetectionTextures();for(a=f.length-1;a>=0;--a)for(t.bindTexture(v.default.TEXTURE_2D,f[a]),n=a>0?this.hitDetectionGroupIndices[a-1]:0,c=this.hitDetectionGroupIndices[a];l>=0&&this.startIndices[l]>=n;){if(d=this.startIndices[l],u=this.startIndicesFeature[l],void 0===s[e.default.getUid(u).toString()]&&u.getGeometry()&&(void 0===h||r.default.intersects(h,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,i,d,c);var g=o(u);if(g)return g}c=d,l--}},x.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},x.prototype.getTextures=function(t){},x.prototype.getHitDetectionTextures=function(){},exports.default=x;
},{"../../index.js":42,"../../extent.js":76,"../../obj.js":52,"../webgl/texturereplay/defaultshader.js":294,"../webgl/texturereplay/defaultshader/locations.js":295,"../webgl/replay.js":273,"../../webgl.js":180,"../../webgl/context.js":190}],247:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=r(t),i=require("../webgl/texturereplay.js"),s=r(i),h=require("../../webgl/buffer.js"),n=r(h);function r(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){s.default.call(this,t,e),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]};e.default.inherits(a,s.default),a.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),s=t.getStride();this.drawCoordinates(i,0,i.length,s)},a.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),s=t.getStride();this.drawCoordinates(i,0,i.length,s)},a.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new n.default(this.vertices);var i=this.indices;this.indicesBuffer=new n.default(i);var h={};this.createTextures(this.textures_,this.images_,h,e),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,h,e),this.images_=null,this.hitDetectionImages_=null,s.default.prototype.finish.call(this,t)},a.prototype.setImageStyle=function(t){var i,s=t.getAnchor(),h=t.getImage(1),n=t.getImageSize(),r=t.getHitDetectionImage(1),a=t.getOpacity(),o=t.getOrigin(),u=t.getRotateWithView(),g=t.getRotation(),c=t.getSize(),d=t.getScale();0===this.images_.length?this.images_.push(h):(i=this.images_[this.images_.length-1],e.default.getUid(i)!=e.default.getUid(h)&&(this.groupIndices.push(this.indices.length),this.images_.push(h))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(r):(i=this.hitDetectionImages_[this.hitDetectionImages_.length-1],e.default.getUid(i)!=e.default.getUid(r)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(r))),this.anchorX=s[0],this.anchorY=s[1],this.height=c[1],this.imageHeight=n[1],this.imageWidth=n[0],this.opacity=a,this.originX=o[0],this.originY=o[1],this.rotation=g,this.rotateWithView=u,this.scale=d,this.width=c[0]},a.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},a.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},exports.default=a;
},{"../../index.js":42,"../webgl/texturereplay.js":277,"../../webgl/buffer.js":197}],284:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../flat/area.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var u={lineStringIsClosed:function(e,t,u,a){var n=u-a;return e[t]===e[n]&&e[t+1]===e[n+1]&&(u-t)/a>3&&!!r.default.linearRing(e,t,u,a)}};exports.default=u;
},{"../flat/area.js":166}],285:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../index.js"),o=a(e),t=require("../../../webgl/fragment.js"),n=a(t),r=require("../../../webgl/vertex.js"),i=a(r);function a(e){return e&&e.__esModule?e:{default:e}}var l={};l.fragment=new n.default(o.default.DEBUG_WEBGL?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),l.vertex=new i.default(o.default.DEBUG_WEBGL?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}"),exports.default=l;
},{"../../../index.js":42,"../../../webgl/fragment.js":244,"../../../webgl/vertex.js":245}],286:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../index.js"),i=o(t);function o(t){return t&&t.__esModule?t:{default:t}}var e=function(t,o){this.u_projectionMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_miterLimit=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_miterLimit":"l"),this.u_opacity=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_opacity":"m"),this.u_color=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_color":"n"),this.u_size=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_size":"o"),this.u_pixelRatio=t.getUniformLocation(o,i.default.DEBUG_WEBGL?"u_pixelRatio":"p"),this.a_lastPos=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_lastPos":"d"),this.a_position=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_position":"e"),this.a_nextPos=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_nextPos":"f"),this.a_direction=t.getAttribLocation(o,i.default.DEBUG_WEBGL?"a_direction":"g")};exports.default=e;
},{"../../../../index.js":42}],248:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=A(t),i=require("../../array.js"),s=A(i),n=require("../../color.js"),r=A(n),a=require("../../extent.js"),d=A(a),h=require("../../geom/flat/orient.js"),l=A(h),o=require("../../geom/flat/transform.js"),c=A(o),u=require("../../geom/flat/topology.js"),_=A(u),f=require("../../obj.js"),g=A(f),I=require("../webgl.js"),p=A(I),y=require("../webgl/replay.js"),E=A(y),v=require("../webgl/linestringreplay/defaultshader.js"),L=A(v),T=require("../webgl/linestringreplay/defaultshader/locations.js"),C=A(T),P=require("../../webgl.js"),b=A(P),m=require("../../webgl/buffer.js"),S=A(m);function A(t){return t&&t.__esModule?t:{default:t}}var B=function(t,e){E.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};e.default.inherits(B,E.default),B.prototype.drawCoordinates_=function(t,e,i,n){var r,a,d,h,o,c,u,f,g=this.vertices.length,I=this.indices.length,y="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,E="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,v=_.default.lineStringIsClosed(t,e,i,n),L=I,T=1;for(r=e,a=i;r<a;r+=n){if(o=g/7,c=u,u=f||[t[r],t[r+1]],r===e){if(f=[t[r+n],t[r+n+1]],i-e==2*n&&s.default.equals(u,f))break;if(!v){E&&(g=this.addVertices_([0,0],u,f,T*B.Instruction_.BEGIN_LINE_CAP*E,g),g=this.addVertices_([0,0],u,f,-T*B.Instruction_.BEGIN_LINE_CAP*E,g),this.indices[I++]=o+2,this.indices[I++]=o,this.indices[I++]=o+1,this.indices[I++]=o+1,this.indices[I++]=o+3,this.indices[I++]=o+2),g=this.addVertices_([0,0],u,f,T*B.Instruction_.BEGIN_LINE*(E||1),g),L=(g=this.addVertices_([0,0],u,f,-T*B.Instruction_.BEGIN_LINE*(E||1),g))/7-1;continue}c=[t[i-2*n],t[i-2*n+1]],d=f}else{if(r===i-n){if(v){f=d;break}c=c||[0,0],g=this.addVertices_(c,u,[0,0],T*B.Instruction_.END_LINE*(E||1),g),g=this.addVertices_(c,u,[0,0],-T*B.Instruction_.END_LINE*(E||1),g),this.indices[I++]=o,this.indices[I++]=L-1,this.indices[I++]=L,this.indices[I++]=L,this.indices[I++]=o+1,this.indices[I++]=o,E&&(g=this.addVertices_(c,u,[0,0],T*B.Instruction_.END_LINE_CAP*E,g),g=this.addVertices_(c,u,[0,0],-T*B.Instruction_.END_LINE_CAP*E,g),this.indices[I++]=o+2,this.indices[I++]=o,this.indices[I++]=o+1,this.indices[I++]=o+1,this.indices[I++]=o+3,this.indices[I++]=o+2);break}f=[t[r+n],t[r+n+1]]}h=p.default.triangleIsCounterClockwise(c[0],c[1],u[0],u[1],f[0],f[1])?-1:1,g=this.addVertices_(c,u,f,h*B.Instruction_.BEVEL_FIRST*(y||1),g),g=this.addVertices_(c,u,f,h*B.Instruction_.BEVEL_SECOND*(y||1),g),g=this.addVertices_(c,u,f,-h*B.Instruction_.MITER_BOTTOM*(y||1),g),r>e&&(this.indices[I++]=o,this.indices[I++]=L-1,this.indices[I++]=L,this.indices[I++]=o+2,this.indices[I++]=o,this.indices[I++]=T*h>0?L:L-1),this.indices[I++]=o,this.indices[I++]=o+2,this.indices[I++]=o+1,L=o+2,T=h,y&&(g=this.addVertices_(c,u,f,h*B.Instruction_.MITER_TOP*y,g),this.indices[I++]=o+1,this.indices[I++]=o+3,this.indices[I++]=o)}v&&(o=o||g/7,h=l.default.linearRingIsClockwise([c[0],c[1],u[0],u[1],f[0],f[1]],0,6,2)?1:-1,g=this.addVertices_(c,u,f,h*B.Instruction_.BEVEL_FIRST*(y||1),g),g=this.addVertices_(c,u,f,-h*B.Instruction_.MITER_BOTTOM*(y||1),g),this.indices[I++]=o,this.indices[I++]=L-1,this.indices[I++]=L,this.indices[I++]=o+1,this.indices[I++]=o,this.indices[I++]=T*h>0?L:L-1)},B.prototype.addVertices_=function(t,e,i,s,n){return this.vertices[n++]=t[0],this.vertices[n++]=t[1],this.vertices[n++]=e[0],this.vertices[n++]=e[1],this.vertices[n++]=i[0],this.vertices[n++]=i[1],this.vertices[n++]=s,n},B.prototype.isValid_=function(t,e,i,n){var r=i-e;if(r<2*n)return!1;if(r===2*n){var a=[t[e],t[e+1]],d=[t[e+n],t[e+n+1]];return!s.default.equals(a,d)}return!0},B.prototype.drawLineString=function(t,e){var i=t.getFlatCoordinates(),s=t.getStride();this.isValid_(i,0,i.length,s)&&(i=c.default.translate(i,0,i.length,s,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,s))},B.prototype.drawMultiLineString=function(t,e){var i=this.indices.length,s=t.getEnds();s.unshift(0);var n,r,a=t.getFlatCoordinates(),d=t.getStride();if(s.length>1)for(n=1,r=s.length;n<r;++n)if(this.isValid_(a,s[n-1],s[n],d)){var h=c.default.translate(a,s[n-1],s[n],d,-this.origin[0],-this.origin[1]);this.drawCoordinates_(h,0,h.length,d)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},B.prototype.drawPolygonCoordinates=function(t,e,i){var s,n;if(_.default.lineStringIsClosed(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length)for(s=0,n=e.length;s<n;++s)_.default.lineStringIsClosed(e[s],0,e[s].length,i)||(e[s].push(e[s][0]),e[s].push(e[s][1])),this.drawCoordinates_(e[s],0,e[s].length,i)},B.prototype.setPolygonStyle=function(t,e){var i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},B.prototype.getCurrentIndex=function(){return this.indices.length},B.prototype.finish=function(t){this.verticesBuffer=new S.default(this.vertices),this.indicesBuffer=new S.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},B.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},B.prototype.setUpProgram=function(t,e,i,s){var n,r;n=L.default.fragment,r=L.default.vertex;var a,d=e.getProgram(n,r);return this.defaultLocations_?a=this.defaultLocations_:(a=new C.default(t,d),this.defaultLocations_=a),e.useProgram(d),t.enableVertexAttribArray(a.a_lastPos),t.vertexAttribPointer(a.a_lastPos,2,b.default.FLOAT,!1,28,0),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,b.default.FLOAT,!1,28,8),t.enableVertexAttribArray(a.a_nextPos),t.vertexAttribPointer(a.a_nextPos,2,b.default.FLOAT,!1,28,16),t.enableVertexAttribArray(a.a_direction),t.vertexAttribPointer(a.a_direction,1,b.default.FLOAT,!1,28,24),t.uniform2fv(a.u_size,i),t.uniform1f(a.u_pixelRatio,s),a},B.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},B.prototype.drawReplay=function(t,e,i,s){var n,r,a,d,h=t.getParameter(t.DEPTH_FUNC),l=t.getParameter(t.DEPTH_WRITEMASK);if(s||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),g.default.isEmpty(i))for(a=this.startIndices[this.startIndices.length-1],n=this.styleIndices_.length-1;n>=0;--n)r=this.styleIndices_[n],d=this.styles_[n],this.setStrokeStyle_(t,d[0],d[1],d[2]),this.drawElements(t,e,r,a),t.clear(t.DEPTH_BUFFER_BIT),a=r;else this.drawReplaySkipping_(t,e,i);s||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(l),t.depthFunc(h))},B.prototype.drawReplaySkipping_=function(t,i,s){var n,r,a,d,h,l,o,c;for(o=this.startIndices.length-2,a=r=this.startIndices[o+1],n=this.styleIndices_.length-1;n>=0;--n){for(d=this.styles_[n],this.setStrokeStyle_(t,d[0],d[1],d[2]),h=this.styleIndices_[n];o>=0&&this.startIndices[o]>=h;)c=this.startIndices[o],l=this.startIndicesFeature[o],s[e.default.getUid(l).toString()]&&(r!==a&&(this.drawElements(t,i,r,a),t.clear(t.DEPTH_BUFFER_BIT)),a=c),o--,r=c;r!==a&&(this.drawElements(t,i,r,a),t.clear(t.DEPTH_BUFFER_BIT)),r=a=h}},B.prototype.drawHitDetectionReplayOneByOne=function(t,i,s,n,r){var a,h,l,o,c,u,_;for(_=this.startIndices.length-2,l=this.startIndices[_+1],a=this.styleIndices_.length-1;a>=0;--a)for(o=this.styles_[a],this.setStrokeStyle_(t,o[0],o[1],o[2]),c=this.styleIndices_[a];_>=0&&this.startIndices[_]>=c;){if(h=this.startIndices[_],u=this.startIndicesFeature[_],void 0===s[e.default.getUid(u).toString()]&&u.getGeometry()&&(void 0===r||d.default.intersects(r,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,i,h,l);var f=n(u);if(f)return f}_--,l=h}},B.prototype.setStrokeStyle_=function(t,e,i,s){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,s)},B.prototype.setFillStrokeStyle=function(t,e){var i=e.getLineCap();this.state_.lineCap=void 0!==i?i:p.default.defaultLineCap;var n=e.getLineDash();this.state_.lineDash=n||p.default.defaultLineDash;var a=e.getLineDashOffset();this.state_.lineDashOffset=a||p.default.defaultLineDashOffset;var d=e.getLineJoin();this.state_.lineJoin=void 0!==d?d:p.default.defaultLineJoin;var h=e.getColor();h=h instanceof CanvasGradient||h instanceof CanvasPattern?p.default.defaultStrokeStyle:r.default.asArray(h).map(function(t,e){return 3!=e?t/255:t})||p.default.defaultStrokeStyle;var l=e.getWidth();l=void 0!==l?l:p.default.defaultLineWidth;var o=e.getMiterLimit();o=void 0!==o?o:p.default.defaultMiterLimit,this.state_.strokeColor&&s.default.equals(this.state_.strokeColor,h)&&this.state_.lineWidth===l&&this.state_.miterLimit===o||(this.state_.changed=!0,this.state_.strokeColor=h,this.state_.lineWidth=l,this.state_.miterLimit=o,this.styles_.push([h,l,o]))},B.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23},exports.default=B;
},{"../../index.js":42,"../../array.js":68,"../../color.js":259,"../../extent.js":76,"../../geom/flat/orient.js":173,"../../geom/flat/transform.js":175,"../../geom/flat/topology.js":284,"../../obj.js":52,"../webgl.js":272,"../webgl/replay.js":273,"../webgl/linestringreplay/defaultshader.js":285,"../webgl/linestringreplay/defaultshader/locations.js":286,"../../webgl.js":180,"../../webgl/buffer.js":197}],290:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var a=require("../../../index.js"),o=t(a),n=require("../../../webgl/fragment.js"),e=t(n),i=require("../../../webgl/vertex.js"),r=t(i);function t(a){return a&&a.__esModule?a:{default:a}}var u={};u.fragment=new e.default(o.default.DEBUG_WEBGL?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),u.vertex=new r.default(o.default.DEBUG_WEBGL?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}"),exports.default=u;
},{"../../../index.js":42,"../../../webgl/fragment.js":244,"../../../webgl/vertex.js":245}],291:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../index.js"),o=e(t);function e(t){return t&&t.__esModule?t:{default:t}}var i=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,o.default.DEBUG_WEBGL?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=t.getUniformLocation(e,o.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=t.getUniformLocation(e,o.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"d"),this.u_color=t.getUniformLocation(e,o.default.DEBUG_WEBGL?"u_color":"e"),this.u_opacity=t.getUniformLocation(e,o.default.DEBUG_WEBGL?"u_opacity":"f"),this.a_position=t.getAttribLocation(e,o.default.DEBUG_WEBGL?"a_position":"a")};exports.default=i;
},{"../../../../index.js":42}],287:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=e(t);function e(t){return t&&t.__esModule?t:{default:t}}var s=function(t){var i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width,this.checksum_=void 0};s.prototype.clone=function(){var t=this.getColor();return new s({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},s.prototype.getColor=function(){return this.color_},s.prototype.getLineCap=function(){return this.lineCap_},s.prototype.getLineDash=function(){return this.lineDash_},s.prototype.getLineDashOffset=function(){return this.lineDashOffset_},s.prototype.getLineJoin=function(){return this.lineJoin_},s.prototype.getMiterLimit=function(){return this.miterLimit_},s.prototype.getWidth=function(){return this.width_},s.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},s.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},s.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},s.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},s.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},s.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},s.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},s.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=i.default.getUid(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},exports.default=s;
},{"../index.js":42}],288:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t){this.first_=void 0,this.last_=void 0,this.head_=void 0,this.circular_=void 0===t||t,this.length_=0};t.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},i=this.head_;if(i){var h=i.next;e.prev=i,e.next=h,i.next=e,h&&(h.prev=e),i===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},t.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),this.head_=e||i,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=i?this.head_.prev:this.head_),this.length_--}},t.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},t.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},t.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},t.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},t.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},t.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},t.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},t.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},t.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},t.prototype.getLength=function(){return this.length_},exports.default=t;
},{}],289:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=a(t),r=require("rbush"),i=a(r),n=require("../extent.js"),u=a(n),o=require("../obj.js"),s=a(o);function a(t){return t&&t.__esModule?t:{default:t}}var h=function(t){this.rbush_=(0,i.default)(t),this.items_={}};h.prototype.insert=function(t,r){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:r};this.rbush_.insert(i),this.items_[e.default.getUid(r)]=i},h.prototype.load=function(t,r){for(var i=new Array(r.length),n=0,u=r.length;n<u;n++){var o=t[n],s=r[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[e.default.getUid(s)]=a}this.rbush_.load(i)},h.prototype.remove=function(t){var r=e.default.getUid(t),i=this.items_[r];return delete this.items_[r],null!==this.rbush_.remove(i)},h.prototype.update=function(t,r){var i=this.items_[e.default.getUid(r)],n=[i.minX,i.minY,i.maxX,i.maxY];u.default.equals(n,t)||(this.remove(r),this.insert(t,r))},h.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},h.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},h.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},h.prototype.forEachInExtent=function(t,e,r){return this.forEach_(this.getInExtent(t),e,r)},h.prototype.forEach_=function(t,e,r){for(var i,n=0,u=t.length;n<u;n++)if(i=e.call(r,t[n]))return i;return i},h.prototype.isEmpty=function(){return s.default.isEmpty(this.items_)},h.prototype.clear=function(){this.rbush_.clear(),this.items_={}},h.prototype.getExtent=function(t){var e=this.rbush_.data;return u.default.createOrUpdate(e.minX,e.minY,e.maxX,e.maxY,t)},h.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[0|e]=t.items_[0|e]},exports.default=h;
},{"../index.js":42,"rbush":209,"../extent.js":76,"../obj.js":52}],249:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=L(t),i=require("../../array.js"),s=L(i),r=require("../../color.js"),n=L(r),a=require("../../extent.js"),l=L(a),o=require("../../obj.js"),h=L(o),p=require("../../geom/flat/contains.js"),y=L(p),x=require("../../geom/flat/orient.js"),u=L(x),d=require("../../geom/flat/transform.js"),f=L(d),c=require("../webgl/polygonreplay/defaultshader.js"),g=L(c),m=require("../webgl/polygonreplay/defaultshader/locations.js"),_=L(m),I=require("../webgl/linestringreplay.js"),v=L(I),M=require("../webgl/replay.js"),P=L(M),w=require("../webgl.js"),C=L(w),S=require("../../style/stroke.js"),F=L(S),E=require("../../structs/linkedlist.js"),b=L(E),R=require("../../structs/rbush.js"),T=L(R),k=require("../../webgl.js"),j=L(k),q=require("../../webgl/buffer.js"),B=L(q);function L(t){return t&&t.__esModule?t:{default:t}}var D=function(t,e){P.default.call(this,t,e),this.lineStringReplay=new v.default(t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}};e.default.inherits(D,P.default),D.prototype.drawCoordinates_=function(t,e,i){var s=new b.default,r=new T.default;this.processFlatCoordinates_(t,i,s,r,!0);var n=this.getMaxCoords_(s);if(e.length){var a,l,o=[];for(a=0,l=e.length;a<l;++a){var h={list:new b.default,maxCoords:void 0,rtree:new T.default};o.push(h),this.processFlatCoordinates_(e[a],i,h.list,h.rtree,!1),this.classifyPoints_(h.list,h.rtree,!0),h.maxCoords=this.getMaxCoords_(h.list)}for(o.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),a=0;a<o.length;++a){var p,y=o[a].list,x=y.firstItem(),u=x;do{if(this.getIntersections_(u,r).length){p=!0;break}u=y.nextItem()}while(x!==u);p||this.bridgeHole_(y,o[a].maxCoords[0],s,n[0],r)&&(r.concat(o[a].rtree),this.classifyPoints_(s,r,!1))}}else this.classifyPoints_(s,r,!1);this.triangulate_(s,r)},D.prototype.processFlatCoordinates_=function(t,e,i,s,r){var n,a,l,o,h,p=u.default.linearRingIsClockwise(t,0,t.length,e),y=this.vertices.length/2,x=[],d=[];if(r===p){for(o=l=this.createPoint_(t[0],t[1],y++),n=e,a=t.length;n<a;n+=e)h=this.createPoint_(t[n],t[n+1],y++),d.push(this.insertItem_(o,h,i)),x.push([Math.min(o.x,h.x),Math.min(o.y,h.y),Math.max(o.x,h.x),Math.max(o.y,h.y)]),o=h;d.push(this.insertItem_(h,l,i)),x.push([Math.min(o.x,h.x),Math.min(o.y,h.y),Math.max(o.x,h.x),Math.max(o.y,h.y)])}else{var f=t.length-e;for(o=l=this.createPoint_(t[f],t[f+1],y++),n=f-e,a=0;n>=a;n-=e)h=this.createPoint_(t[n],t[n+1],y++),d.push(this.insertItem_(o,h,i)),x.push([Math.min(o.x,h.x),Math.min(o.y,h.y),Math.max(o.x,h.x),Math.max(o.y,h.y)]),o=h;d.push(this.insertItem_(h,l,i)),x.push([Math.min(o.x,h.x),Math.min(o.y,h.y),Math.max(o.x,h.x),Math.max(o.y,h.y)])}s.load(x,d)},D.prototype.getMaxCoords_=function(t){var e=t.firstItem(),i=e,s=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>s[0]&&(s=[i.p0.x,i.p0.y])}while(i!==e);return s},D.prototype.classifyPoints_=function(t,e,i){var s=t.firstItem(),r=s,n=t.nextItem(),a=!1;do{var l=i?C.default.triangleIsCounterClockwise(n.p1.x,n.p1.y,r.p1.x,r.p1.y,r.p0.x,r.p0.y):C.default.triangleIsCounterClockwise(r.p0.x,r.p0.y,r.p1.x,r.p1.y,n.p1.x,n.p1.y);void 0===l?(this.removeItem_(r,n,t,e),a=!0,n===s&&(s=t.getNextItem()),n=r,t.prevItem()):r.p1.reflex!==l&&(r.p1.reflex=l,a=!0),r=n,n=t.nextItem()}while(r!==s);return a},D.prototype.bridgeHole_=function(t,e,i,s,r){for(var n=t.firstItem();n.p1.x!==e;)n=t.nextItem();var a,l,o,h,p=n.p1,y={x:s,y:p.y,i:-1},x=1/0,u=this.getIntersections_({p0:p,p1:y},r,!0);for(a=0,l=u.length;a<l;++a){var d=u[a],f=this.calculateIntersection_(p,y,d.p0,d.p1,!0),c=Math.abs(p.x-f[0]);c<x&&void 0!==C.default.triangleIsCounterClockwise(p.x,p.y,d.p0.x,d.p0.y,d.p1.x,d.p1.y)&&(x=c,h={x:f[0],y:f[1],i:-1},n=d)}if(x===1/0)return!1;if(o=n.p1,x>0){var g=this.getPointsInTriangle_(p,h,n.p1,r);if(g.length){var m=1/0;for(a=0,l=g.length;a<l;++a){var _=g[a],I=Math.atan2(p.y-_.y,y.x-_.x);(I<m||I===m&&_.x<o.x)&&(m=I,o=_)}}}for(n=i.firstItem();n.p1.x!==o.x||n.p1.y!==o.y;)n=i.nextItem();var v={x:p.x,y:p.y,i:p.i,reflex:void 0},M={x:n.p1.x,y:n.p1.y,i:n.p1.i,reflex:void 0};return t.getNextItem().p0=v,this.insertItem_(p,n.p1,t,r),this.insertItem_(M,v,t,r),n.p1=M,t.setFirstItem(),i.concat(t),!0},D.prototype.triangulate_=function(t,e){for(var i=!1,s=this.isSimple_(t,e);t.getLength()>3;)if(s){if(!this.clipEars_(t,e,s,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,s,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(s=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){var r=this.indices.length;this.indices[r++]=t.getPrevItem().p0.i,this.indices[r++]=t.getCurrItem().p0.i,this.indices[r++]=t.getNextItem().p0.i}},D.prototype.clipEars_=function(t,e,i,s){var r,n,a,l=this.indices.length,o=t.firstItem(),h=t.getPrevItem(),p=o,y=t.nextItem(),x=t.getNextItem(),d=!1;do{var f;if(r=p.p0,n=p.p1,a=y.p1,!1===n.reflex)f=i?0===this.getPointsInTriangle_(r,n,a,e,!0).length:s?this.diagonalIsInside_(x.p1,a,n,r,h.p0):this.diagonalIsInside_(h.p0,r,n,a,x.p1),(i||0===this.getIntersections_({p0:r,p1:a},e).length)&&f&&(i||!1===r.reflex||!1===a.reflex||u.default.linearRingIsClockwise([h.p0.x,h.p0.y,r.x,r.y,n.x,n.y,a.x,a.y,x.p1.x,x.p1.y],0,10,2)===!s)&&(this.indices[l++]=r.i,this.indices[l++]=n.i,this.indices[l++]=a.i,this.removeItem_(p,y,t,e),y===o&&(o=x),d=!0);h=t.getPrevItem(),p=t.getCurrItem(),y=t.nextItem(),x=t.getNextItem()}while(p!==o&&t.getLength()>3);return d},D.prototype.resolveSelfIntersections_=function(t,e,i){var s=t.firstItem();t.nextItem();var r=s,n=t.nextItem(),a=!1;do{var l=this.calculateIntersection_(r.p0,r.p1,n.p0,n.p1,i);if(l){var o,h=!1,p=this.vertices.length,y=this.indices.length,x=p/2,u=t.prevItem();if(t.removeItem(),e.remove(u),h=u===s,i?(l[0]===r.p0.x&&l[1]===r.p0.y?(t.prevItem(),o=r.p0,n.p0=o,e.remove(r),h=h||r===s):(o=n.p1,r.p1=o,e.remove(n),h=h||n===s),t.removeItem()):(o=this.createPoint_(l[0],l[1],x),r.p1=o,n.p0=o,e.update([Math.min(r.p0.x,r.p1.x),Math.min(r.p0.y,r.p1.y),Math.max(r.p0.x,r.p1.x),Math.max(r.p0.y,r.p1.y)],r),e.update([Math.min(n.p0.x,n.p1.x),Math.min(n.p0.y,n.p1.y),Math.max(n.p0.x,n.p1.x),Math.max(n.p0.y,n.p1.y)],n)),this.indices[y++]=u.p0.i,this.indices[y++]=u.p1.i,this.indices[y++]=o.i,a=!0,h)break}r=t.getPrevItem(),n=t.nextItem()}while(r!==s);return a},D.prototype.isSimple_=function(t,e){var i=t.firstItem(),s=i;do{if(this.getIntersections_(s,e).length)return!1;s=t.nextItem()}while(s!==i);return!0},D.prototype.isClockwise_=function(t){var e=2*t.getLength(),i=new Array(e),s=t.firstItem(),r=s,n=0;do{i[n++]=r.p0.x,i[n++]=r.p0.y,r=t.nextItem()}while(r!==s);return u.default.linearRingIsClockwise(i,0,e,2)},D.prototype.splitPolygon_=function(t,e){var i=t.firstItem(),s=i;do{var r=this.getIntersections_(s,e);if(r.length){var n=r[0],a=this.vertices.length/2,l=this.calculateIntersection_(s.p0,s.p1,n.p0,n.p1),o=this.createPoint_(l[0],l[1],a),h=new b.default,p=new T.default;this.insertItem_(o,s.p1,h,p),s.p1=o,e.update([Math.min(s.p0.x,o.x),Math.min(s.p0.y,o.y),Math.max(s.p0.x,o.x),Math.max(s.p0.y,o.y)],s);for(var y=t.nextItem();y!==n;)this.insertItem_(y.p0,y.p1,h,p),e.remove(y),t.removeItem(),y=t.getCurrItem();this.insertItem_(n.p0,o,h,p),n.p0=o,e.update([Math.min(n.p1.x,o.x),Math.min(n.p1.y,o.y),Math.max(n.p1.x,o.x),Math.max(n.p1.y,o.y)],n),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(h,p,!1),this.triangulate_(h,p);break}s=t.nextItem()}while(s!==i)},D.prototype.createPoint_=function(t,e,i){var s=this.vertices.length;return this.vertices[s++]=t,this.vertices[s++]=e,{x:t,y:e,i:i,reflex:void 0}},D.prototype.insertItem_=function(t,e,i,s){var r={p0:t,p1:e};return i.insertItem(r),s&&s.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],r),r},D.prototype.removeItem_=function(t,e,i,s){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,s.remove(e),s.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},D.prototype.getPointsInTriangle_=function(t,e,i,s,r){var n,a,l,o,h=[],p=s.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]);for(n=0,a=p.length;n<a;++n)for(l in p[n])"object"!=typeof(o=p[n][l])||r&&!o.reflex||o.x===t.x&&o.y===t.y||o.x===e.x&&o.y===e.y||o.x===i.x&&o.y===i.y||-1!==h.indexOf(o)||!y.default.linearRingContainsXY([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,o.x,o.y)||h.push(o);return h},D.prototype.getIntersections_=function(t,e,i){var s,r,n=t.p0,a=t.p1,l=e.getInExtent([Math.min(n.x,a.x),Math.min(n.y,a.y),Math.max(n.x,a.x),Math.max(n.y,a.y)]),o=[];for(s=0,r=l.length;s<r;++s){var h=l[s];t!==h&&(i||h.p0!==a||h.p1!==n)&&this.calculateIntersection_(n,a,h.p0,h.p1,i)&&o.push(h)}return o},D.prototype.calculateIntersection_=function(t,e,i,s,r){var n=(s.y-i.y)*(e.x-t.x)-(s.x-i.x)*(e.y-t.y);if(0!==n){var a=((s.x-i.x)*(t.y-i.y)-(s.y-i.y)*(t.x-i.x))/n,l=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/n;if(!r&&a>C.default.EPSILON&&a<1-C.default.EPSILON&&l>C.default.EPSILON&&l<1-C.default.EPSILON||r&&a>=0&&a<=1&&l>=0&&l<=1)return[t.x+a*(e.x-t.x),t.y+a*(e.y-t.y)]}},D.prototype.diagonalIsInside_=function(t,e,i,s,r){if(void 0===e.reflex||void 0===s.reflex)return!1;var n=(i.x-s.x)*(e.y-s.y)>(i.y-s.y)*(e.x-s.x),a=(r.x-s.x)*(e.y-s.y)<(r.y-s.y)*(e.x-s.x),l=(t.x-e.x)*(s.y-e.y)>(t.y-e.y)*(s.x-e.x),o=(i.x-e.x)*(s.y-e.y)<(i.y-e.y)*(s.x-e.x),h=s.reflex?a||n:a&&n,p=e.reflex?o||l:o&&l;return h&&p},D.prototype.drawMultiPolygon=function(t,e){var i,s,r,n,a=t.getEndss(),l=t.getStride(),o=this.indices.length,h=this.lineStringReplay.getCurrentIndex(),p=t.getFlatCoordinates(),y=0;for(i=0,s=a.length;i<s;++i){var x=a[i];if(x.length>0){var u=f.default.translate(p,y,x[0],l,-this.origin[0],-this.origin[1]);if(u.length){var d,c=[];for(r=1,n=x.length;r<n;++r)x[r]!==x[r-1]&&(d=f.default.translate(p,x[r-1],x[r],l,-this.origin[0],-this.origin[1]),c.push(d));this.lineStringReplay.drawPolygonCoordinates(u,c,l),this.drawCoordinates_(u,c,l)}}y=x[x.length-1]}this.indices.length>o&&(this.startIndices.push(o),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(o),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>h&&this.lineStringReplay.setPolygonStyle(e,h)},D.prototype.drawPolygon=function(t,e){var i=t.getEnds(),s=t.getStride();if(i.length>0){var r=t.getFlatCoordinates().map(Number),n=f.default.translate(r,0,i[0],s,-this.origin[0],-this.origin[1]);if(n.length){var a,l,o,h=[];for(a=1,l=i.length;a<l;++a)i[a]!==i[a-1]&&(o=f.default.translate(r,i[a-1],i[a],s,-this.origin[0],-this.origin[1]),h.push(o));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(n,h,s),this.drawCoordinates_(n,h,s)}}},D.prototype.finish=function(t){this.verticesBuffer=new B.default(this.vertices),this.indicesBuffer=new B.default(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},D.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,s=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),s()}},D.prototype.setUpProgram=function(t,e,i,s){var r,n;r=g.default.fragment,n=g.default.vertex;var a,l=e.getProgram(r,n);return this.defaultLocations_?a=this.defaultLocations_:(a=new _.default(t,l),this.defaultLocations_=a),e.useProgram(l),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,j.default.FLOAT,!1,8,0),a},D.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},D.prototype.drawReplay=function(t,e,i,s){var r,n,a,l,o=t.getParameter(t.DEPTH_FUNC),p=t.getParameter(t.DEPTH_WRITEMASK);if(s||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),h.default.isEmpty(i))for(a=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)n=this.styleIndices_[r],l=this.styles_[r],this.setFillStyle_(t,l),this.drawElements(t,e,n,a),a=n;else this.drawReplaySkipping_(t,e,i);s||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(p),t.depthFunc(o))},D.prototype.drawHitDetectionReplayOneByOne=function(t,i,s,r,n){var a,o,h,p,y,x,u;for(u=this.startIndices.length-2,h=this.startIndices[u+1],a=this.styleIndices_.length-1;a>=0;--a)for(p=this.styles_[a],this.setFillStyle_(t,p),y=this.styleIndices_[a];u>=0&&this.startIndices[u]>=y;){if(o=this.startIndices[u],x=this.startIndicesFeature[u],void 0===s[e.default.getUid(x).toString()]&&x.getGeometry()&&(void 0===n||l.default.intersects(n,x.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,i,o,h);var d=r(x);if(d)return d}u--,h=o}},D.prototype.drawReplaySkipping_=function(t,i,s){var r,n,a,l,o,h,p,y;for(p=this.startIndices.length-2,a=n=this.startIndices[p+1],r=this.styleIndices_.length-1;r>=0;--r){for(l=this.styles_[r],this.setFillStyle_(t,l),o=this.styleIndices_[r];p>=0&&this.startIndices[p]>=o;)y=this.startIndices[p],h=this.startIndicesFeature[p],s[e.default.getUid(h).toString()]&&(n!==a&&(this.drawElements(t,i,n,a),t.clear(t.DEPTH_BUFFER_BIT)),a=y),p--,n=y;n!==a&&(this.drawElements(t,i,n,a),t.clear(t.DEPTH_BUFFER_BIT)),n=a=o}},D.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},D.prototype.setFillStrokeStyle=function(t,e){var i=t?t.getColor():[0,0,0,0];if(i=i instanceof CanvasGradient||i instanceof CanvasPattern?C.default.defaultFillStyle:n.default.asArray(i).map(function(t,e){return 3!=e?t/255:t})||C.default.defaultFillStyle,this.state_.fillColor&&s.default.equals(i,this.state_.fillColor)||(this.state_.fillColor=i,this.state_.changed=!0,this.styles_.push(i)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var r=new F.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,r)}},exports.default=D;
},{"../../index.js":42,"../../array.js":68,"../../color.js":259,"../../extent.js":76,"../../obj.js":52,"../../geom/flat/contains.js":168,"../../geom/flat/orient.js":173,"../../geom/flat/transform.js":175,"../webgl/polygonreplay/defaultshader.js":290,"../webgl/polygonreplay/defaultshader/locations.js":291,"../webgl/linestringreplay.js":248,"../webgl/replay.js":273,"../webgl.js":272,"../../style/stroke.js":287,"../../structs/linkedlist.js":288,"../../structs/rbush.js":289,"../../webgl.js":180,"../../webgl/buffer.js":197}],293:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom.js"),e=i(t);function i(t){return t&&t.__esModule?t:{default:t}}var h=function(t,i){this.space_=i,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=e.default.createCanvasContext2D(t,t),this.canvas_=this.context_.canvas};h.prototype.get=function(t){return this.entries_[t]||null},h.prototype.add=function(t,e,i,h,s){var a,o,p;for(o=0,p=this.emptyBlocks_.length;o<p;++o)if((a=this.emptyBlocks_[o]).width>=e+this.space_&&a.height>=i+this.space_){var c={offsetX:a.x+this.space_,offsetY:a.y+this.space_,image:this.canvas_};return this.entries_[t]=c,h.call(s,this.context_,a.x+this.space_,a.y+this.space_),this.split_(o,a,e+this.space_,i+this.space_),c}return null},h.prototype.split_=function(t,e,i,h){var s,a;e.width-i>e.height-h?(s={x:e.x+i,y:e.y,width:e.width-i,height:e.height},a={x:e.x,y:e.y+h,width:i,height:e.height-h},this.updateBlocks_(t,s,a)):(s={x:e.x+i,y:e.y,width:e.width-i,height:h},a={x:e.x,y:e.y+h,width:e.width,height:e.height-h},this.updateBlocks_(t,s,a))},h.prototype.updateBlocks_=function(t,e,i){var h=[t,1];e.width>0&&e.height>0&&h.push(e),i.width>0&&i.height>0&&h.push(i),this.emptyBlocks_.splice.apply(this.emptyBlocks_,h)},exports.default=h;
},{"../dom.js":134}],292:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=r(t),i=require("../style/atlas.js"),s=r(i);function r(t){return t&&t.__esModule?t:{default:t}}var a=function(t){var i=t||{};this.currentSize_=void 0!==i.initialSize?i.initialSize:e.default.INITIAL_ATLAS_SIZE,this.maxSize_=void 0!==i.maxSize?i.maxSize:-1!=e.default.MAX_ATLAS_SIZE?e.default.MAX_ATLAS_SIZE:void 0!==e.default.WEBGL_MAX_TEXTURE_SIZE?e.default.WEBGL_MAX_TEXTURE_SIZE:2048,this.space_=void 0!==i.space?i.space:1,this.atlases_=[new s.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new s.default(this.currentHitSize_,this.space_)]};a.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},a.prototype.getInfo_=function(t,e){var i,s,r;for(s=0,r=t.length;s<r;++s)if(i=t[s].get(e))return i;return null},a.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},a.prototype.add=function(t,i,s,r,a,n){if(i+this.space_>this.maxSize_||s+this.space_>this.maxSize_)return null;var u=this.add_(!1,t,i,s,r,n);if(!u)return null;var _=void 0!==a?a:e.default.nullFunction,f=this.add_(!0,t,i,s,_,n);return this.mergeInfos_(u,f)},a.prototype.add_=function(t,e,i,r,a,n){var u,_,f,h,o=t?this.hitAtlases_:this.atlases_;for(f=0,h=o.length;f<h;++f){if(_=(u=o[f]).add(e,i,r,a,n))return _;var l;_||f!==h-1||(t?(l=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=l):(l=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=l),u=new s.default(l,this.space_),o.push(u),++h)}return null},exports.default=a;
},{"../index.js":42,"../style/atlas.js":293}],250:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=m(t),i=require("../../colorlike.js"),s=m(i),a=require("../../dom.js"),l=m(a),r=require("../../geom/geometrytype.js"),n=m(r),o=require("../../has.js"),h=m(o),f=require("../replay.js"),d=m(f),u=require("../webgl.js"),g=m(u),c=require("../webgl/texturereplay.js"),_=m(c),p=require("../../style/atlasmanager.js"),v=m(p),x=require("../../webgl/buffer.js"),C=m(x);function m(t){return t&&t.__esModule?t:{default:t}}var T=function(t,e){_.default.call(this,t,e),this.images_=[],this.textures_=[],this.measureCanvas_=l.default.createCanvasContext2D(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1};e.default.inherits(T,_.default),T.prototype.drawText=function(t,i){if(this.text_){var s=null,a=2,l=2;switch(t.getType()){case n.default.POINT:case n.default.MULTI_POINT:a=(s=t.getFlatCoordinates()).length,l=t.getStride();break;case n.default.CIRCLE:s=t.getCenter();break;case n.default.LINE_STRING:s=t.getFlatMidpoint();break;case n.default.MULTI_LINE_STRING:a=(s=t.getFlatMidpoints()).length;break;case n.default.POLYGON:s=t.getFlatInteriorPoint();break;case n.default.MULTI_POLYGON:a=(s=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(i);var r,o,h,f,d,u,g,c,_=this.currAtlas_,p=this.text_.split("\n"),v=this.getTextSize_(p),x=Math.round(v[0]*this.textAlign_-this.offsetX_),C=Math.round(v[1]*this.textBaseline_-this.offsetY_),m=this.state_.lineWidth/2*this.state_.scale;for(r=0,o=p.length;r<o;++r)for(d=0,u=_.height*r,h=0,f=(g=p[r].split("")).length;h<f;++h){if(c=_.atlas.getInfo(g[h])){var T,L=c.image;this.anchorX=x-d,this.anchorY=C-u,this.originX=0===h?c.offsetX-m:c.offsetX,this.originY=c.offsetY,this.height=_.height,this.width=0===h||h===g.length-1?_.width[g[h]]+m:_.width[g[h]],this.imageHeight=L.height,this.imageWidth=L.width,0===this.images_.length?this.images_.push(L):(T=this.images_[this.images_.length-1],e.default.getUid(T)!=e.default.getUid(L)&&(this.groupIndices.push(this.indices.length),this.images_.push(L))),this.drawText_(s,0,a,l)}d+=this.width}}},T.prototype.getTextSize_=function(t){var e=this,i=this.currAtlas_,s=t.length*i.height;return[t.map(function(t){var s,a,l=0;for(s=0,a=t.length;s<a;++s){var r=t[s];i.width[r]||e.addCharToAtlas_(r),l+=i.width[r]?i.width[r]:0}return l}).reduce(function(t,e){return Math.max(t,e)}),s]},T.prototype.drawText_=function(t,e,i,s){var a,l;for(a=e,l=i;a<l;a+=s)this.drawCoordinates(t,e,i,s)},T.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,i=this.state_,s=this.measureCanvas_.getContext("2d");s.font=i.font;var a=Math.ceil(s.measureText(t).width*i.scale);e.atlas.add(t,a,e.height,function(e,s,a){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",h.default.CANVAS_LINE_DASH&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,s,a),i.fillColor&&e.fillText(t,s,a)})&&(e.width[t]=a)}},T.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new C.default(this.vertices),this.indicesBuffer=new C.default(this.indices);this.createTextures(this.textures_,this.images_,{},e),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,_.default.prototype.finish.call(this,t)},T.prototype.setTextStyle=function(t){var e=this.state_,i=t.getFill(),a=t.getStroke();if(t&&t.getText()&&(i||a)){if(i){var l=i.getColor();e.fillColor=s.default.asColorLike(l||g.default.defaultFillStyle)}else e.fillColor=null;if(a){var r=a.getColor();e.strokeColor=s.default.asColorLike(r||g.default.defaultStrokeStyle),e.lineWidth=a.getWidth()||g.default.defaultLineWidth,e.lineCap=a.getLineCap()||g.default.defaultLineCap,e.lineDashOffset=a.getLineDashOffset()||g.default.defaultLineDashOffset,e.lineJoin=a.getLineJoin()||g.default.defaultLineJoin,e.miterLimit=a.getMiterLimit()||g.default.defaultMiterLimit;var n=a.getLineDash();e.lineDash=n?n.slice():g.default.defaultLineDash}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||g.default.defaultFont,e.scale=t.getScale()||1,this.text_=t.getText();var o=d.default.TEXT_ALIGN[t.getTextAlign()],h=d.default.TEXT_ALIGN[t.getTextBaseline()];this.textAlign_=void 0===o?g.default.defaultTextAlign:o,this.textBaseline_=void 0===h?g.default.defaultTextBaseline:h,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},T.prototype.getAtlas_=function(t){var e,i=[];for(e in t)(t[e]||0===t[e])&&(Array.isArray(t[e])?i=i.concat(t[e]):i.push(t[e]));var s=this.calculateHash_(i);if(!this.atlases_[s]){var a=this.measureCanvas_.getContext("2d");a.font=t.font;var l=Math.ceil((1.5*a.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[s]={atlas:new v.default({space:t.lineWidth+1}),width:{},height:l}}return this.atlases_[s]},T.prototype.calculateHash_=function(t){var e,i,s="";for(e=0,i=t.length;e<i;++e)s+=t[e];return s},T.prototype.getTextures=function(t){return this.textures_},T.prototype.getHitDetectionTextures=function(){return this.textures_},exports.default=T;
},{"../../index.js":42,"../../colorlike.js":241,"../../dom.js":134,"../../geom/geometrytype.js":82,"../../has.js":137,"../replay.js":189,"../webgl.js":272,"../webgl/texturereplay.js":277,"../../style/atlasmanager.js":292,"../../webgl/buffer.js":197}],205:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),r=B(e),t=require("../../array.js"),i=B(t),n=require("../../extent.js"),a=B(n),o=require("../../obj.js"),u=B(o),l=require("../replay.js"),s=B(l),f=require("../replaygroup.js"),p=B(f),y=require("../webgl/circlereplay.js"),d=B(y),_=require("../webgl/imagereplay.js"),c=B(_),h=require("../webgl/linestringreplay.js"),g=B(h),E=require("../webgl/polygonreplay.js"),v=B(E),x=require("../webgl/textreplay.js"),I=B(x);function B(e){return e&&e.__esModule?e:{default:e}}var R=function(e,r,t){p.default.call(this),this.maxExtent_=r,this.tolerance_=e,this.renderBuffer_=t,this.replaysByZIndex_={}};r.default.inherits(R,p.default),R.prototype.addDeclutter=function(e,r){},R.prototype.getDeleteResourcesFunction=function(e){var r,t=[];for(r in this.replaysByZIndex_){var i,n=this.replaysByZIndex_[r];for(i in n)t.push(n[i].getDeleteResourcesFunction(e))}return function(){for(var e,r=t.length,i=0;i<r;i++)e=t[i].apply(this,arguments);return e}},R.prototype.finish=function(e){var r;for(r in this.replaysByZIndex_){var t,i=this.replaysByZIndex_[r];for(t in i)i[t].finish(e)}},R.prototype.getReplay=function(e,r){var t=void 0!==e?e.toString():"0",i=this.replaysByZIndex_[t];void 0===i&&(i={},this.replaysByZIndex_[t]=i);var n=i[r];void 0===n&&(n=new(0,R.BATCH_CONSTRUCTORS_[r])(this.tolerance_,this.maxExtent_),i[r]=n);return n},R.prototype.isEmpty=function(){return u.default.isEmpty(this.replaysByZIndex_)},R.prototype.replay=function(e,r,t,n,a,o,u,l){var f,p,y,d,_,c,h=Object.keys(this.replaysByZIndex_).map(Number);for(h.sort(i.default.numberSafeCompareFunction),f=0,p=h.length;f<p;++f)for(_=this.replaysByZIndex_[h[f].toString()],y=0,d=s.default.ORDER.length;y<d;++y)void 0!==(c=_[s.default.ORDER[y]])&&c.replay(e,r,t,n,a,o,u,l,void 0,!1)},R.prototype.replayHitDetection_=function(e,r,t,i,n,a,o,u,l,f,p){var y,d,_,c,h,g,E=Object.keys(this.replaysByZIndex_).map(Number);for(E.sort(function(e,r){return r-e}),y=0,d=E.length;y<d;++y)for(c=this.replaysByZIndex_[E[y].toString()],_=s.default.ORDER.length-1;_>=0;--_)if(void 0!==(h=c[s.default.ORDER[_]])&&(g=h.replay(e,r,t,i,n,a,o,u,l,f,p)))return g},R.prototype.forEachFeatureAtCoordinate=function(e,r,t,i,n,o,u,l,s,f){var p,y=r.getGL();return y.bindFramebuffer(y.FRAMEBUFFER,r.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(p=a.default.buffer(a.default.createOrUpdateFromCoordinate(e),i*this.renderBuffer_)),this.replayHitDetection_(r,e,i,n,R.HIT_DETECTION_SIZE_,u,l,s,function(e){var r=new Uint8Array(4);if(y.readPixels(0,0,1,1,y.RGBA,y.UNSIGNED_BYTE,r),r[3]>0){var t=f(e);if(t)return t}},!0,p)},R.prototype.hasFeatureAtCoordinate=function(e,r,t,i,n,a,o,u,l){var s=r.getGL();return s.bindFramebuffer(s.FRAMEBUFFER,r.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(r,e,i,n,R.HIT_DETECTION_SIZE_,o,u,l,function(e){var r=new Uint8Array(4);return s.readPixels(0,0,1,1,s.RGBA,s.UNSIGNED_BYTE,r),r[3]>0},!1)},R.HIT_DETECTION_SIZE_=[1,1],R.BATCH_CONSTRUCTORS_={Circle:d.default,Image:c.default,LineString:g.default,Polygon:v.default,Text:I.default},exports.default=R;
},{"../../index.js":42,"../../array.js":68,"../../extent.js":76,"../../obj.js":52,"../replay.js":189,"../replaygroup.js":235,"../webgl/circlereplay.js":246,"../webgl/imagereplay.js":247,"../webgl/linestringreplay.js":248,"../webgl/polygonreplay.js":249,"../webgl/textreplay.js":250}],202:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=y(t),i=require("../../extent.js"),s=y(i),l=require("../../geom/geometrytype.js"),o=y(l),r=require("../replaytype.js"),n=y(r),a=require("../vectorcontext.js"),h=y(a),_=require("../webgl/replaygroup.js"),u=y(_);function y(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e,i,s,l,o,r){h.default.call(this),this.context_=t,this.center_=e,this.extent_=o,this.pixelRatio_=r,this.size_=l,this.rotation_=s,this.resolution_=i,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null};e.default.inherits(c,h.default),c.prototype.drawText_=function(t,e){var i=this.context_,s=t.getReplay(0,n.default.TEXT);s.setTextStyle(this.textStyle_),s.drawText(e,null),s.finish(i);s.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),s.getDeleteResourcesFunction(i)()},c.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},c.prototype.drawGeometry=function(t){switch(t.getType()){case o.default.POINT:this.drawPoint(t,null);break;case o.default.LINE_STRING:this.drawLineString(t,null);break;case o.default.POLYGON:this.drawPolygon(t,null);break;case o.default.MULTI_POINT:this.drawMultiPoint(t,null);break;case o.default.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case o.default.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case o.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case o.default.CIRCLE:this.drawCircle(t,null)}},c.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&s.default.intersects(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},c.prototype.drawGeometryCollection=function(t,e){var i,s,l=t.getGeometriesArray();for(i=0,s=l.length;i<s;++i)this.drawGeometry(l[i])},c.prototype.drawPoint=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.IMAGE);l.setImageStyle(this.imageStyle_),l.drawPoint(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawMultiPoint=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.IMAGE);l.setImageStyle(this.imageStyle_),l.drawMultiPoint(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawLineString=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.LINE_STRING);l.setFillStrokeStyle(null,this.strokeStyle_),l.drawLineString(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawMultiLineString=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.LINE_STRING);l.setFillStrokeStyle(null,this.strokeStyle_),l.drawMultiLineString(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawPolygon=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.POLYGON);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawPolygon(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawMultiPolygon=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.POLYGON);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawMultiPolygon(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.drawCircle=function(t,e){var i=this.context_,s=new u.default(1,this.extent_),l=s.getReplay(0,n.default.CIRCLE);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawCircle(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},c.prototype.setImageStyle=function(t){this.imageStyle_=t},c.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},c.prototype.setTextStyle=function(t){this.textStyle_=t},exports.default=c;
},{"../../index.js":42,"../../extent.js":76,"../../geom/geometrytype.js":82,"../replaytype.js":188,"../vectorcontext.js":233,"../webgl/replaygroup.js":205}],230:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),o=a(e),r=require("../../webgl/fragment.js"),t=a(r),n=require("../../webgl/vertex.js"),i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var u={};u.fragment=new t.default(o.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),u.vertex=new i.default(o.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"),exports.default=u;
},{"../../index.js":42,"../../webgl/fragment.js":244,"../../webgl/vertex.js":245}],231:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../index.js"),e=o(t);function o(t){return t&&t.__esModule?t:{default:t}}var i=function(t,o){this.u_texCoordMatrix=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_texCoordMatrix":"d"),this.u_projectionMatrix=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_projectionMatrix":"e"),this.u_opacity=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_opacity":"f"),this.u_texture=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_texture":"g"),this.a_position=t.getAttribLocation(o,e.default.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(o,e.default.DEBUG_WEBGL?"a_texCoord":"c")};exports.default=i;
},{"../../../index.js":42}],201:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=F(e),r=require("../../render/event.js"),i=F(r),a=require("../../render/eventtype.js"),u=F(a),o=require("../../render/webgl/immediate.js"),f=F(o),n=require("../layer.js"),s=F(n),d=require("../webgl/defaultmapshader.js"),l=F(d),m=require("../webgl/defaultmapshader/locations.js"),p=F(m),h=require("../../transform.js"),x=F(h),c=require("../../vec/mat4.js"),b=F(c),_=require("../../webgl.js"),v=F(_),M=require("../../webgl/buffer.js"),y=F(M),E=require("../../webgl/context.js"),T=F(E);function F(e){return e&&e.__esModule?e:{default:e}}var g=function(e,t){s.default.call(this,t),this.mapRenderer=e,this.arrayBuffer_=new y.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=x.default.create(),this.projectionMatrix=x.default.create(),this.tmpMat4_=b.default.create(),this.defaultLocations_=null};t.default.inherits(g,s.default),g.prototype.bindFramebuffer=function(e,t){var r=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=t){var i=function(e,t,r){e.isContextLost()||(e.deleteFramebuffer(t),e.deleteTexture(r))}.bind(null,r,this.framebuffer,this.texture);e.postRenderFunctions.push(i);var a=T.default.createEmptyTexture(r,t,t),u=r.createFramebuffer();r.bindFramebuffer(v.default.FRAMEBUFFER,u),r.framebufferTexture2D(v.default.FRAMEBUFFER,v.default.COLOR_ATTACHMENT0,v.default.TEXTURE_2D,a,0),this.texture=a,this.framebuffer=u,this.framebufferDimension=t}else r.bindFramebuffer(v.default.FRAMEBUFFER,this.framebuffer)},g.prototype.composeFrame=function(e,t,r){this.dispatchComposeEvent_(u.default.PRECOMPOSE,r,e),r.bindBuffer(v.default.ARRAY_BUFFER,this.arrayBuffer_);var i,a=r.getGL(),o=l.default.fragment,f=l.default.vertex,n=r.getProgram(o,f);this.defaultLocations_?i=this.defaultLocations_:(i=new p.default(a,n),this.defaultLocations_=i),r.useProgram(n)&&(a.enableVertexAttribArray(i.a_position),a.vertexAttribPointer(i.a_position,2,v.default.FLOAT,!1,16,0),a.enableVertexAttribArray(i.a_texCoord),a.vertexAttribPointer(i.a_texCoord,2,v.default.FLOAT,!1,16,8),a.uniform1i(i.u_texture,0)),a.uniformMatrix4fv(i.u_texCoordMatrix,!1,b.default.fromTransform(this.tmpMat4_,this.getTexCoordMatrix())),a.uniformMatrix4fv(i.u_projectionMatrix,!1,b.default.fromTransform(this.tmpMat4_,this.getProjectionMatrix())),a.uniform1f(i.u_opacity,t.opacity),a.bindTexture(v.default.TEXTURE_2D,this.getTexture()),a.drawArrays(v.default.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(u.default.POSTCOMPOSE,r,e)},g.prototype.dispatchComposeEvent_=function(e,t,r){var a=this.getLayer();if(a.hasListener(e)){var u=r.viewState,o=u.resolution,n=r.pixelRatio,s=r.extent,d=u.center,l=u.rotation,m=r.size,p=new f.default(t,d,o,l,m,s,n),h=new i.default(e,p,r,null,t);a.dispatchEvent(h)}},g.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},g.prototype.getTexture=function(){return this.texture},g.prototype.getProjectionMatrix=function(){return this.projectionMatrix},g.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},g.prototype.prepareFrame=function(e,t,r){},g.prototype.forEachLayerAtPixel=function(e,t,r,i){},exports.default=g;
},{"../../index.js":42,"../../render/event.js":192,"../../render/eventtype.js":183,"../../render/webgl/immediate.js":202,"../layer.js":227,"../webgl/defaultmapshader.js":230,"../webgl/defaultmapshader/locations.js":231,"../../transform.js":139,"../../vec/mat4.js":229,"../../webgl.js":180,"../../webgl/buffer.js":197,"../../webgl/context.js":190}],112:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=T(t),a=require("../../layertype.js"),r=T(a),i=require("../../viewhint.js"),n=T(i),o=require("../../dom.js"),u=T(o),s=require("../../extent.js"),l=T(s),f=require("../../functions.js"),d=T(f),h=require("../type.js"),c=T(h),g=require("../webgl/layer.js"),p=T(g),x=require("../../transform.js"),v=T(x),_=require("../../webgl.js"),m=T(_),C=require("../../webgl/context.js"),y=T(C);function T(t){return t&&t.__esModule?t:{default:t}}var E=function(t,e){p.default.call(this,t,e),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null};e.default.inherits(E,p.default),E.handles=function(t,e){return t===c.default.WEBGL&&e.getType()===r.default.IMAGE},E.create=function(t,e){return new E(t,e)},E.prototype.createTexture_=function(t){var e=t.getImage(),a=this.mapRenderer.getGL();return y.default.createTexture(a,e,m.default.CLAMP_TO_EDGE,m.default.CLAMP_TO_EDGE)},E.prototype.forEachFeatureAtCoordinate=function(t,e,a,r,i){var n=this.getLayer(),o=n.getSource(),u=e.viewState.resolution,s=e.viewState.rotation,l=e.skippedFeatureUids;return o.forEachFeatureAtCoordinate(t,u,s,a,l,function(t){return r.call(i,t,n)})},E.prototype.prepareFrame=function(t,a,r){var i=this.mapRenderer.getGL(),o=t.pixelRatio,u=t.viewState,s=u.center,f=u.resolution,d=u.rotation,h=this.image_,c=this.texture,g=this.getLayer().getSource(),p=t.viewHints,x=t.extent;if(void 0!==a.extent&&(x=l.default.getIntersection(x,a.extent)),!p[n.default.ANIMATING]&&!p[n.default.INTERACTING]&&!l.default.isEmpty(x)){var _=u.projection;if(!e.default.ENABLE_RASTER_REPROJECTION){var m=g.getProjection();m&&(_=m)}var C=g.getImage(x,f,o,_);if(C)if(this.loadImage(C)&&(h=C,c=this.createTexture_(C),this.texture)){var y=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,i,this.texture);t.postRenderFunctions.push(y)}}if(h){var T=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(T.width,T.height,o,s,f,d,h.getExtent()),this.hitTransformationMatrix_=null;var E=this.texCoordMatrix;v.default.reset(E),v.default.scale(E,1,-1),v.default.translate(E,0,-1),this.image_=h,this.texture=c,this.updateLogos(t,g)}return!!h},E.prototype.updateProjectionMatrix_=function(t,e,a,r,i,n,o){var u=t*i,s=e*i,l=this.projectionMatrix;v.default.reset(l),v.default.scale(l,2*a/u,2*a/s),v.default.rotate(l,-n),v.default.translate(l,o[0]-r[0],o[1]-r[1]),v.default.scale(l,(o[2]-o[0])/2,(o[3]-o[1])/2),v.default.translate(l,1,1)},E.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,d.default.TRUE,this)},E.prototype.forEachLayerAtPixel=function(t,a,r,i){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==e.default.nullFunction){var n=v.default.apply(a.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(n,a,0,d.default.TRUE,this)?r.call(i,this.getLayer(),null):void 0}var o=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(a.size,o));var s=v.default.apply(this.hitTransformationMatrix_,t.slice());if(!(s[0]<0||s[0]>o[0]||s[1]<0||s[1]>o[1])){this.hitCanvasContext_||(this.hitCanvasContext_=u.default.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),s[0],s[1],1,1,0,0,1,1);var l=this.hitCanvasContext_.getImageData(0,0,1,1).data;return l[3]>0?r.call(i,this.getLayer(),l):void 0}}},E.prototype.getHitTransformationMatrix_=function(t,e){var a=v.default.create();v.default.translate(a,-1,-1),v.default.scale(a,2/t[0],2/t[1]),v.default.translate(a,0,t[1]),v.default.scale(a,1,-1);var r=v.default.invert(this.projectionMatrix.slice()),i=v.default.create();return v.default.translate(i,0,e[1]),v.default.scale(i,1,-1),v.default.scale(i,e[0]/2,e[1]/2),v.default.translate(i,1,1),v.default.multiply(i,r),v.default.multiply(i,a),i},exports.default=E;
},{"../../index.js":42,"../../layertype.js":177,"../../viewhint.js":64,"../../dom.js":134,"../../extent.js":76,"../../functions.js":136,"../type.js":155,"../webgl/layer.js":201,"../../transform.js":139,"../../webgl.js":180,"../../webgl/context.js":190}],114:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=P(e),i=require("../../array.js"),r=P(i),a=require("../../css.js"),s=P(a),u=require("../../dom.js"),n=P(u),l=require("../../events.js"),o=P(l),h=require("../../has.js"),d=P(h),f=require("../../layer/layer.js"),c=P(f),_=require("../../render/event.js"),E=P(_),T=require("../../render/eventtype.js"),p=P(T),x=require("../../render/webgl/immediate.js"),C=P(x),v=require("../map.js"),R=P(v),y=require("../type.js"),L=P(y),g=require("../../source/state.js"),A=P(g),m=require("../../structs/lrucache.js"),b=P(m),S=require("../../structs/priorityqueue.js"),F=P(S),G=require("../../webgl.js"),U=P(G),I=require("../../webgl/context.js"),M=P(I),D=require("../../webgl/contexteventtype.js"),w=P(D);function P(e){return e&&e.__esModule?e:{default:e}}var q=function(e,t){R.default.call(this,e,t),this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=s.default.CLASS_UNSELECTABLE,e.insertBefore(this.canvas_,e.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=n.default.createCanvasContext2D(),this.renderedVisible_=!0,this.gl_=U.default.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new M.default(this.canvas_,this.gl_),o.default.listen(this.canvas_,w.default.LOST,this.handleWebGLContextLost,this),o.default.listen(this.canvas_,w.default.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new b.default,this.focus_=null,this.tileTextureQueue_=new F.default(function(e){var t=e[1],i=e[2],r=t[0]-this.focus_[0],a=t[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(r*r+a*a)/i}.bind(this),function(e){return e[0].getKey()}),this.loadNextTileTexture_=function(e,t){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var i=this.tileTextureQueue_.dequeue(),r=i[0],a=i[3],s=i[4];this.bindTileTexture(r,a,s,U.default.LINEAR,U.default.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()};t.default.inherits(q,R.default),q.handles=function(e){return d.default.WEBGL&&e===L.default.WEBGL},q.create=function(e,t){return new q(e,t)},q.prototype.bindTileTexture=function(e,t,i,r,a){var s=this.getGL(),u=e.getKey();if(this.textureCache_.containsKey(u)){var n=this.textureCache_.get(u);s.bindTexture(U.default.TEXTURE_2D,n.texture),n.magFilter!=r&&(s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_MAG_FILTER,r),n.magFilter=r),n.minFilter!=a&&(s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_MIN_FILTER,a),n.minFilter=a)}else{var l=s.createTexture();if(s.bindTexture(U.default.TEXTURE_2D,l),i>0){var o=this.clipTileContext_.canvas,h=this.clipTileContext_;this.clipTileCanvasWidth_!==t[0]||this.clipTileCanvasHeight_!==t[1]?(o.width=t[0],o.height=t[1],this.clipTileCanvasWidth_=t[0],this.clipTileCanvasHeight_=t[1]):h.clearRect(0,0,t[0],t[1]),h.drawImage(e.getImage(),i,i,t[0],t[1],0,0,t[0],t[1]),s.texImage2D(U.default.TEXTURE_2D,0,U.default.RGBA,U.default.RGBA,U.default.UNSIGNED_BYTE,o)}else s.texImage2D(U.default.TEXTURE_2D,0,U.default.RGBA,U.default.RGBA,U.default.UNSIGNED_BYTE,e.getImage());s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_MAG_FILTER,r),s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_MIN_FILTER,a),s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_WRAP_S,U.default.CLAMP_TO_EDGE),s.texParameteri(U.default.TEXTURE_2D,U.default.TEXTURE_WRAP_T,U.default.CLAMP_TO_EDGE),this.textureCache_.set(u,{texture:l,magFilter:r,minFilter:a})}},q.prototype.dispatchComposeEvent_=function(e,t){var i=this.getMap();if(i.hasListener(e)){var r=this.context_,a=t.extent,s=t.size,u=t.viewState,n=t.pixelRatio,l=u.resolution,o=u.center,h=u.rotation,d=new C.default(r,o,l,h,s,a,n),f=new E.default(e,d,t,null,r);i.dispatchEvent(f)}},q.prototype.disposeInternal=function(){var e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)}),this.context_.dispose(),R.default.prototype.disposeInternal.call(this)},q.prototype.expireCache_=function(e,i){for(var r,a=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>t.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){if(r=this.textureCache_.peekLast())a.deleteTexture(r.texture);else{if(+this.textureCache_.peekLastKey()==i.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},q.prototype.getContext=function(){return this.context_},q.prototype.getGL=function(){return this.gl_},q.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},q.prototype.getType=function(){return L.default.WEBGL},q.prototype.handleWebGLContextLost=function(e){e.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var t=this.getLayerRenderers();for(var i in t){t[i].handleWebGLContextLost()}},q.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},q.prototype.initializeGL_=function(){var e=this.gl_;e.activeTexture(U.default.TEXTURE0),e.blendFuncSeparate(U.default.SRC_ALPHA,U.default.ONE_MINUS_SRC_ALPHA,U.default.ONE,U.default.ONE_MINUS_SRC_ALPHA),e.disable(U.default.CULL_FACE),e.disable(U.default.DEPTH_TEST),e.disable(U.default.SCISSOR_TEST),e.disable(U.default.STENCIL_TEST)},q.prototype.isTileTextureLoaded=function(e){return this.textureCache_.containsKey(e.getKey())},q.prototype.renderFrame=function(e){var i=this.getContext(),a=this.getGL();if(a.isContextLost())return!1;if(!e)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=e.focus,this.textureCache_.set((-e.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(p.default.PRECOMPOSE,e);var s=[],u=e.layerStatesArray;r.default.stableSort(u,R.default.sortByZIndex);var n,l,o,h=e.viewState.resolution;for(n=0,l=u.length;n<l;++n)o=u[n],c.default.visibleAtResolution(o,h)&&o.sourceState==A.default.READY&&this.getLayerRenderer(o.layer).prepareFrame(e,o,i)&&s.push(o);var d=e.size[0]*e.pixelRatio,f=e.size[1]*e.pixelRatio;for(this.canvas_.width==d&&this.canvas_.height==f||(this.canvas_.width=d,this.canvas_.height=f),a.bindFramebuffer(U.default.FRAMEBUFFER,null),a.clearColor(0,0,0,0),a.clear(U.default.COLOR_BUFFER_BIT),a.enable(U.default.BLEND),a.viewport(0,0,this.canvas_.width,this.canvas_.height),n=0,l=s.length;n<l;++n)o=s[n],this.getLayerRenderer(o.layer).composeFrame(e,o,i);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(e),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>t.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&e.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(e.postRenderFunctions.push(this.loadNextTileTexture_),e.animate=!0),this.dispatchComposeEvent_(p.default.POSTCOMPOSE,e),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)},q.prototype.forEachFeatureAtCoordinate=function(e,t,i,r,a,s,u){var n;if(this.getGL().isContextLost())return!1;var l,o=t.viewState,h=t.layerStatesArray;for(l=h.length-1;l>=0;--l){var d=h[l],f=d.layer;if(c.default.visibleAtResolution(d,o.resolution)&&s.call(u,f))if(n=this.getLayerRenderer(f).forEachFeatureAtCoordinate(e,t,i,r,a))return n}},q.prototype.hasFeatureAtCoordinate=function(e,t,i,r,a){var s=!1;if(this.getGL().isContextLost())return!1;var u,n=t.viewState,l=t.layerStatesArray;for(u=l.length-1;u>=0;--u){var o=l[u],h=o.layer;if(c.default.visibleAtResolution(o,n.resolution)&&r.call(a,h))if(s=this.getLayerRenderer(h).hasFeatureAtCoordinate(e,t))return!0}return s},q.prototype.forEachLayerAtPixel=function(e,t,i,r,a,s){if(this.getGL().isContextLost())return!1;var u,n,l=t.viewState,o=t.layerStatesArray;for(n=o.length-1;n>=0;--n){var h=o[n],d=h.layer;if(c.default.visibleAtResolution(h,l.resolution)&&a.call(r,d))if(u=this.getLayerRenderer(d).forEachLayerAtPixel(e,t,i,r))return u}},exports.default=q;
},{"../../index.js":42,"../../array.js":68,"../../css.js":181,"../../dom.js":134,"../../events.js":135,"../../has.js":137,"../../layer/layer.js":191,"../../render/event.js":192,"../../render/eventtype.js":183,"../../render/webgl/immediate.js":202,"../map.js":193,"../type.js":155,"../../source/state.js":194,"../../structs/lrucache.js":195,"../../structs/priorityqueue.js":156,"../../webgl.js":180,"../../webgl/context.js":190,"../../webgl/contexteventtype.js":196}],203:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=a(e),n=require("../../webgl/fragment.js"),r=a(n),i=require("../../webgl/vertex.js"),o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var u={};u.fragment=new r.default(t.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),u.vertex=new o.default(t.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"),exports.default=u;
},{"../../index.js":42,"../../webgl/fragment.js":244,"../../webgl/vertex.js":245}],206:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../index.js"),e=o(t);function o(t){return t&&t.__esModule?t:{default:t}}var i=function(t,o){this.u_tileOffset=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_tileOffset":"d"),this.u_texture=t.getUniformLocation(o,e.default.DEBUG_WEBGL?"u_texture":"e"),this.a_position=t.getAttribLocation(o,e.default.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(o,e.default.DEBUG_WEBGL?"a_texCoord":"c")};exports.default=i;
},{"../../../index.js":42}],116:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=j(e),r=require("../../layertype.js"),i=j(r),a=require("../../tilerange.js"),n=j(a),o=require("../../tilestate.js"),l=j(o),s=require("../../array.js"),d=j(s),u=require("../../extent.js"),f=j(u),h=require("../../math.js"),g=j(h),c=require("../type.js"),T=j(c),_=require("../webgl/layer.js"),x=j(_),m=require("../webgl/tilelayershader.js"),p=j(m),R=require("../webgl/tilelayershader/locations.js"),b=j(R),y=require("../../size.js"),v=j(y),E=require("../../transform.js"),L=j(E),C=require("../../webgl.js"),A=j(C),F=require("../../webgl/buffer.js"),S=j(F);function j(e){return e&&e.__esModule?e:{default:e}}var q=function(e,t){x.default.call(this,e,t),this.fragmentShader_=p.default.fragment,this.vertexShader_=p.default.vertex,this.locations_=null,this.renderArrayBuffer_=new S.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]};t.default.inherits(q,x.default),q.handles=function(e,t){return e===T.default.WEBGL&&t.getType()===i.default.TILE},q.create=function(e,t){return new q(e,t)},q.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),x.default.prototype.disposeInternal.call(this)},q.prototype.createLoadedTileFinder=function(e,t,r){var i=this.mapRenderer;return function(a,n){return e.forEachLoadedTile(t,a,n,function(e){var t=i.isTileTextureLoaded(e);return t&&(r[a]||(r[a]={}),r[a][e.tileCoord.toString()]=e),t})}},q.prototype.handleWebGLContextLost=function(){x.default.prototype.handleWebGLContextLost.call(this),this.locations_=null},q.prototype.prepareFrame=function(e,t,r){var i,a=this.mapRenderer,o=r.getGL(),s=e.viewState,u=s.projection,h=this.getLayer(),c=h.getSource(),T=c.getTileGridForProjection(u),_=T.getZForResolution(s.resolution),x=T.getResolution(_),m=c.getTilePixelSize(_,e.pixelRatio,u),p=m[0]/v.default.toSize(T.getTileSize(_),this.tmpSize_)[0],R=x/p,y=c.getTilePixelRatio(p)*c.getGutter(u),E=s.center,C=e.extent,F=T.getTileRangeForExtentAndZ(C,_);if(this.renderedTileRange_&&this.renderedTileRange_.equals(F)&&this.renderedRevision_==c.getRevision())i=this.renderedFramebufferExtent_;else{var S=F.getSize(),j=Math.max(S[0]*m[0],S[1]*m[1]),q=g.default.roundUpToPowerOfTwo(j),P=R*q,w=T.getOrigin(_),O=w[0]+F.minX*m[0]*R,B=w[1]+F.minY*m[1]*R;i=[O,B,O+P,B+P],this.bindFramebuffer(e,q),o.viewport(0,0,q,q),o.clearColor(0,0,0,0),o.clear(A.default.COLOR_BUFFER_BIT),o.disable(A.default.BLEND);var z=r.getProgram(this.fragmentShader_,this.vertexShader_);r.useProgram(z),this.locations_||(this.locations_=new b.default(o,z)),r.bindBuffer(A.default.ARRAY_BUFFER,this.renderArrayBuffer_),o.enableVertexAttribArray(this.locations_.a_position),o.vertexAttribPointer(this.locations_.a_position,2,A.default.FLOAT,!1,16,0),o.enableVertexAttribArray(this.locations_.a_texCoord),o.vertexAttribPointer(this.locations_.a_texCoord,2,A.default.FLOAT,!1,16,8),o.uniform1i(this.locations_.u_texture,0);var I={};I[_]={};var D,G,M,U,N,Y,W=this.createLoadedTileFinder(c,u,I),X=h.getUseInterimTilesOnError(),K=!0,Q=f.default.createEmpty(),V=new n.default(0,0,0,0);for(U=F.minX;U<=F.maxX;++U)for(N=F.minY;N<=F.maxY;++N)if(G=c.getTile(_,U,N,p,u),void 0===t.extent||(Y=T.getTileCoordExtent(G.tileCoord,Q),f.default.intersects(Y,t.extent))){if((M=G.getState())==l.default.LOADED||M==l.default.EMPTY||M==l.default.ERROR&&!X||(G=G.getInterimTile()),(M=G.getState())==l.default.LOADED){if(a.isTileTextureLoaded(G)){I[_][G.tileCoord.toString()]=G;continue}}else if(M==l.default.EMPTY||M==l.default.ERROR&&!X)continue;K=!1,T.forEachTileCoordParentTileRange(G.tileCoord,W,null,V,Q)||(D=T.getTileCoordChildTileRange(G.tileCoord,V,Q))&&W(_+1,D)}var Z=Object.keys(I).map(Number);Z.sort(d.default.numberSafeCompareFunction);var k,H,J,$,ee=new Float32Array(4);for(k=0,H=Z.length;k<H;++k)for(J in $=I[Z[k]])G=$[J],Y=T.getTileCoordExtent(G.tileCoord,Q),ee[0]=2*(Y[2]-Y[0])/P,ee[1]=2*(Y[3]-Y[1])/P,ee[2]=2*(Y[0]-i[0])/P-1,ee[3]=2*(Y[1]-i[1])/P-1,o.uniform4fv(this.locations_.u_tileOffset,ee),a.bindTileTexture(G,m,y*p,A.default.LINEAR,A.default.LINEAR),o.drawArrays(A.default.TRIANGLE_STRIP,0,4);K?(this.renderedTileRange_=F,this.renderedFramebufferExtent_=i,this.renderedRevision_=c.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,e.animate=!0)}this.updateUsedTiles(e.usedTiles,c,_,F);var te=a.getTileTextureQueue();this.manageTilePyramid(e,c,T,p,u,C,_,h.getPreload(),function(e){e.getState()!=l.default.LOADED||a.isTileTextureLoaded(e)||te.isKeyQueued(e.getKey())||te.enqueue([e,T.getTileCoordCenter(e.tileCoord),T.getResolution(e.tileCoord[0]),m,y*p])},this),this.scheduleExpireCache(e,c),this.updateLogos(e,c);var re=this.texCoordMatrix;return L.default.reset(re),L.default.translate(re,(Math.round(E[0]/x)*x-i[0])/(i[2]-i[0]),(Math.round(E[1]/x)*x-i[1])/(i[3]-i[1])),0!==s.rotation&&L.default.rotate(re,s.rotation),L.default.scale(re,e.size[0]*s.resolution/(i[2]-i[0]),e.size[1]*s.resolution/(i[3]-i[1])),L.default.translate(re,-.5,-.5),!0},q.prototype.forEachLayerAtPixel=function(e,t,r,i){if(this.framebuffer){var a=[e[0]/t.size[0],(t.size[1]-e[1])/t.size[1]],n=L.default.apply(this.texCoordMatrix,a.slice()),o=[n[0]*this.framebufferDimension,n[1]*this.framebufferDimension],l=this.mapRenderer.getContext().getGL();l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);var s=new Uint8Array(4);return l.readPixels(o[0],o[1],1,1,l.RGBA,l.UNSIGNED_BYTE,s),s[3]>0?r.call(i,this.getLayer(),s):void 0}},exports.default=q;
},{"../../index.js":42,"../../layertype.js":177,"../../tilerange.js":182,"../../tilestate.js":179,"../../array.js":68,"../../extent.js":76,"../../math.js":78,"../type.js":155,"../webgl/layer.js":201,"../webgl/tilelayershader.js":203,"../webgl/tilelayershader/locations.js":206,"../../size.js":138,"../../transform.js":139,"../../webgl.js":180,"../../webgl/buffer.js":197}],118:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=v(e),r=require("../../layertype.js"),i=v(r),a=require("../../viewhint.js"),n=v(a),o=require("../../extent.js"),s=v(o),u=require("../../render/webgl/replaygroup.js"),l=v(u),d=require("../type.js"),p=v(d),h=require("../vector.js"),f=v(h),y=require("../webgl/layer.js"),c=v(y),_=require("../../transform.js"),g=v(_);function v(e){return e&&e.__esModule?e:{default:e}}var R=function(e,t){c.default.call(this,e,t),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=s.default.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null};t.default.inherits(R,c.default),R.handles=function(e,t){return e===p.default.WEBGL&&t.getType()===i.default.VECTOR},R.create=function(e,t){return new R(e,t)},R.prototype.composeFrame=function(e,t,r){this.layerState_=t;var i=e.viewState,a=this.replayGroup_,n=e.size,o=e.pixelRatio,s=this.mapRenderer.getGL();a&&!a.isEmpty()&&(s.enable(s.SCISSOR_TEST),s.scissor(0,0,n[0]*o,n[1]*o),a.replay(r,i.center,i.resolution,i.rotation,n,o,t.opacity,t.managed?e.skippedFeatureUids:{}),s.disable(s.SCISSOR_TEST))},R.prototype.disposeInternal=function(){var e=this.replayGroup_;if(e){var t=this.mapRenderer.getContext();e.getDeleteResourcesFunction(t)(),this.replayGroup_=null}c.default.prototype.disposeInternal.call(this)},R.prototype.forEachFeatureAtCoordinate=function(e,r,i,a,n){if(this.replayGroup_&&this.layerState_){var o=this.mapRenderer.getContext(),s=r.viewState,u=this.getLayer(),l=this.layerState_,d={};return this.replayGroup_.forEachFeatureAtCoordinate(e,o,s.center,s.resolution,s.rotation,r.size,r.pixelRatio,l.opacity,{},function(e){var r=t.default.getUid(e).toString();if(!(r in d))return d[r]=!0,a.call(n,e,u)})}},R.prototype.hasFeatureAtCoordinate=function(e,t){if(this.replayGroup_&&this.layerState_){var r=this.mapRenderer.getContext(),i=t.viewState,a=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(e,r,i.center,i.resolution,i.rotation,t.size,t.pixelRatio,a.opacity,t.skippedFeatureUids)}return!1},R.prototype.forEachLayerAtPixel=function(e,t,r,i){var a=g.default.apply(t.pixelToCoordinateTransform,e.slice());return this.hasFeatureAtCoordinate(a,t)?r.call(i,this.getLayer(),null):void 0},R.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},R.prototype.prepareFrame=function(e,t,r){var i=this.getLayer(),a=i.getSource();this.updateLogos(e,a);var o=e.viewHints[n.default.ANIMATING],u=e.viewHints[n.default.INTERACTING],d=i.getUpdateWhileAnimating(),p=i.getUpdateWhileInteracting();if(!this.dirty_&&!d&&o||!p&&u)return!0;var h=e.extent,y=e.viewState,c=y.projection,_=y.resolution,g=e.pixelRatio,v=i.getRevision(),R=i.getRenderBuffer(),S=i.getRenderOrder();void 0===S&&(S=f.default.defaultOrder);var F=s.default.buffer(h,R*_);if(!this.dirty_&&this.renderedResolution_==_&&this.renderedRevision_==v&&this.renderedRenderOrder_==S&&s.default.containsExtent(this.renderedExtent_,F))return!0;this.replayGroup_&&e.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(r)),this.dirty_=!1;var x=new l.default(f.default.getTolerance(_,g),F,i.getRenderBuffer());a.loadFeatures(F,_,c);var E=function(e){var t,r=e.getStyleFunction();if(r?t=r.call(e,_):(r=i.getStyleFunction())&&(t=r(e,_)),t){var a=this.renderFeature(e,_,g,t,x);this.dirty_=this.dirty_||a}};if(S){var m=[];a.forEachFeatureInExtent(F,function(e){m.push(e)},this),m.sort(S),m.forEach(E,this)}else a.forEachFeatureInExtent(F,E,this);return x.finish(r),this.renderedResolution_=_,this.renderedRevision_=v,this.renderedRenderOrder_=S,this.renderedExtent_=F,this.replayGroup_=x,!0},R.prototype.renderFeature=function(e,t,r,i,a){if(!i)return!1;var n=!1;if(Array.isArray(i))for(var o=i.length-1;o>=0;--o)n=f.default.renderFeature(a,e,i[o],f.default.getSquaredTolerance(t,r),this.handleStyleImageChange_,this)||n;else n=f.default.renderFeature(a,e,i,f.default.getSquaredTolerance(t,r),this.handleStyleImageChange_,this)||n;return n},exports.default=R;
},{"../../index.js":42,"../../layertype.js":177,"../../viewhint.js":64,"../../extent.js":76,"../../render/webgl/replaygroup.js":205,"../type.js":155,"../vector.js":185,"../webgl/layer.js":201,"../../transform.js":139}],30:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),r=P(e),t=require("./pluggablemap.js"),a=P(t),l=require("./plugintype.js"),u=P(l),i=require("./control.js"),d=P(i),s=require("./interaction.js"),n=P(s),f=require("./obj.js"),o=P(f),c=require("./plugins.js"),E=P(c),j=require("./renderer/canvas/imagelayer.js"),q=P(j),g=require("./renderer/canvas/map.js"),R=P(g),p=require("./renderer/canvas/tilelayer.js"),v=P(p),_=require("./renderer/canvas/vectorlayer.js"),y=P(_),A=require("./renderer/canvas/vectortilelayer.js"),b=P(A),N=require("./renderer/webgl/imagelayer.js"),M=P(N),m=require("./renderer/webgl/map.js"),L=P(m),w=require("./renderer/webgl/tilelayer.js"),D=P(w),x=require("./renderer/webgl/vectorlayer.js"),B=P(x);function P(e){return e&&e.__esModule?e:{default:e}}r.default.ENABLE_CANVAS&&(E.default.register(u.default.MAP_RENDERER,R.default),E.default.registerMultiple(u.default.LAYER_RENDERER,[q.default,v.default,y.default,b.default])),r.default.ENABLE_WEBGL&&(E.default.register(u.default.MAP_RENDERER,L.default),E.default.registerMultiple(u.default.LAYER_RENDERER,[M.default,D.default,B.default]));var h=function(e){(e=o.default.assign({},e)).controls||(e.controls=d.default.defaults()),e.interactions||(e.interactions=n.default.defaults()),a.default.call(this,e)};r.default.inherits(h,a.default),exports.default=h;
},{"./index.js":42,"./pluggablemap.js":44,"./plugintype.js":46,"./control.js":48,"./interaction.js":50,"./obj.js":52,"./plugins.js":54,"./renderer/canvas/imagelayer.js":102,"./renderer/canvas/map.js":104,"./renderer/canvas/tilelayer.js":106,"./renderer/canvas/vectorlayer.js":108,"./renderer/canvas/vectortilelayer.js":110,"./renderer/webgl/imagelayer.js":112,"./renderer/webgl/map.js":114,"./renderer/webgl/tilelayer.js":116,"./renderer/webgl/vectorlayer.js":118}],232:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};exports.default=e;
},{}],207:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=d(e),r=require("../layertype.js"),i=d(r),s=require("../layer/layer.js"),o=d(s),l=require("../layer/tileproperty.js"),u=d(l),n=require("../obj.js"),a=d(n);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){var t=e||{},r=a.default.assign({},t);delete r.preload,delete r.useInterimTilesOnError,o.default.call(this,r),this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.type=i.default.TILE};t.default.inherits(p,o.default),p.prototype.getPreload=function(){return this.get(u.default.PRELOAD)},p.prototype.getSource,p.prototype.setPreload=function(e){this.set(u.default.PRELOAD,e)},p.prototype.getUseInterimTilesOnError=function(){return this.get(u.default.USE_INTERIM_TILES_ON_ERROR)},p.prototype.setUseInterimTilesOnError=function(e){this.set(u.default.USE_INTERIM_TILES_ON_ERROR,e)},exports.default=p;
},{"../index.js":42,"../layertype.js":177,"../layer/layer.js":191,"../layer/tileproperty.js":232,"../obj.js":52}],278:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),i=h(t),e=require("./tilestate.js"),n=h(e),r=require("./easing.js"),s=h(r),o=require("./events/eventtarget.js"),a=h(o),u=require("./events/eventtype.js"),l=h(u);function h(t){return t&&t.__esModule?t:{default:t}}var f=function(t,i,e){a.default.call(this);var n=e||{};this.tileCoord=t,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={}};i.default.inherits(f,a.default),f.prototype.changed=function(){this.dispatchEvent(l.default.CHANGE)},f.prototype.getKey=function(){return this.key+"/"+this.tileCoord},f.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==n.default.LOADED)return t;t=t.interimTile}while(t);return this},f.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,i=this;do{if(t.getState()==n.default.LOADED){t.interimTile=null;break}t.getState()==n.default.LOADING?i=t:t.getState()==n.default.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)}},f.prototype.getTileCoord=function(){return this.tileCoord},f.prototype.getState=function(){return this.state},f.prototype.setState=function(t){this.state=t,this.changed()},f.prototype.load=function(){},f.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;var e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else e=i,this.transitionStarts_[t]=e;var n=i-e+1e3/60;return n>=this.transition_?1:s.default.easeIn(n/this.transition_)},f.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},f.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},exports.default=f;
},{"./index.js":42,"./tilestate.js":179,"./easing.js":74,"./events/eventtarget.js":211,"./events/eventtype.js":153}],262:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=d(t),i=require("./tile.js"),s=d(i),a=require("./tilestate.js"),n=d(a),r=require("./dom.js"),l=d(r),h=require("./events.js"),u=d(h),o=require("./events/eventtype.js"),g=d(o);function d(t){return t&&t.__esModule?t:{default:t}}var f=function(t,e,i,a,n,r){s.default.call(this,t,e,r),this.crossOrigin_=a,this.src_=i,this.image_=new Image,null!==a&&(this.image_.crossOrigin=a),this.imageListenerKeys_=null,this.tileLoadFunction_=n};e.default.inherits(f,s.default),f.prototype.disposeInternal=function(){this.state==n.default.LOADING&&(this.unlistenImage_(),this.image_=f.getBlankImage()),this.interimTile&&this.interimTile.dispose(),this.state=n.default.ABORT,this.changed(),s.default.prototype.disposeInternal.call(this)},f.prototype.getImage=function(){return this.image_},f.prototype.getKey=function(){return this.src_},f.prototype.handleImageError_=function(){this.state=n.default.ERROR,this.unlistenImage_(),this.image_=f.getBlankImage(),this.changed()},f.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY,this.unlistenImage_(),this.changed()},f.prototype.load=function(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.imageListenerKeys_=[u.default.listenOnce(this.image_,g.default.ERROR,this.handleImageError_,this),u.default.listenOnce(this.image_,g.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},f.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(u.default.unlistenByKey),this.imageListenerKeys_=null},f.getBlankImage=function(){var t=l.default.createCanvasContext2D(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas},exports.default=f;
},{"./index.js":42,"./tile.js":278,"./tilestate.js":179,"./dom.js":134,"./events.js":135,"./events/eventtype.js":153}],264:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={createOrUpdate:function(e,t,n,r){return void 0!==r?(r[0]=e,r[1]=t,r[2]=n,r):[e,t,n]},getKeyZXY:function(e,t,n){return e+"/"+t+"/"+n},getKey:function(t){return e.getKeyZXY(t[0],t[1],t[2])},fromKey:function(e){return e.split("/").map(Number)},hash:function(e){return(e[1]<<e[0])+e[2]},quadKey:function(e){var t,n,r=e[0],o=new Array(r),u=1<<r-1;for(t=0;t<r;++t)n=48,e[1]&u&&(n+=1),e[2]&u&&(n+=2),o[t]=String.fromCharCode(n),u>>=1;return o.join("")},withinExtentAndZ:function(e,t){var n=e[0],r=e[1],o=e[2];if(t.getMinZoom()>n||n>t.getMaxZoom())return!1;var u,i=t.getExtent();return!(u=i?t.getTileRangeForExtentAndZ(i,n):t.getFullTileRange(n))||u.containsXY(r,o)}};exports.default=e;
},{}],263:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=u(e),i=require("./structs/lrucache.js"),r=u(i),o=require("./tilecoord.js"),s=u(o);function u(e){return e&&e.__esModule?e:{default:e}}var n=function(e){r.default.call(this,e)};t.default.inherits(n,r.default),n.prototype.expireCache=function(e){for(var t,i;this.canExpireCache()&&!((i=(t=this.peekLast()).tileCoord[0].toString())in e&&e[i].contains(t.tileCoord));)this.pop().dispose()},n.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var e=this.peekFirstKey(),t=s.default.fromKey(e)[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(s.default.getKey(e.tileCoord)),e.dispose())},this)}},exports.default=n;
},{"./index.js":42,"./structs/lrucache.js":195,"./tilecoord.js":264}],279:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./dom.js"),t=l(e),a=require("./extent.js"),r=l(a),n=require("./math.js"),o=l(n),i=require("./proj.js"),u=l(i);function l(e){return e&&e.__esModule?e:{default:e}}var s={calculateSourceResolution:function(e,t,a,n){var o=u.default.transform(a,t,e),i=u.default.getPointResolution(t,n,a),l=t.getMetersPerUnit();void 0!==l&&(i*=l);var s=e.getMetersPerUnit();void 0!==s&&(i/=s);var d=e.getExtent();if(!d||r.default.containsCoordinate(d,o)){var f=u.default.getPointResolution(e,i,o)/i;isFinite(f)&&f>0&&(i/=f)}return i},enlargeClipPoint_:function(e,t,a,r){var n=a-e,o=r-t,i=Math.sqrt(n*n+o*o);return[Math.round(a+n/i),Math.round(r+o/i)]},render:function(e,a,n,i,u,l,d,f,g,c,v){var h=t.default.createCanvasContext2D(Math.round(n*e),Math.round(n*a));if(0===g.length)return h.canvas;h.scale(n,n);var m=r.default.createEmpty();g.forEach(function(e,t,a){r.default.extend(m,e.extent)});var x=r.default.getWidth(m),P=r.default.getHeight(m),p=t.default.createCanvasContext2D(Math.round(n*x/i),Math.round(n*P/i)),M=n/i;g.forEach(function(e,t,a){var n=e.extent[0]-m[0],o=-(e.extent[3]-m[3]),i=r.default.getWidth(e.extent),u=r.default.getHeight(e.extent);p.drawImage(e.image,c,c,e.image.width-2*c,e.image.height-2*c,n*M,o*M,i*M,u*M)});var C=r.default.getTopLeft(d);return f.getTriangles().forEach(function(e,t,a){var r=e.source,u=e.target,d=r[0][0],f=r[0][1],g=r[1][0],c=r[1][1],v=r[2][0],x=r[2][1],P=(u[0][0]-C[0])/l,M=-(u[0][1]-C[1])/l,T=(u[1][0]-C[0])/l,_=-(u[1][1]-C[1])/l,j=(u[2][0]-C[0])/l,E=-(u[2][1]-C[1])/l,q=d,b=f;d=0,f=0;var y=[[g-=q,c-=b,0,0,T-P],[v-=q,x-=b,0,0,j-P],[0,0,g,c,_-M],[0,0,v,x,E-M]],k=o.default.solveLinearSystem(y);if(k){h.save(),h.beginPath();var w=(P+T+j)/3,R=(M+_+E)/3,S=s.enlargeClipPoint_(w,R,P,M),W=s.enlargeClipPoint_(w,R,T,_),D=s.enlargeClipPoint_(w,R,j,E);h.moveTo(W[0],W[1]),h.lineTo(S[0],S[1]),h.lineTo(D[0],D[1]),h.clip(),h.transform(k[0],k[2],k[1],k[3],P,M),h.translate(m[0]-q,m[3]-b),h.scale(i/n,-i/n),h.drawImage(p.canvas,0,0),h.restore()}}),v&&(h.save(),h.strokeStyle="black",h.lineWidth=1,f.getTriangles().forEach(function(e,t,a){var r=e.target,n=(r[0][0]-C[0])/l,o=-(r[0][1]-C[1])/l,i=(r[1][0]-C[0])/l,u=-(r[1][1]-C[1])/l,s=(r[2][0]-C[0])/l,d=-(r[2][1]-C[1])/l;h.beginPath(),h.moveTo(i,u),h.lineTo(n,o),h.lineTo(s,d),h.closePath(),h.stroke()}),h.restore()),h.canvas}};exports.default=s;
},{"./dom.js":134,"./extent.js":76,"./math.js":78,"./proj.js":34}],280:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=n(t),r=require("../extent.js"),i=n(r),s=require("../math.js"),o=n(s),a=require("../proj.js"),u=n(a);function n(t){return t&&t.__esModule?t:{default:t}}var d=function(t,r,s,o,a){this.sourceProj_=t,this.targetProj_=r;var n={},d=u.default.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return n[e]||(n[e]=d(t)),n[e]},this.maxSourceExtent_=o,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&i.default.getWidth(o)==i.default.getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?i.default.getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?i.default.getWidth(this.targetProj_.getExtent()):null;var h=i.default.getTopLeft(s),_=i.default.getTopRight(s),l=i.default.getBottomRight(s),c=i.default.getBottomLeft(s),f=this.transformInv_(h),W=this.transformInv_(_),g=this.transformInv_(l),v=this.transformInv_(c);if(this.addQuad_(h,_,l,c,f,W,g,v,e.default.RASTER_REPROJECTION_MAX_SUBDIVISION),this.wrapsXInSource_){var E=1/0;this.triangles_.forEach(function(t,e,r){E=Math.min(E,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-E>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-E>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-E>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-E>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var r=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-r<this.sourceWorldWidth_/2&&(t.source=e)}},this)}n={}};d.prototype.addTriangle_=function(t,e,r,i,s,o){this.triangles_.push({source:[i,s,o],target:[t,e,r]})},d.prototype.addQuad_=function(t,r,s,a,u,n,d,h,_){var l=i.default.boundingExtent([u,n,d,h]),c=this.sourceWorldWidth_?i.default.getWidth(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,W=this.sourceProj_.canWrapX()&&c>.5&&c<1,g=!1;if(_>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var v=i.default.boundingExtent([t,r,s,a]);g|=i.default.getWidth(v)/this.targetWorldWidth_>e.default.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH}!W&&this.sourceProj_.isGlobal()&&c&&(g|=c>e.default.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH)}if(g||!this.maxSourceExtent_||i.default.intersects(l,this.maxSourceExtent_)){if(!(g||isFinite(u[0])&&isFinite(u[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(d[0])&&isFinite(d[1])&&isFinite(h[0])&&isFinite(h[1]))){if(!(_>0))return;g=!0}if(_>0){if(!g){var E,m=[(t[0]+s[0])/2,(t[1]+s[1])/2],I=this.transformInv_(m);if(W)E=(o.default.modulo(u[0],f)+o.default.modulo(d[0],f))/2-o.default.modulo(I[0],f);else E=(u[0]+d[0])/2-I[0];var x=(u[1]+d[1])/2-I[1];g=E*E+x*x>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-s[0])<=Math.abs(t[1]-s[1])){var p=[(r[0]+s[0])/2,(r[1]+s[1])/2],j=this.transformInv_(p),T=[(a[0]+t[0])/2,(a[1]+t[1])/2],P=this.transformInv_(T);this.addQuad_(t,r,p,T,u,n,j,P,_-1),this.addQuad_(T,p,s,a,P,j,d,h,_-1)}else{var R=[(t[0]+r[0])/2,(t[1]+r[1])/2],S=this.transformInv_(R),M=[(s[0]+a[0])/2,(s[1]+a[1])/2],X=this.transformInv_(M);this.addQuad_(t,R,M,a,u,S,X,h,_-1),this.addQuad_(R,r,s,M,S,n,d,X,_-1)}return}}if(W){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,s,a,u,d,h),this.addTriangle_(t,r,s,u,n,d)}},d.prototype.calculateSourceExtent=function(){var t=i.default.createEmpty();return this.triangles_.forEach(function(e,r,s){var o=e.source;i.default.extendCoordinate(t,o[0]),i.default.extendCoordinate(t,o[1]),i.default.extendCoordinate(t,o[2])}),t},d.prototype.getTriangles=function(){return this.triangles_},exports.default=d;
},{"../index.js":42,"../extent.js":76,"../math.js":78,"../proj.js":34}],265:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=E(e),i=require("../tile.js"),s=E(i),r=require("../tilestate.js"),a=E(r),l=require("../events.js"),u=E(l),o=require("../events/eventtype.js"),n=E(o),d=require("../extent.js"),h=E(d),f=require("../math.js"),c=E(f),_=require("../reproj.js"),g=E(_),p=require("../reproj/triangulation.js"),T=E(p);function E(e){return e&&e.__esModule?e:{default:e}}var v=function(e,i,r,l,u,o,n,d,f,_,p){s.default.call(this,u,a.default.IDLE),this.renderEdges_=void 0!==p&&p,this.pixelRatio_=n,this.gutter_=d,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=l,this.wrappedTileCoord_=o||u,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var E=l.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent(),R=this.sourceTileGrid_.getExtent(),y=v?h.default.getIntersection(E,v):E;if(0!==h.default.getArea(y)){var x=e.getExtent();x&&(R=R?h.default.getIntersection(R,x):x);var L=l.getResolution(this.wrappedTileCoord_[0]),j=h.default.getCenter(y),D=g.default.calculateSourceResolution(e,r,j,L);if(!isFinite(D)||D<=0)this.state=a.default.EMPTY;else{var I=void 0!==_?_:t.default.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;if(this.triangulation_=new T.default(e,r,y,R,D*I),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(D);var G=this.triangulation_.calculateSourceExtent();if(R&&(e.canWrapX()?(G[1]=c.default.clamp(G[1],R[1],R[3]),G[3]=c.default.clamp(G[3],R[1],R[3])):G=h.default.getIntersection(G,R)),h.default.getArea(G)){for(var m=i.getTileRangeForExtentAndZ(G,this.sourceZ_),O=m.minX;O<=m.maxX;O++)for(var A=m.minY;A<=m.maxY;A++){var C=f(this.sourceZ_,O,A,n);C&&this.sourceTiles_.push(C)}0===this.sourceTiles_.length&&(this.state=a.default.EMPTY)}else this.state=a.default.EMPTY}else this.state=a.default.EMPTY}}else this.state=a.default.EMPTY};t.default.inherits(v,s.default),v.prototype.disposeInternal=function(){this.state==a.default.LOADING&&this.unlistenSources_(),s.default.prototype.disposeInternal.call(this)},v.prototype.getImage=function(){return this.canvas_},v.prototype.reproject_=function(){var e=[];if(this.sourceTiles_.forEach(function(t,i,s){t&&t.getState()==a.default.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})},this),this.sourceTiles_.length=0,0===e.length)this.state=a.default.ERROR;else{var t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],l=this.targetTileGrid_.getResolution(t),u=this.sourceTileGrid_.getResolution(this.sourceZ_),o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=g.default.render(s,r,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),l,o,this.triangulation_,e,this.gutter_,this.renderEdges_),this.state=a.default.LOADED}this.changed()},v.prototype.load=function(){if(this.state==a.default.IDLE){this.state=a.default.LOADING,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(t,i,s){var r,l=t.getState();l!=a.default.IDLE&&l!=a.default.LOADING||(e++,r=u.default.listen(t,n.default.CHANGE,function(i){var s=t.getState();s!=a.default.LOADED&&s!=a.default.ERROR&&s!=a.default.EMPTY||(u.default.unlistenByKey(r),0===--e&&(this.unlistenSources_(),this.reproject_()))},this),this.sourcesListenerKeys_.push(r))},this),this.sourceTiles_.forEach(function(e,t,i){e.getState()==a.default.IDLE&&e.load()}),0===e&&setTimeout(this.reproject_.bind(this),0)}},v.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(u.default.unlistenByKey),this.sourcesListenerKeys_=null},exports.default=v;
},{"../index.js":42,"../tile.js":278,"../tilestate.js":179,"../events.js":135,"../events/eventtype.js":153,"../extent.js":76,"../math.js":78,"../reproj.js":279,"../reproj/triangulation.js":280}],281:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./asserts.js"),r=o(e),t=require("./math.js"),n=o(t),a=require("./tilecoord.js"),u=o(a);function o(e){return e&&e.__esModule?e:{default:e}}var i={createFromTemplate:function(e,t){var n=/\{z\}/g,a=/\{x\}/g,u=/\{y\}/g,o=/\{-y\}/g;return function(i,l,c){return i?e.replace(n,i[0].toString()).replace(a,i[1].toString()).replace(u,function(){return(-i[2]-1).toString()}).replace(o,function(){var e=i[0],n=t.getFullTileRange(e);return r.default.assert(n,55),(n.getHeight()+i[2]).toString()}):void 0}},createFromTemplates:function(e,r){for(var t=e.length,n=new Array(t),a=0;a<t;++a)n[a]=i.createFromTemplate(e[a],r);return i.createFromTileUrlFunctions(n)},createFromTileUrlFunctions:function(e){return 1===e.length?e[0]:function(r,t,a){if(r){var o=u.default.hash(r),i=n.default.modulo(o,e.length);return e[i](r,t,a)}}},nullTileUrlFunction:function(e,r,t){},expandUrl:function(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var n,a=t[1].charCodeAt(0),u=t[2].charCodeAt(0);for(n=a;n<=u;++n)r.push(e.replace(t[0],String.fromCharCode(n)));return r}if(t=t=/\{(\d+)-(\d+)\}/.exec(e)){for(var o=parseInt(t[2],10),i=parseInt(t[1],10);i<=o;i++)r.push(e.replace(t[0],i.toString()));return r}return r.push(e),r}};exports.default=i;
},{"./asserts.js":70,"./math.js":78,"./tilecoord.js":264}],260:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=c(t),i=require("../asserts.js"),o=c(i),r=require("../tilerange.js"),n=c(r),s=require("../array.js"),l=c(s),u=require("../extent.js"),a=c(u),h=require("../math.js"),g=c(h),d=require("../size.js"),f=c(d),_=require("../tilecoord.js"),p=c(_);function c(t){return t&&t.__esModule?t:{default:t}}var m=function(t){var i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,o.default.assert(l.default.isSorted(this.resolutions_,function(t,e){return e-t},!0),17),!t.origins)for(var r=0,s=this.resolutions_.length-1;r<s;++r)if(i){if(this.resolutions_[r]/this.resolutions_[r+1]!==i){i=void 0;break}}else i=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,o.default.assert(this.origins_.length==this.resolutions_.length,20));var u=t.extent;void 0===u||this.origin_||this.origins_||(this.origin_=a.default.getTopLeft(u)),o.default.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,o.default.assert(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:e.default.DEFAULT_TILE_SIZE,o.default.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==u?u:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new n.default(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):u&&this.calculateTileRanges_(u)};m.tmpTileCoord_=[0,0,0],m.prototype.forEachTileCoord=function(t,e,i){for(var o=this.getTileRangeForExtentAndZ(t,e),r=o.minX,n=o.maxX;r<=n;++r)for(var s=o.minY,l=o.maxY;s<=l;++s)i([e,r,s])},m.prototype.forEachTileCoordParentTileRange=function(t,e,i,o,r){var s,l,u,a=null,h=t[0]-1;for(2===this.zoomFactor_?(l=t[1],u=t[2]):a=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(2===this.zoomFactor_?(l=Math.floor(l/2),u=Math.floor(u/2),s=n.default.createOrUpdate(l,l,u,u,o)):s=this.getTileRangeForExtentAndZ(a,h,o),e.call(i,h,s))return!0;--h}return!1},m.prototype.getExtent=function(){return this.extent_},m.prototype.getMaxZoom=function(){return this.maxZoom},m.prototype.getMinZoom=function(){return this.minZoom},m.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},m.prototype.getResolution=function(t){return this.resolutions_[t]},m.prototype.getResolutions=function(){return this.resolutions_},m.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var o=2*t[1],r=2*t[2];return n.default.createOrUpdate(o,o+1,r,r+1,e)}var s=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null},m.prototype.getTileRangeExtent=function(t,e,i){var o=this.getOrigin(t),r=this.getResolution(t),n=f.default.toSize(this.getTileSize(t),this.tmpSize_),s=o[0]+e.minX*n[0]*r,l=o[0]+(e.maxX+1)*n[0]*r,u=o[1]+e.minY*n[1]*r,h=o[1]+(e.maxY+1)*n[1]*r;return a.default.createOrUpdate(s,u,l,h,i)},m.prototype.getTileRangeForExtentAndZ=function(t,e,i){var o=m.tmpTileCoord_;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,o);var r=o[1],s=o[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,o),n.default.createOrUpdate(r,o[1],s,o[2],i)},m.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=f.default.toSize(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*o[0]*i,e[1]+(t[2]+.5)*o[1]*i]},m.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),o=this.getResolution(t[0]),r=f.default.toSize(this.getTileSize(t[0]),this.tmpSize_),n=i[0]+t[1]*r[0]*o,s=i[1]+t[2]*r[1]*o,l=n+r[0]*o,u=s+r[1]*o;return a.default.createOrUpdate(n,s,l,u,e)},m.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},m.prototype.getTileCoordForXYAndResolution_=function(t,e,i,o,r){var n=this.getZForResolution(i),s=i/this.getResolution(n),l=this.getOrigin(n),u=f.default.toSize(this.getTileSize(n),this.tmpSize_),a=o?.5:0,h=o?0:.5,g=Math.floor((t-l[0])/i+a),d=Math.floor((e-l[1])/i+h),_=s*g/u[0],c=s*d/u[1];return o?(_=Math.ceil(_)-1,c=Math.ceil(c)-1):(_=Math.floor(_),c=Math.floor(c)),p.default.createOrUpdate(n,_,c,r)},m.prototype.getTileCoordForXYAndZ_=function(t,e,i,o,r){var n=this.getOrigin(i),s=this.getResolution(i),l=f.default.toSize(this.getTileSize(i),this.tmpSize_),u=o?.5:0,a=o?0:.5,h=Math.floor((t-n[0])/s+u),g=Math.floor((e-n[1])/s+a),d=h/l[0],_=g/l[1];return o?(d=Math.ceil(d)-1,_=Math.ceil(_)-1):(d=Math.floor(d),_=Math.floor(_)),p.default.createOrUpdate(i,d,_,r)},m.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},m.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},m.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},m.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},m.prototype.getZForResolution=function(t,e){var i=l.default.linearFindNearest(this.resolutions_,t,e||0);return g.default.clamp(i,this.minZoom,this.maxZoom)},m.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),o=this.minZoom;o<e;++o)i[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=i},exports.default=m;
},{"../index.js":42,"../asserts.js":70,"../tilerange.js":182,"../array.js":68,"../extent.js":76,"../math.js":78,"../size.js":138,"../tilecoord.js":264}],242:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=j(e),r=require("./size.js"),o=j(r),n=require("./extent.js"),i=j(n),u=require("./extent/corner.js"),a=j(u),d=require("./obj.js"),l=j(d),f=require("./proj.js"),s=j(f),c=require("./proj/units.js"),x=j(c),E=require("./tilegrid/tilegrid.js"),g=j(E);function j(e){return e&&e.__esModule?e:{default:e}}var v={getForProjection:function(e){var t=e.getDefaultTileGrid();return t||(t=v.createForProjection(e),e.setDefaultTileGrid(t)),t},wrapX:function(e,t,r){var o=t[0],n=e.getTileCoordCenter(t),u=v.extentFromProjection(r);if(i.default.containsCoordinate(u,n))return t;var a=i.default.getWidth(u),d=Math.ceil((u[0]-n[0])/a);return n[0]+=a*d,e.getTileCoordForCoordAndZ(n,o)},createForExtent:function(e,t,r,o){var n=void 0!==o?o:a.default.TOP_LEFT,u=v.resolutionsFromExtent(e,t,r);return new g.default({extent:e,origin:i.default.getCorner(e,n),resolutions:u,tileSize:r})},createXYZ:function(e){var t={};return l.default.assign(t,void 0!==e?e:{}),void 0===t.extent&&(t.extent=s.default.get("EPSG:3857").getExtent()),t.resolutions=v.resolutionsFromExtent(t.extent,t.maxZoom,t.tileSize),delete t.maxZoom,new g.default(t)},resolutionsFromExtent:function(e,r,n){for(var u=void 0!==r?r:t.default.DEFAULT_MAX_ZOOM,a=i.default.getHeight(e),d=i.default.getWidth(e),l=o.default.toSize(void 0!==n?n:t.default.DEFAULT_TILE_SIZE),f=Math.max(d/l[0],a/l[1]),s=u+1,c=new Array(s),x=0;x<s;++x)c[x]=f/Math.pow(2,x);return c},createForProjection:function(e,t,r,o){var n=v.extentFromProjection(e);return v.createForExtent(n,t,r,o)},extentFromProjection:function(e){var t=(e=s.default.get(e)).getExtent();if(!t){var r=180*s.default.METERS_PER_UNIT[x.default.DEGREES]/e.getMetersPerUnit();t=i.default.createOrUpdate(-r,-r,r,r)}return t}};exports.default=v;
},{"./index.js":42,"./size.js":138,"./extent.js":76,"./extent/corner.js":160,"./obj.js":52,"./proj.js":34,"./proj/units.js":88,"./tilegrid/tilegrid.js":260}],297:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./tilerange.js"),t=a(e),i=require("./math.js"),n=a(i),r=require("./tilegrid.js"),s=a(r);function a(e){return e&&e.__esModule?e:{default:e}}var l=function(e){this.html_=e.html,this.tileRanges_=e.tileRanges?e.tileRanges:null};l.prototype.getHTML=function(){return this.html_},l.prototype.intersectsAnyTileRange=function(e,i,r){if(!this.tileRanges_)return!0;var a,l,u,o;for(o in e){var f;if(o in this.tileRanges_)for(u=e[o],a=0,l=this.tileRanges_[o].length;a<l;++a){if((f=this.tileRanges_[o][a]).intersects(u))return!0;var g=i.getTileRangeForExtentAndZ(s.default.extentFromProjection(r),parseInt(o,10)),d=g.getWidth();if(u.minX<g.minX||u.maxX>g.maxX){if(f.intersects(new t.default(n.default.modulo(u.minX,d),n.default.modulo(u.maxX,d),u.minY,u.maxY)))return!0;if(u.getWidth()>d&&f.intersects(g))return!0}}}return!1},exports.default=l;
},{"./tilerange.js":182,"./math.js":78,"./tilegrid.js":242}],296:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=f(t),i=require("../attribution.js"),r=f(i),o=require("../object.js"),n=f(o),u=require("../proj.js"),s=f(u),a=require("../source/state.js"),p=f(a);function f(t){return t&&t.__esModule?t:{default:t}}var c=function(t){n.default.call(this),this.projection_=s.default.get(t.projection),this.attributions_=null,this.attributions2_=this.adaptAttributions_(t.attributions),this.logo_=t.logo,this.state_=void 0!==t.state?t.state:p.default.READY,this.wrapX_=void 0!==t.wrapX&&t.wrapX};e.default.inherits(c,n.default),c.prototype.adaptAttributions_=function(t){if(!t)return null;if(t instanceof r.default)return this.attributions_=[t],function(e){return[t.getHTML()]};if(Array.isArray(t)){if(t[0]instanceof r.default){this.attributions_=t;var e=t.map(function(t){return t.getHTML()});return function(t){return e}}return this.attributions_=t.map(function(t){return new r.default({html:t})}),function(e){return t}}return"function"==typeof t?t:(this.attributions_=[new r.default({html:t})],function(e){return[t]})},c.prototype.forEachFeatureAtCoordinate=e.default.nullFunction,c.prototype.getAttributions=function(){return this.attributions_},c.prototype.getAttributions2=function(){return this.attributions2_},c.prototype.getLogo=function(){return this.logo_},c.prototype.getProjection=function(){return this.projection_},c.prototype.getResolutions=function(){},c.prototype.getState=function(){return this.state_},c.prototype.getWrapX=function(){return this.wrapX_},c.prototype.refresh=function(){this.changed()},c.prototype.setAttributions=function(t){this.attributions2_=this.adaptAttributions_(t),this.changed()},c.prototype.setLogo=function(t){this.logo_=t},c.prototype.setState=function(t){this.state_=t,this.changed()},exports.default=c;
},{"../index.js":42,"../attribution.js":297,"../object.js":58,"../proj.js":34,"../source/state.js":194}],282:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=v(e),i=require("../tilecache.js"),r=v(i),o=require("../tilestate.js"),n=v(o),l=require("../events/event.js"),u=v(l),a=require("../proj.js"),s=v(a),c=require("../size.js"),p=v(c),h=require("../source/source.js"),d=v(h),f=require("../tilecoord.js"),g=v(f),y=require("../tilegrid.js"),j=v(y);function v(e){return e&&e.__esModule?e:{default:e}}var x=function(e){d.default.call(this,{attributions:e.attributions,extent:e.extent,logo:e.logo,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new r.default(e.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:e.transition}};t.default.inherits(x,d.default),x.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},x.prototype.expireCache=function(e,t){var i=this.getTileCacheForProjection(e);i&&i.expireCache(t)},x.prototype.forEachLoadedTile=function(e,t,i,r){var o=this.getTileCacheForProjection(e);if(!o)return!1;for(var l,u,a,s=!0,c=i.minX;c<=i.maxX;++c)for(var p=i.minY;p<=i.maxY;++p)u=g.default.getKeyZXY(t,c,p),a=!1,o.containsKey(u)&&(a=(l=o.get(u)).getState()===n.default.LOADED)&&(a=!1!==r(l)),a||(s=!1);return s},x.prototype.getGutter=function(e){return 0},x.prototype.getKey=function(){return this.key_},x.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},x.prototype.getOpaque=function(e){return this.opaque_},x.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},x.prototype.getTile=function(e,t,i,r,o){},x.prototype.getTileGrid=function(){return this.tileGrid},x.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:j.default.getForProjection(e)},x.prototype.getTileCacheForProjection=function(e){var t=this.getProjection();return t&&!s.default.equivalent(t,e)?null:this.tileCache},x.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},x.prototype.getTilePixelSize=function(e,t,i){var r=this.getTileGridForProjection(i),o=this.getTilePixelRatio(t),n=p.default.toSize(r.getTileSize(e),this.tmpSize);return 1==o?n:p.default.scale(n,o,this.tmpSize)},x.prototype.getTileCoordForTileUrlFunction=function(e,t){var i=void 0!==t?t:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=j.default.wrapX(r,e,i)),g.default.withinExtentAndZ(e,r)?e:null},x.prototype.refresh=function(){this.tileCache.clear(),this.changed()},x.prototype.useTile=t.default.nullFunction,x.Event=function(e,t){u.default.call(this,e),this.tile=t},t.default.inherits(x.Event,u.default),exports.default=x;
},{"../index.js":42,"../tilecache.js":263,"../tilestate.js":179,"../events/event.js":152,"../proj.js":34,"../size.js":138,"../source/source.js":296,"../tilecoord.js":264,"../tilegrid.js":242}],283:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};exports.default=e;
},{}],266:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=h(t),i=require("../tilestate.js"),l=h(i),n=require("../tileurlfunction.js"),o=h(n),r=require("../source/tile.js"),s=h(r),u=require("../source/tileeventtype.js"),a=h(u),c=require("../tilecoord.js"),d=h(c);function h(t){return t&&t.__esModule?t:{default:t}}var f=function(t){s.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,logo:t.logo,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition}),this.tileLoadFunction=t.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):o.default.nullTileUrlFunction,this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),t.tileUrlFunction&&this.setTileUrlFunction(t.tileUrlFunction),this.tileLoadingKeys_={}};e.default.inherits(f,s.default),f.prototype.fixedTileUrlFunction,f.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},f.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},f.prototype.getUrls=function(){return this.urls},f.prototype.handleTileChange=function(t){var i,n=t.target,o=e.default.getUid(n),r=n.getState();r==l.default.LOADING?(this.tileLoadingKeys_[o]=!0,i=a.default.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],i=r==l.default.ERROR?a.default.TILELOADERROR:r==l.default.LOADED||r==l.default.ABORT?a.default.TILELOADEND:void 0),void 0!=i&&this.dispatchEvent(new s.default.Event(i,n))},f.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},f.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},f.prototype.setUrl=function(t){var e=this.urls=o.default.expandUrl(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):o.default.createFromTemplates(e,this.tileGrid),t)},f.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):o.default.createFromTemplates(t,this.tileGrid),e)},f.prototype.useTile=function(t,e,i){var l=d.default.getKeyZXY(t,e,i);this.tileCache.containsKey(l)&&this.tileCache.get(l)},exports.default=f;
},{"../index.js":42,"../tilestate.js":179,"../tileurlfunction.js":281,"../source/tile.js":282,"../source/tileeventtype.js":283,"../tilecoord.js":264}],243:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=F(e),i=require("../imagetile.js"),r=F(i),o=require("../tilecache.js"),n=F(o),l=require("../tilestate.js"),a=F(l),s=require("../events.js"),c=F(s),u=require("../events/eventtype.js"),h=F(u),d=require("../proj.js"),f=F(d),p=require("../reproj/tile.js"),g=F(p),E=require("../source/urltile.js"),j=F(E),C=require("../tilecoord.js"),T=F(C),P=require("../tilegrid.js"),R=F(P);function F(e){return e&&e.__esModule?e:{default:e}}var v=function(e){j.default.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,logo:e.logo,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:v.defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:r.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1};t.default.inherits(v,j.default),v.prototype.canExpireCache=function(){if(!t.default.ENABLE_RASTER_REPROJECTION)return j.default.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},v.prototype.expireCache=function(e,i){if(t.default.ENABLE_RASTER_REPROJECTION){var r=this.getTileCacheForProjection(e);for(var o in this.tileCache.expireCache(this.tileCache==r?i:{}),this.tileCacheForProjection){var n=this.tileCacheForProjection[o];n.expireCache(n==r?i:{})}}else j.default.prototype.expireCache.call(this,e,i)},v.prototype.getGutter=function(e){return t.default.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&e&&!f.default.equivalent(this.getProjection(),e)?0:this.getGutterInternal()},v.prototype.getGutterInternal=function(){return 0},v.prototype.getOpaque=function(e){return!(t.default.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&e&&!f.default.equivalent(this.getProjection(),e))&&j.default.prototype.getOpaque.call(this,e)},v.prototype.getTileGridForProjection=function(e){if(!t.default.ENABLE_RASTER_REPROJECTION)return j.default.prototype.getTileGridForProjection.call(this,e);var i=this.getProjection();if(!this.tileGrid||i&&!f.default.equivalent(i,e)){var r=t.default.getUid(e).toString();return r in this.tileGridForProjection||(this.tileGridForProjection[r]=R.default.getForProjection(e)),this.tileGridForProjection[r]}return this.tileGrid},v.prototype.getTileCacheForProjection=function(e){if(!t.default.ENABLE_RASTER_REPROJECTION)return j.default.prototype.getTileCacheForProjection.call(this,e);var i=this.getProjection();if(!i||f.default.equivalent(i,e))return this.tileCache;var r=t.default.getUid(e).toString();return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new n.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]},v.prototype.createTile_=function(e,t,i,r,o,n){var l=[e,t,i],s=this.getTileCoordForTileUrlFunction(l,o),u=s?this.tileUrlFunction(s,r,o):void 0,d=new this.tileClass(l,void 0!==u?a.default.IDLE:a.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=n,c.default.listen(d,h.default.CHANGE,this.handleTileChange,this),d},v.prototype.getTile=function(e,i,r,o,n){var l=this.getProjection();if(t.default.ENABLE_RASTER_REPROJECTION&&l&&n&&!f.default.equivalent(l,n)){var a,s=this.getTileCacheForProjection(n),c=[e,i,r],u=T.default.getKey(c);s.containsKey(u)&&(a=s.get(u));var h=this.getKey();if(a&&a.key==h)return a;var d=this.getTileGridForProjection(l),p=this.getTileGridForProjection(n),E=this.getTileCoordForTileUrlFunction(c,n),j=new g.default(l,d,n,p,c,E,this.getTilePixelRatio(o),this.getGutterInternal(),function(e,t,i,r){return this.getTileInternal(e,t,i,r,l)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return j.key=h,a?(j.interimTile=a,j.refreshInterimChain(),s.replace(u,j)):s.set(u,j),j}return this.getTileInternal(e,i,r,o,l||n)},v.prototype.getTileInternal=function(e,t,i,r,o){var n=null,l=T.default.getKeyZXY(e,t,i),s=this.getKey();if(this.tileCache.containsKey(l)){if((n=this.tileCache.get(l)).key!=s){var c=n;n=this.createTile_(e,t,i,r,o,s),c.getState()==a.default.IDLE?n.interimTile=c.interimTile:n.interimTile=c,n.refreshInterimChain(),this.tileCache.replace(l,n)}}else n=this.createTile_(e,t,i,r,o,s),this.tileCache.set(l,n);return n},v.prototype.setRenderReprojectionEdges=function(e){if(t.default.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=e){for(var i in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[i].clear();this.changed()}},v.prototype.setTileGridForProjection=function(e,i){if(t.default.ENABLE_RASTER_REPROJECTION){var r=f.default.get(e);if(r){var o=t.default.getUid(r).toString();o in this.tileGridForProjection||(this.tileGridForProjection[o]=i)}}},v.defaultTileLoadFunction=function(e,t){e.getImage().src=t},exports.default=v;
},{"../index.js":42,"../imagetile.js":262,"../tilecache.js":263,"../tilestate.js":179,"../events.js":135,"../events/eventtype.js":153,"../proj.js":34,"../reproj/tile.js":265,"../source/urltile.js":266,"../tilecoord.js":264,"../tilegrid.js":242}],208:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),i=n(e),t=require("../source/tileimage.js"),r=n(t),o=require("../tilegrid.js"),l=n(o);function n(e){return e&&e.__esModule?e:{default:e}}var a=function(e){var i=e||{},t=void 0!==i.projection?i.projection:"EPSG:3857",o=void 0!==i.tileGrid?i.tileGrid:l.default.createXYZ({extent:l.default.extentFromProjection(t),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});r.default.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,logo:i.logo,opaque:i.opaque,projection:t,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})};i.default.inherits(a,r.default),exports.default=a;
},{"../index.js":42,"../source/tileimage.js":243,"../tilegrid.js":242}],120:[function(require,module,exports) {
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],176:[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],40:[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],36:[function(require,module,exports) {
var global = (1,eval)("this");
var process = require("process");
var e=(0,eval)("this"),t=require("process"),r=/%[sdj%]/g;exports.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,s=o.length,u=String(e).replace(r,function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(e){return"[Circular]"}default:return e}}),c=o[n];n<s;c=o[++n])h(c)||!z(c)?u+=" "+c:u+=" "+i(c);return u},exports.deprecate=function(r,n){if(j(e.process))return function(){return exports.deprecate(r,n).apply(this,arguments)};if(!0===t.noDeprecation)return r;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var n,o={};function i(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),x(t)?r.showHidden=t:t&&exports._extend(r,t),j(r.showHidden)&&(r.showHidden=!1),j(r.depth)&&(r.depth=2),j(r.colors)&&(r.colors=!1),j(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),l(r,e,r.depth)}function s(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function u(e,t){return e}function c(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function l(e,t,r){if(e.customInspect&&t&&D(t.inspect)&&t.inspect!==exports.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return v(n)||(n=l(e,n,r)),n}var o=p(e,t);if(o)return o;var i=Object.keys(t),s=c(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),E(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return a(t);if(0===i.length){if(D(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(O(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return a(t)}var x,h="",b=!1,m=["{","}"];(d(t)&&(b=!0,m=["[","]"]),D(t))&&(h=" [Function"+(t.name?": "+t.name:"")+"]");return O(t)&&(h=" "+RegExp.prototype.toString.call(t)),w(t)&&(h=" "+Date.prototype.toUTCString.call(t)),E(t)&&(h=" "+a(t)),0!==i.length||b&&0!=t.length?r<0?O(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),x=b?f(e,t,r,s,i):i.map(function(n){return g(e,t,r,s,n,b)}),e.seen.pop(),y(x,h,m)):m[0]+h+m[1]}function p(e,t){if(j(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return m(t)?e.stylize(""+t,"number"):x(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}function a(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,o){for(var i=[],s=0,u=t.length;s<u;++s)$(t,String(s))?i.push(g(e,t,r,n,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(g(e,t,r,n,o,!0))}),i}function g(e,t,r,n,o,i){var s,u,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),$(n,o)||(s="["+o+"]"),u||(e.seen.indexOf(c.value)<0?(u=h(r)?l(e,c.value,null):l(e,c.value,r-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),j(s)){if(i&&o.match(/^\d+$/))return u;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function y(e,t,r){return e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function x(e){return"boolean"==typeof e}function h(e){return null===e}function b(e){return null==e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function S(e){return"symbol"==typeof e}function j(e){return void 0===e}function O(e){return z(e)&&"[object RegExp]"===A(e)}function z(e){return"object"==typeof e&&null!==e}function w(e){return z(e)&&"[object Date]"===A(e)}function E(e){return z(e)&&("[object Error]"===A(e)||e instanceof Error)}function D(e){return"function"==typeof e}function N(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function A(e){return Object.prototype.toString.call(e)}function J(e){return e<10?"0"+e.toString(10):e.toString(10)}exports.debuglog=function(e){if(j(n)&&(n=""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(n)){var r=t.pid;o[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else o[e]=function(){};return o[e]},exports.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=d,exports.isBoolean=x,exports.isNull=h,exports.isNullOrUndefined=b,exports.isNumber=m,exports.isString=v,exports.isSymbol=S,exports.isUndefined=j,exports.isRegExp=O,exports.isObject=z,exports.isDate=w,exports.isError=E,exports.isFunction=D,exports.isPrimitive=N,exports.isBuffer=require("./support/isBuffer");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(){var e=new Date,t=[J(e.getHours()),J(e.getMinutes()),J(e.getSeconds())].join(":");return[e.getDate(),R[e.getMonth()],t].join(" ")}function $(e,t){return Object.prototype.hasOwnProperty.call(e,t)}exports.log=function(){console.log("%s - %s",H(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,t){if(!t||!z(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};
},{"./support/isBuffer":120,"inherits":176,"process":40}],24:[function(require,module,exports) {
var r=require("util");exports.typeOf=function(e){var t=typeof e;return"object"===t&&(null===e?t="null":r.isArray(e)?t="array":r.isDate(e)?t="date":r.isRegExp(e)?t="regexp":r.isError(e)&&(t="error")),t},exports.extend=function(r,e){for(var t in e)r[t]=e[t];return r},exports.zip=function(r){var e=[],t=0;for(var n in r)e[2*t]=n,e[2*t+1]=r[n],++t;return e},exports.unzip=function(r){for(var e={},t=0,n=r.length;t<n;t+=2)e[r[t]]=r[t+1];return e};
},{"util":36}],26:[function(require,module,exports) {
var r=require("util"),e=encodeURIComponent,t={string:function(r){if("string"!=typeof r)throw new Error("Expected string to serialize: "+r);return e(r)},number:function(r){if("number"!=typeof r)throw new Error("Expected number to serialize: "+r);return e(String(r))},boolean:function(r){if("boolean"!=typeof r)throw new Error("Expected boolean to serialize: "+r);return r?"1":"0"},date:function(t){if(!r.isDate(t))throw new Error("Expected date to serialize: "+t);return e(t.toISOString())},array:function(t){if(!r.isArray(t))throw new Error("Expected array to serialize: "+t);return e(JSON.stringify(t))},object:function(r){return e(JSON.stringify(r))}};exports.get=function(r){if(!(r in t))throw new Error("Unable to serialize type: "+r);return t[r]};
},{"util":36}],122:[function(require,module,exports) {
var r=require("./util"),e=decodeURIComponent,t=function(){},i={string:function(r){if(!r||"string"!=typeof r)throw new Error("Expected string to deserialize: "+r);return e(r)},number:function(r){if(!r||"string"!=typeof r)throw new Error("Expected string to deserialize: "+r);var t=Number(e(r));if(isNaN(t))throw new Error("Expected to deserialize a number: "+r);return t},boolean:function(r){if(!r||"string"!=typeof r)throw new Error("Expected string to deserialize: "+r);var e;if("1"===r)e=!0;else{if("0"!==r)throw new Error('Expected "1" or "0" for boolean: '+r);e=!1}return e},date:function(r){if(!r||"string"!=typeof r)throw new Error("Expected string to deserialize: "+r);var t=new Date(e(r));if(isNaN(t.getTime()))throw new Error("Expected to deserialize a date: "+r);return t},array:function(i){if(!i||"string"!=typeof i)throw new Error("Expected string to deserialize: "+i);var o;try{o=JSON.parse(e(i))}catch(r){t()}if(!o||"array"!==r.typeOf(o))throw new Error("Expected to deserialize an array: "+i);return o},object:function(i){if(!i||"string"!=typeof i)throw new Error("Expected string to deserialize: "+i);var o;try{o=JSON.parse(e(i))}catch(r){t()}if(!o||"object"!==r.typeOf(o))throw new Error("Expected to deserialize an object: "+i);return o}};exports.get=function(r){if(!(r in i))throw new Error("Unable to deserialize type: "+r);return i[r]};
},{"./util":24}],38:[function(require,module,exports) {
var e=require("./util"),i=require("./serializers"),r=require("./deserializers");exports.Field=function(t){if("object"!==e.typeOf(t))this.default=t;else{if(!("default"in t))throw new Error("Missing default");this.default=t.default}var s=e.typeOf(this.default);this.serialize=t.serialize||i.get(s),this.deserialize=t.deserialize||r.get(s)};
},{"./util":24,"./serializers":26,"./deserializers":122}],22:[function(require,module,exports) {
var e=require("./field").Field,i=require("./util"),r=exports.Schema=function(r){r=i.extend({},r);var t,n={};for(var f in"_"in r&&(t=r._,delete r._),r)n[f]=new e(r[f]);this._prefix=t,this._fields=n};r.prototype.getPrefixed=function(e){return this._prefix?this._prefix+"."+e:e},r.prototype.forEachKey=function(e,i){for(var r in this._fields)if(!1===e.call(i,r,this.getPrefixed(r)))return},r.prototype.serialize=function(e,i,r){if(!(e in this._fields))throw new Error("Unknown key: "+e);return this._fields[e].serialize(i,r)},r.prototype.deserialize=function(e,i){if(!(e in this._fields))throw new Error("Unknown key: "+e);return this._fields[e].deserialize(i)},r.prototype.getDefault=function(e){if(!(e in this._fields))throw new Error("Unknown key: "+e);return this._fields[e].default},r.prototype.conflicts=function(e){var i={};for(var r in this._fields)i[this.getPrefixed(r)]=!0;var t=!1;return e.forEachKey(function(e,r){return r in i&&(t=r),!t}),t};
},{"./field":38,"./util":24}],18:[function(require,module,exports) {
var e=require("./schema").Schema,i=require("./util"),r=require("./serializers"),t=exports.Store=function(e,i){this._values=e,this._defaults={},this._providers=[],this._callback=i,this._callbackTimer=null};t.prototype._scheduleCallback=function(){this._callbackTimer&&clearTimeout(this._callbackTimer),this._callbackTimer=setTimeout(this._debouncedCallback.bind(this))},t.prototype._debouncedCallback=function(){this._callbackTimer=null,this._callback(this._values,this._defaults)},t.prototype.update=function(e){this._updateTimer&&clearTimeout(this._updateTimer),this._updateTimer=setTimeout(this._debouncedUpdate.bind(this,e))},t.prototype._debouncedUpdate=function(e){this._updateTimer=null;for(var i=this._values,r=this._providers.slice(),t=r.length-1;t>=0;--t){var a=r[t],s=a.schema,l=!1,c={};s.forEachKey(function(r,t){var a;if(t in e){if(i[t]!==e[t])try{a=s.deserialize(r,e[t]),i[t]=e[t],c[r]=a,l=!0}catch(e){}}else{a=s.getDefault(r);var o=s.serialize(r,a);i[t]!==o&&(l=!0,i[t]=o,c[r]=a)}}),l&&this._providers.indexOf(a)>=0&&a.callback(c)}},t.prototype.unregister=function(e){var i;if(this._providers=this._providers.filter(function(r){var t=r.callback===e;return t&&(i=r),!t}),!i)throw new Error("Unable to unregister hashed state provider");var r=this._values,t=this._defaults;i.schema.forEachKey(function(e,i){delete r[i],delete t[i]}),this._scheduleCallback()},t.prototype.register=function(i,r){for(var t={schema:new e(i),callback:r},a=0,s=this._providers.length;a<s;++a){var l=t.schema.conflicts(this._providers[a].schema);if(l)throw new Error("Provider already registered using the same name: "+l);if(t.callback===this._providers[a].callback)throw new Error("Provider already registered with the same callback")}return this._providers.push(t),this._initializeProvider(t),function(e){if(-1===this._providers.indexOf(t))throw new Error("Unregistered provider attempting to update state");var i=t.schema,r=!1,a=this._values;i.forEachKey(function(t,s){if(t in e){var l=i.serialize(t,e[t],e);a[s]!==l&&(r=!0,a[s]=l)}}),r&&this._scheduleCallback()}.bind(this)},t.prototype._initializeProvider=function(e){var i={},r={},t=this._values;for(var a in e.schema.forEachKey(function(a,s){var l,c=e.schema.getDefault(a),o=e.schema.serialize(a,c);if(s in t)try{l=e.schema.deserialize(a,t[s])}catch(e){l=c}else l=c;i[a]=l,r[s]=o,t[s]=e.schema.serialize(a,l)}),r)this._defaults[a]=r[a];e.callback(i)},t.prototype.serialize=function(e){for(var t={},a=0,s=this._providers.length;a<s;++a){var l=this._providers[a];l.schema.forEachKey(function(i,r){r in e&&(t[r]=l.schema.serialize(i,e[r],e))})}for(var c in e)if(!(c in t)){var o=e[c],h=i.typeOf(o),n=r.get(h);t[c]=n(o)}return t};
},{"./schema":22,"./util":24,"./serializers":26}],20:[function(require,module,exports) {
var r=require("./util");function e(e){var i;e.length>2?i=e.substring(2).split("/"):i=[];return r.unzip(i)}function i(e){var i="#",n=r.zip(e);return n.length>0&&(i="#/"+n.join("/")),i}exports.deserialize=e,exports.serialize=i;
},{"./util":24}],16:[function(require,module,exports) {
var e,r=require("./store").Store,t=require("./hash");function i(){e&&window.removeEventListener("popstate",n),window.addEventListener("popstate",n),e=new r(t.deserialize(location.hash),function(e,r){var i={};for(var n in e)e[n]!==r[n]&&(i[n]=e[n]);history.pushState(e,"",t.serialize(i))})}function n(){e.update(t.deserialize(location.hash))}exports.register=function(r,t){return e.register(r,t)},exports.unregister=function(r){e.unregister(r)},exports.serialize=function(r){return t.serialize(e.serialize(r))},exports.reset=i,i();
},{"./store":18,"./hash":20}],14:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("hashed"),t=n(e),r=require("ol/proj"),o=n(r);function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=Math.pow(10,t);return(Math.round(e*r)/r).toString()}function i(e,r){var n;n="animate"in(r=r||{})?r.animate:{duration:250};var i,u,l,s=e.getView(),f=s.getProjection().getCode();if(s.isDef())i=s.getZoom(),u=s.getCenter(),l=s.getRotation();else{var d=e.getViewport();i=d?Math.LOG2E*Math.log(d.clientWidth/256):0,u=[0,0],l=0}var c={center:{default:u,serialize:function(e,t){var r;return r=t&&"zoom"in t?Math.max(0,Math.ceil(Math.log(t.zoom)/Math.LN2)):3,a((e=o.default.transform(e,f,"EPSG:4326"))[0],r)+","+a(e[1],r)},deserialize:function(e){var t=e.split(",");if(2!==t.length)throw new Error("Expected lon,lat but got "+e);var r=[parseFloat(t[0]),parseFloat(t[1])];return o.default.transform(r,"EPSG:4326",f)}},zoom:{default:i,serialize:function(e){return a(e,1)},deserialize:Number},rotation:{default:l,serialize:function(e){return a(e,2)},deserialize:Number}};function m(e){s.isDef()&&n?s.animate(Object.assign({},e,n)):("center"in e&&s.setCenter(e.center),"zoom"in e&&s.setZoom(e.zoom),"rotation"in e&&s.setRotation(e.rotation))}var g=t.default.register(c,m);function h(){g({center:s.getCenter(),zoom:s.getZoom(),rotation:s.getRotation()})}return e.on("moveend",h),function(){e.un("moveend",h),t.default.unregister(m)}}exports.default=i;
},{"hashed":16,"ol/proj":34}],10:[function(require,module,exports) {
"use strict";require("ol/ol.css");var e=require("ol/map"),t=y(e),l=require("ol/view"),s=y(l),n=require("ol/layer/tile"),a=y(n),i=require("ol/source/xyz"),o=y(i),r=require("ol-hashed"),d=y(r),c=require("ol/proj"),u=y(c),f=require("hashed"),p=y(f);function y(e){return e&&e.__esModule?e:{default:e}}require("../styles/map.scss");var m=new a.default({title:"Labels",source:new o.default({url:"https://{1-4}.basemaps.cartocdn.com/dark_only_labels/{z}/{x}/{y}.png"})});const h=new t.default({target:"map",layers:[new a.default({source:new o.default({url:"https://{1-4}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png"})}),new a.default({title:"Landsat Scene",type:"base",source:new o.default({url:"https://tiles{0-3}.planet.com/v1/experimental/tiles/PSScene4Band/20170831_172754_101c/{z}/{x}/{y}.png?api_key=86838cd60d364ceab08d59cd9b56d259"})}),m],view:new s.default({center:u.default.transform([-95.9119,29.5551],"EPSG:4326","EPSG:3857"),zoom:11.5})});var w=document.getElementById("labels");function g(e){const t=window.innerHeight,l=window.innerWidth;e.style.display="block",e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width=`${l}px`,e.style.height=`${t}px`,h.updateSize()}function b(e){e.style.position="relative",e.style.width="100%",e.style.height="100%"}w.addEventListener("click",function(){m.setVisible(w.checked)}),document.getElementById("expand-button").addEventListener("click",function(){console.log("map",h);const e=document.getElementById("map");"fixed"==e.style.position?(b(e),q({fs:0})):(g(e),q({fs:1})),h.updateSize()});var v={fs:0};function x(e){(console.log("listener called"),console.log("state is "+e+" and fs is "+e.fs),"fs"in e)&&(0!=e.fs&&g(document.getElementById("map")))}var q=p.default.register(v,x);(0,d.default)(h);
},{"ol/ol.css":28,"ol/map":30,"ol/view":32,"ol/layer/tile":207,"ol/source/xyz":208,"ol-hashed":14,"ol/proj":34,"hashed":16,"../styles/map.scss":28}]},{},[10])